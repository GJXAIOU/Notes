{"compress":true,"commitItems":[["3e530f85-f8e2-4a92-9fd9-ac6e784a7cfe",1571540440077,"# CentOS安装MySQL详解\n\n## 引言\n\n最近某云搞活动，买了个服务器作为平时学习和测试用，新机器啥也没有，一些常用软件的安装是免不了的，于是乎想着把安装过程都详细记录下来，一是做个备忘，二是给有需要的同学作个参考。\n\nLinux上安装软件常见的几种方式：\n\n*   源码编译\n*   压缩包解压（一般为tar.gz）\n*   编译好的安装包（RPM、DPKG等）\n*   在线安装（YUM、APT等）\n\n以上几种方式便捷性依次增加，但通用性依次下降，比如直接下载压缩包进行解压，这种方式一般需要自己做一些额外的配置工作，但只要掌握了方法，各个平台基本都适用，YUM虽然简单，但是平台受限，网络受限，必要的时候还需要增加一些特定YUM源。\n\n几种安装方式最好都能掌握，原则上能用简单的就用简单的：YUM>RPM>tar.gz>源码\n\n本文是介绍MySQL在CentOS上的安装，主要步骤都是参考了MySQL官方文档：[dev.mysql.com/doc/refman/…](https://dev.mysql.com/doc/refman/5.7/en/installing.html)\n\n为了测试不同安装方式，反复折腾了好几次，装了删，删了装，每个步骤都是亲测成功的，每条命令都是亲自执行过的，可以放心使用\n\n咱们闲话少说，书归正传（这闲话就不少了...）\n\n## 一、YUM\n\n#### 0、删除已安装的MySQL\n\n##### 检查MariaDB\n\n```\nshell> rpm -qa|grep mariadb\nmariadb-server-5.5.60-1.el7_5.x86_64\nmariadb-5.5.60-1.el7_5.x86_64\nmariadb-libs-5.5.60-1.el7_5.x86_64\n复制代码\n```\n\n##### 删除mariadb\n\n如果不存在（上面检查结果返回空）则跳过步骤\n\n```\nshell> rpm -e --nodeps mariadb-server\nshell> rpm -e --nodeps mariadb\nshell> rpm -e --nodeps mariadb-libs\n复制代码\n```\n\n_其实yum方式安装是可以不用删除mariadb的，安装MySQL会覆盖掉之前已存在的mariadb_\n\n##### 检查MySQL\n\n```\nshell> rpm -qa|grep mysql\n复制代码\n```\n\n##### 删除MySQL\n\n如果不存在（上面检查结果返回空）则跳过步骤\n\n```\nshell> rpm -e --nodeps xxx\n复制代码\n```\n\n### 1、添加MySQL Yum Repository\n\n> 从CentOS 7开始，MariaDB成为Yum源中默认的数据库安装包。也就是说在CentOS 7及以上的系统中使用yum安装MySQL默认安装的会是MariaDB（MySQL的一个分支）。如果想安装官方MySQL版本，需要使用MySQL提供的Yum源。\n\n##### 下载MySQL源\n\n官网地址：[dev.mysql.com/downloads/r…](https://dev.mysql.com/downloads/repo/yum/)\n\n查看系统版本：\n\n```\nshell> cat /etc/redhat-release\nCentOS Linux release 7.6.1810 (Core)\n复制代码\n```\n\n选择对应的版本进行下载，例如CentOS 7当前在官网查看最新Yum源的下载地址为： [dev.mysql.com/get/mysql80…](https://dev.mysql.com/get/mysql80-community-release-el7-3.noarch.rpm)\n\n```\nshell> wget https://dev.mysql.com/get/mysql80-community-release-el7-3.noarch.rpm\n复制代码\n```\n\n##### 安装MySQL源\n\n```\nshell> sudo rpm -Uvh platform-and-version-specific-package-name.rpm\n复制代码\n```\n\n例如CentOS7当前最新MySQL源安装：\n\n```\nshell> sudo rpm -Uvh mysql80-community-release-el7-3.noarch.rpm\n复制代码\n```\n\n##### 检查是否安装成功\n\n执行成功后会在`/etc/yum.repos.d/`目录下生成两个repo文件`mysql-community.repo`及 `mysql-community-source.repo`\n\n并且通过`yum repolist`可以看到mysql相关资源\n\n```\nshell> yum repolist enabled | grep \"mysql.*-community.*\"\n!mysql-connectors-community/x86_64 MySQL Connectors Community                108\n!mysql-tools-community/x86_64      MySQL Tools Community                      90\n!mysql80-community/x86_64          MySQL 8.0 Community Server                113\n复制代码\n```\n\n### 2、选择MySQL版本\n\n使用MySQL Yum Repository安装MySQL，默认会选择当前最新的稳定版本，例如通过上面的MySQL源进行安装的话，默安装会选择MySQL 8.0版本，如果就是想要安装该版本，可以直接跳过此步骤，如果不是，比如我这里希望安装MySQL5.7版本，就需要“切换一下版本”：\n\n##### 查看当前MySQL Yum Repository中所有MySQL版本（每个版本在不同的子仓库中）\n\n```\nshell> yum repolist all | grep mysql\n复制代码\n```\n\n##### 切换版本\n\n```\nshell> sudo yum-config-manager --disable mysql80-community\nshell> sudo yum-config-manager --enable mysql57-community\n复制代码\n```\n\n除了使用yum-config-manager之外，还可以直接编辑`/etc/yum.repos.d/mysql-community.repo`文件\n\nenabled=0禁用\n\n```\n[mysql80-community]\nname=MySQL 8.0 Community Server\nbaseurl=http://repo.mysql.com/yum/mysql-8.0-community/el/7/$basearch/\nenabled=0\ngpgcheck=1\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-mysql\n复制代码\n```\n\nenabled=1启用\n\n```\n# Enable to use MySQL 5.7\n[mysql57-community]\nname=MySQL 5.7 Community Server\nbaseurl=http://repo.mysql.com/yum/mysql-5.7-community/el/7/$basearch/\nenabled=1\ngpgcheck=1\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-mysql\n复制代码\n```\n\n##### 检查当前启用的MySQL仓库\n\n```\nshell> yum repolist enabled | grep mysql\n复制代码\n```\n\n_如果同时启用了多个仓库，安装时会选择最新版本_\n\n### 3、安装MySQL\n\n```\nshell> sudo yum install mysql-community-server\n复制代码\n```\n\n该命令会安装MySQL服务器 (mysql-community-server) 及其所需的依赖、相关组件，包括mysql-community-client、mysql-community-common、mysql-community-libs等\n\n如果带宽不够，这个步骤时间会比较长，请耐心等待~\n\n### 4、启动MySQL\n\n##### 启动\n\n```\nshell> sudo systemctl start mysqld.service\n复制代码\n```\n\nCentOS 6：\n\n```\nshell> sudo service mysqld start\n复制代码\n```\n\n##### 查看状态\n\n```\nshell> sudo systemctl status mysqld.service\n复制代码\n```\n\nCentOS 6：\n\n```\nshell> sudo service mysqld status\n复制代码\n```\n\n##### 停止\n\n```\nshell> sudo systemctl stop mysqld.service\n复制代码\n```\n\nCentOS 6：\n\n```\nshell> sudo service mysqld stop\n复制代码\n```\n\n##### 重启\n\n```\nshell> sudo systemctl restart mysqld.service\n复制代码\n```\n\nCentOS 6：\n\n```\nshell> sudo service mysqld restart\n复制代码\n```\n\n### 5、修改密码\n\n##### 初始密码\n\nMySQL第一次启动后会创建超级管理员账号`root@localhost`，初始密码存储在日志文件中：\n\n```\nshell> sudo grep 'temporary password' /var/log/mysqld.log\n复制代码\n```\n\n##### 修改默认密码\n\n```\nshell> mysql -uroot -p\n复制代码\n```\n\n```\nmysql> ALTER USER 'root'@'localhost' IDENTIFIED BY '123456';\nERROR 1819 (HY000): Your password does not satisfy the current policy requirements\n复制代码\n```\n\n出现上面的提示是因为密码太简单了，解决方法如下：\n\n1.  使用复杂密码，MySQL默认的密码策略是要包含数字、字母及特殊字符；\n2.  如果只是测试用，不想用那么复杂的密码，可以修改默认策略，即`validate_password_policy`（以及`validate_password_length`等相关参数），使其支持简单密码的设定，具体方法可以自行百度；\n3.  修改配置文件`/etc/my.cnf`，添加`validate_password=OFF`，保存并重启MySQL\n\n```\nmysql> ALTER USER 'root'@'localhost' IDENTIFIED BY '123456';\nQuery OK, 0 rows affected (0.00 sec)\n复制代码\n```\n\n### 6、允许root远程访问\n\n```\nmysql> GRANT ALL PRIVILEGES ON *.* TO 'root'@'%' IDENTIFIED BY '123456' WITH GRANT OPTION;\nmysql> FLUSH PRIVILEGES;\n复制代码\n```\n\n### 7、设置编码为utf8\n\n##### 查看编码\n\n```\nmysql> SHOW VARIABLES LIKE 'character%';\n复制代码\n```\n\n##### 设置编码\n\n编辑/etc/my.cnf，[mysqld]节点增加以下代码：\n\n```\n[mysqld]\ncharacter_set_server=utf8\ninit-connect='SET NAMES utf8'\n复制代码\n```\n\n### 8、设置开机启动\n\n```\nshell> systemctl enable mysqld\nshell> systemctl daemon-reload\n复制代码\n```\n\n## 二、RPM\n\n> 除安装过程外，其他步骤和yum方式安装相同，不再赘述\n\n### 0、删除已旧版本\n\n略\n\n### 1、下载MySQL安装包\n\n下载地址：[dev.mysql.com/downloads/m…](https://dev.mysql.com/downloads/mysql/)\n\n选择对应的版本：\n\n![](https://user-gold-cdn.xitu.io/2019/6/18/16b66894c80e9b32?imageView2/0/w/1280/h/960/format/webp/ignore-error/1)\n\n```\nshell> wget https://dev.mysql.com/get/Downloads/MySQL-5.7/mysql-5.7.26-1.el7.x86_64.rpm-bundle.tar\n复制代码\n```\n\n### 2、安装MySQL\n\n##### 解压（解打包）\n\n```\nshell> tar -xvf mysql-5.7.26-1.el7.x86_64.rpm-bundle.tar\ntar -xvf mysql-5.7.26-1.el7.x86_64.rpm-bundle.tar\nmysql-community-embedded-devel-5.7.26-1.el7.x86_64.rpm\nmysql-community-libs-5.7.26-1.el7.x86_64.rpm\nmysql-community-embedded-5.7.26-1.el7.x86_64.rpm\nmysql-community-test-5.7.26-1.el7.x86_64.rpm\nmysql-community-embedded-compat-5.7.26-1.el7.x86_64.rpm\nmysql-community-common-5.7.26-1.el7.x86_64.rpm\nmysql-community-devel-5.7.26-1.el7.x86_64.rpm\nmysql-community-client-5.7.26-1.el7.x86_64.rpm\nmysql-community-server-5.7.26-1.el7.x86_64.rpm\n复制代码\n```\n\n我们主要安装的是这四个（如果有需要也可以一并安装其它的）：\n\n```\nmysql-community-libs-5.7.26-1.el7.x86_64.rpm\nmysql-community-common-5.7.26-1.el7.x86_64.rpm\nmysql-community-client-5.7.26-1.el7.x86_64.rpm\nmysql-community-server-5.7.26-1.el7.x86_64.rpm\n复制代码\n```\n\n如果不想下载rpm-bundle，官网也提供单独的rpm下载链接\n\n##### 安装\n\n各rpm包是有依赖关系的，所以需要按照一定顺序进行安装，安装期间如果提示缺少哪些依赖也要先安装相应的包：\n\n```\nshell> rpm -ivh mysql-community-common-5.7.26-1.el7.x86_64.rpm\nshell> rpm -ivh mysql-community-libs-5.7.26-1.el7.x86_64.rpm\nshell> rpm -ivh mysql-community-client-5.7.26-1.el7.x86_64.rpm\nshell> rpm -ivh mysql-community-server-5.7.26-1.el7.x86_64.rpm\n复制代码\n```\n\n还有一种简单的方式，可以自动处理各个包之间的依赖关系并自动下载缺少的依赖：\n\n```\nshell> yum install mysql-community-{server,client,common,libs}-*\n复制代码\n```\n\n_注意：上面的`yum install`命令需要在tar解压之后的各个rpm包所在目录内执行，否则就变成yum方式安装了，需要配置MySQL的yum源并且速度很慢，还要当前机器支持外网访问_\n\n### 3、设置\n\n略\n\n## 三、tar.gz\n\n### 0、删除旧版本\n\n略\n\n### 1、下载\n\n下载地址：[dev.mysql.com/downloads/m…](https://dev.mysql.com/downloads/mysql/)\n\n选择对应的版本：\n\n![](https://user-gold-cdn.xitu.io/2019/6/18/16b668a1b3c258aa?imageView2/0/w/1280/h/960/format/webp/ignore-error/1)\n\n```\nshell> wget https://dev.mysql.com/get/Downloads/MySQL-5.7/mysql-5.7.26-linux-glibc2.12-x86_64.tar.gz\n复制代码\n```\n\n### 2、安装&配置：\n\n##### 依赖\n\nMySQL依赖libaio库，如果没有先安装一下：\n\n```\nshell> yum install libaio\n复制代码\n```\n\n##### 创建mysql用户\n\n不需要登录的一个系统账号，启动MySQL服务时会使用该账号\n\n```\nshell> groupadd mysql\nshell> useradd -r -g mysql -s /bin/false mysql\n复制代码\n```\n\n##### 解压并创建链接\n\n```\nshell> cd /usr/local\nshell> tar zxvf /path/to/mysql-5.7.26-linux-glibc2.12-x86_64.tar.gz\nshell> ln -s mysql-5.7.26-linux-glibc2.12-x86_64/ mysql\n复制代码\n```\n\n##### 创建mysql-files目录\n\n这一步并不是必须的，可以设置secure_file_priv的值指向该目录（用于限制数据导入导出操作的目录）\n\n```\nshell> cd mysql\nshell> mkdir mysql-files\nshell> chown mysql:mysql mysql-files\nshell> chmod 750 mysql-files\n复制代码\n```\n\n##### 初始化\n\n```\nshell> bin/mysqld --initialize --user=mysql\n复制代码\n```\n\n如果初始化时报错如下：\n\n```\nerror while loading shared libraries: libnuma.so.1: cannot open shared object file: No such file or directory\n复制代码\n```\n\n是因为libnuma没有安装（或者默认安装的是32位），我们这里需要64位的：\n\n```\nshell> yum install numactl.x86_64\n复制代码\n```\n\n执行完后重新初始化即可 初始化成功后返回结果中有一行包含初始密码，第一次登录时要用到它：\n\n```\nA temporary password is generated for root@localhost: 8M0ary878s*U\n复制代码\n```\n\n##### 启用SSL（非必须）\n\n```\nshell> bin/mysql_ssl_rsa_setup\n复制代码\n```\n\n##### 启动\n\n```\nshell> bin/mysqld_safe --user=mysql &\n复制代码\n```\n\n查看进程可以看到一些默认参数，可以在配置文件中修改这些参数\n\n```\nshell> ps -ef | grep mysql\nroot     14604 12719  0 00:03 pts/0    00:00:00 /bin/sh bin/mysqld_safe --user=mysql\nmysql    14674 14604  0 00:03 pts/0    00:00:00 /usr/local/mysql/bin/mysqld --basedir=/usr/local/mysql --datadir=/usr/local/mysql/data --plugin-dir=/usr/local/mysql/lib/plugin --user=mysql --log-error=VM_2_24_centos.err --pid-file=VM_2_24_centos.pid\n复制代码\n```\n\n##### 设置环境变量\n\n避免每次执行mysql命令都要加上路径，在`/etc/profile`中添加：\n\n```\nexport PATH=$PATH:/usr/local/mysql/bin\n复制代码\n```\n\n##### 设置为服务\n\n```\nshell> cp support-files/mysql.server /etc/init.d/mysqld\nshell> service mysqld start|stop|restart|status\n复制代码\n```\n\n##### 开机启动\n\n```\nshell> chkconfig --add mysqld\nshell> chkconfig --list mysqld\nmysqld         \t0:关\t1:关\t2:开\t3:开\t4:开\t5:开\t6:关\n复制代码\n```\n\n_其他配置与yum、rpm相同，不再赘述_\n\n## 四、源码安装\n\n就别费这个劲了吧...\n\n## 结束语\n\n我们不是Linux运维专家，也不是MySQL专家，生在这个年代也不知算是幸福还是不幸，线上的环境已经越来越少有人（主要指平时写代码的人）手动去搞这些数据库、中间件的安装配置了，为什么呢？因为各种云产品实在是太方便了呀，一般的公司也不会差这几个钱，既方便又稳定，何乐而不为呢~但是我们自己搞一搞用于自己测试还是必要的，而且还有不少公司的开发环境、测试环境偶尔还是需要手动搞一下的，当然，还有那些个自己搞机房的巨头们。\n\n那我们既然不是专家，上面所写的内容如果有纰漏也是在所难免的，如果被看到了还希望能够及时批评指正~",[[1571540400061,["GJX@GJXAIOU",[[1,8,"7"],[-1,1511," "],[1,1512," "],[-1,1985," "],[1,1986," "]],[8,8],[9,9]]],[1571540400300,["GJX@GJXAIOU",[[1,9," "]],[9,9],[10,10]]],[1571540401780,["GJX@GJXAIOU",[[1,12," "]],[12,12],[13,13]]],[1571540699425,["GJX@GJXAIOU",[[-1,29,"最近某云搞活动，买了个服务器作为平时学习和测试用，新机器啥也没有，一些常用软件的安装是免不了的，于是乎想着把安装过程都详细记录下来，一是做个备忘，二是给有需要的同学作个参考。"]],[29,116],[29,29]]],[1571540700273,["GJX@GJXAIOU",[[-1,30,"\n"]],[29,29],[28,28]]],[1571540707580,["GJX@GJXAIOU",[[-1,415,"为了测试不同安装方式，反复折腾了好几次，装了删，删了装，每个步骤都是亲测成功的，每条命令都是亲自执行过的，可以放心使用\n\n咱们闲话少说，书归正传（这闲话就不少了...）\n"]],[415,500],[415,415]]],[1571540713353,["GJX@GJXAIOU",[[-1,597,"复制代码"]],[597,601],[597,597]]],[1571540713801,["GJX@GJXAIOU",[[-1,597,"\n"]],[597,597],[596,596]]],[1571540716122,["GJX@GJXAIOU",[[-1,641,"\n"]],[641,641],[640,640]]],[1571540717537,["GJX@GJXAIOU",[[-1,750,"复制代码"]],[750,754],[750,750]]],[1571540719347,["GJX@GJXAIOU",[[-1,756,"_"]],[757,757],[756,756]]],[1571540720761,["GJX@GJXAIOU",[[-1,755,"\n"]],[756,756],[755,755]]],[1571540721730,["GJX@GJXAIOU",[[-1,750,"\n"]],[750,750],[749,749]]],[1571540723537,["GJX@GJXAIOU",[[-1,820,"\n"]],[820,820],[819,819]]],[1571540724691,["GJX@GJXAIOU",[[-1,850,"复制代码"]],[850,854],[850,850]]],[1571540725222,["GJX@GJXAIOU",[[-1,850,"\n"]],[850,850],[849,849]]],[1571540727409,["GJX@GJXAIOU",[[-1,892,"\n"]],[892,892],[891,891]]],[1571540728904,["GJX@GJXAIOU",[[-1,923,"复制代码"]],[923,927],[923,923]]],[1571540729290,["GJX@GJXAIOU",[[-1,923,"\n"]],[923,923],[922,922]]],[1571540732004,["GJX@GJXAIOU",[[-1,958,">"]],[958,959],[958,958]]],[1571540735865,["GJX@GJXAIOU",[[-1,1263,"复制代码"]],[1263,1267],[1263,1263]]],[1571540736226,["GJX@GJXAIOU",[[-1,1263,"\n"]],[1263,1263],[1262,1262]]],[1571540739553,["GJX@GJXAIOU",[[-1,1496,"复制代码"]],[1496,1500],[1496,1496]]],[1571540739940,["GJX@GJXAIOU",[[-1,1496,"\n"]],[1496,1496],[1495,1495]]],[1571540742650,["GJX@GJXAIOU",[[-1,1589,"复制代码"]],[1589,1593],[1589,1589]]],[1571540743505,["GJX@GJXAIOU",[[-1,1516,"\n"]],[1516,1516],[1515,1515]]],[1571540744331,["GJX@GJXAIOU",[[-1,1588,"\n"]],[1588,1588],[1587,1587]]],[1571540755860,["GJX@GJXAIOU",[[-1,1516,"```\nshell> sudo rpm -Uvh platform-and-version-specific-package-name.rpm\n```"]],[1591,1591],[1516,1516]]],[1571540757188,["GJX@GJXAIOU",[[-1,1517,"\n"]],[1517,1517],[1516,1516]]],[1571540757519,["GJX@GJXAIOU",[[-1,1516,"\n"]],[1516,1516],[1515,1515]]],[1571540758331,["GJX@GJXAIOU",[[-1,1539,"\n"]],[1539,1539],[1538,1538]]],[1571540770483,["GJX@GJXAIOU",[[-1,2064,"复制代码"]],[2064,2068],[2064,2064]]],[1571540770892,["GJX@GJXAIOU",[[-1,2064,"\n"]],[2064,2064],[2063,2063]]],[1571540774913,["GJX@GJXAIOU",[[-1,2327,"复制代码"]],[2327,2331],[2327,2327]]],[1571540775317,["GJX@GJXAIOU",[[-1,2327,"\n"]],[2327,2327],[2326,2326]]],[1571540784830,["GJX@GJXAIOU",[[1,2169,"**"],[1,2190,"**"]],[2169,2190],[2169,2194]]],[1571540787699,["GJX@GJXAIOU",[[-1,2347,"\n"]],[2347,2347],[2346,2346]]],[1571540789913,["GJX@GJXAIOU",[[-1,2565,"\n"]],[2565,2565],[2564,2564]]],[1571540791286,["GJX@GJXAIOU",[[-1,2761,"复制代码"]],[2761,2765],[2761,2761]]],[1571540791612,["GJX@GJXAIOU",[[-1,2761,"\n"]],[2761,2761],[2760,2760]]],[1571540793145,["GJX@GJXAIOU",[[-1,2468,"复制代码"]],[2468,2472],[2468,2468]]],[1571540793433,["GJX@GJXAIOU",[[-1,2468,"\n"]],[2468,2468],[2467,2467]]],[1571540795315,["GJX@GJXAIOU",[[-1,2773,"\n"]],[2773,2773],[2772,2772]]],[1571540796596,["GJX@GJXAIOU",[[-1,2995,"复制代码"]],[2995,2999],[2995,2995]]],[1571540796902,["GJX@GJXAIOU",[[-1,2995,"\n"]],[2995,2995],[2994,2994]]],[1571540799090,["GJX@GJXAIOU",[[-1,3021,"\n"]],[3021,3021],[3020,3020]]],[1571540800338,["GJX@GJXAIOU",[[-1,3066,"复制代码"]],[3066,3070],[3066,3066]]],[1571540801473,["GJX@GJXAIOU",[[-1,3072,"_"]],[3073,3073],[3072,3072]]],[1571540802348,["GJX@GJXAIOU",[[-1,3066,"\n"]],[3066,3066],[3065,3065]]],[1571540803909,["GJX@GJXAIOU",[[-1,3110,"\n"]],[3110,3110],[3109,3109]]],[1571540805189,["GJX@GJXAIOU",[[-1,3161,"复制代码"]],[3161,3165],[3161,3161]]],[1571540805521,["GJX@GJXAIOU",[[-1,3161,"\n"]],[3161,3161],[3160,3160]]],[1571540808004,["GJX@GJXAIOU",[[-1,3340,"\n"]],[3340,3340],[3339,3339]]],[1571540809107,["GJX@GJXAIOU",[[-1,3387,"复制代码"]],[3387,3391],[3387,3387]]],[1571540809450,["GJX@GJXAIOU",[[-1,3387,"\n"]],[3387,3387],[3386,3386]]],[1571540810778,["GJX@GJXAIOU",[[-1,3402,"\n"]],[3402,3402],[3401,3401]]],[1571549974252,["GJX@GJXAIOU",[[-1,4178,"复制代码"]],[4178,4182],[4178,4178]]],[1571549974705,["GJX@GJXAIOU",[[-1,4178,"\n"]],[4178,4178],[4177,4177]]],[1571549975924,["GJX@GJXAIOU",[[-1,4020,"复制代码"]],[4020,4024],[4020,4020]]],[1571549976254,["GJX@GJXAIOU",[[-1,4020,"\n"]],[4020,4020],[4019,4019]]],[1571549978236,["GJX@GJXAIOU",[[-1,3969,"复制代码"]],[3969,3973],[3969,3969]]],[1571549978544,["GJX@GJXAIOU",[[-1,3969,"\n"]],[3969,3969],[3968,3968]]],[1571557448516,["GJX@GJXAIOU",[[1,4173,"\n"]],[4172,4172],[4173,4173]]],[1571557456909,["GJX@GJXAIOU",[[1,4680,"\n"]],[4680,4680],[4681,4681]]],[1571557457149,["GJX@GJXAIOU",[[1,4681,"\n"]],[4681,4681],[4682,4682]]],[1571557457236,["GJX@GJXAIOU",[[1,4682,"\n"]],[4682,4682],[4683,4683]]],[1571557483256,["GJX@GJXAIOU",[[-1,4362,"修改配置文件`/etc/my.cnf`，添加`validate_password=OFF`"]],[4362,4407],[4362,4362]]],[1571557488175,["GJX@GJXAIOU",[[-1,4358,"3.  ，保存并重启MySQL"]],[4358,4373],[4358,4358]]],[1571557490021,["GJX@GJXAIOU",[[1,4360,"\n"]],[4358,4358],[4359,4359]]],[1571557492112,["GJX@GJXAIOU",[[1,4359,"ju"]],[4359,4359],[4361,4361]]],[1571557492798,["GJX@GJXAIOU",[[-1,4359,"ju"]],[4361,4361],[4359,4359]]],[1571557493332,["GJX@GJXAIOU",[[-1,4360,"\n"]],[4359,4359],[4358,4358]]],[1571557495385,["GJX@GJXAIOU",[[1,4358,"****"]],[4358,4358],[4360,4360]]],[1571557497586,["GJX@GJXAIOU",[[1,4360,"具体方法"]],[4360,4360],[4364,4364]]],[1571557499329,["GJX@GJXAIOU",[[1,4366,"："]],[4366,4366],[4367,4367]]],[1571557499586,["GJX@GJXAIOU",[[1,4369,"\n"]],[4367,4367],[4368,4368]]],[1571557518074,["GJX@GJXAIOU",[[1,4368,"想设置符合的密码，然后设置上面两个策略"]],[4368,4368],[4387,4387]]],[1571557518855,["GJX@GJXAIOU",[[1,4389,"\n"]],[4387,4387],[4388,4388]]],[1571557520802,["GJX@GJXAIOU",[[1,4390,"\n"]],[4388,4388],[4389,4389]]],[1571557522134,["GJX@GJXAIOU",[[-1,4390,"\n"]],[4389,4389],[4388,4388]]],[1571557522357,["GJX@GJXAIOU",[[-1,4389,"\n"]],[4388,4388],[4387,4387]]],[1571557528710,["GJX@GJXAIOU",[[1,4399,"\n"]],[4399,4399],[4400,4400]]],[1571557531023,["GJX@GJXAIOU",[[1,4399,"ALTER USER 'root'@'localhost' IDENTIFIED BY 'password';"]],[4399,4399],[4454,4454]]],[1571557536112,["GJX@GJXAIOU",[[-1,4444,"password"]],[4452,4452],[4444,4444]]],[1571557539497,["GJX@GJXAIOU",[[1,4444,"Root-"]],[4444,4444],[4449,4449]]],[1571557540395,["GJX@GJXAIOU",[[-1,4447,"t-"]],[4449,4449],[4447,4447]]],[1571557541072,["GJX@GJXAIOU",[[1,4447,"_"]],[4447,4447],[4448,4448]]],[1571557545427,["GJX@GJXAIOU",[[1,4447,"t"]],[4447,4447],[4448,4448]]],[1571557548454,["GJX@GJXAIOU",[[1,4449,"12root"]],[4449,4449],[4455,4455]]],[1571557568606,["GJX@GJXAIOU",[[-1,4458," ALTER USER 'root'@'localhost' IDENTIFIED BY '123456';\nQuery OK, 0 rows affected (0.00 sec)\n复制代码"]],[4458,4554],[4458,4458]]],[1571557569150,["GJX@GJXAIOU",[[1,4458,"set global validate_password.policy=0;"]],[4458,4458],[4496,4496]]],[1571557573653,["GJX@GJXAIOU",[[1,4458,"my"]],[4458,4458],[4460,4460]]],[1571557573844,["GJX@GJXAIOU",[[1,4461,"s"]],[4460,4460],[4461,4461]]],[1571557575051,["GJX@GJXAIOU",[[1,4461,"ql>"]],[4461,4461],[4464,4464]]],[1571557580311,["GJX@GJXAIOU",[[1,4503,"\n"]],[4502,4502],[4503,4503]]],[1571557580924,["GJX@GJXAIOU",[[1,4503,"mysql>ALTER USER 'root'@'localhost' IDENTIFIED BY 'Root_12root';\nmysql>set global validate_password.policy=0;"]],[4503,4503],[4612,4612]]],[1571557581160,["GJX@GJXAIOU",[[1,4613,"\n"]],[4612,4612],[4613,4613]]],[1571557581551,["GJX@GJXAIOU",[[1,4613,"mysql>ALTER USER 'root'@'localhost' IDENTIFIED BY 'Root_12root';\nmysql>set global validate_password.policy=0;"]],[4613,4613],[4722,4722]]],[1571557585377,["GJX@GJXAIOU",[[-1,4503,"mysql>ALTER USER 'root'@'localhost' IDENTIFIED BY 'Root_12root';"]],[4503,4567],[4503,4503]]],[1571557585719,["GJX@GJXAIOU",[[-1,4503,"\n"]],[4503,4503],[4502,4502]]],[1571557587376,["GJX@GJXAIOU",[[-1,4548,"mysql>ALTER USER 'root'@'localhost' IDENTIFIED BY 'Root_12root';"]],[4548,4612],[4548,4548]]],[1571557587600,["GJX@GJXAIOU",[[-1,4548,"\n"]],[4548,4548],[4547,4547]]],[1571557599742,["GJX@GJXAIOU",[[-1,4538,"policy"],[1,4544,"length"],[1,4547,"\n"]],[4509,4547],[4548,4548]]],[1571557601673,["GJX@GJXAIOU",[[-1,4548,"\n"]],[4548,4548],[4547,4547]]],[1571557612462,["GJX@GJXAIOU",[[-1,4583,"policy"],[1,4589,"length"],[1,4592,"\n"]],[4554,4592],[4593,4593]]],[1571557621967,["GJX@GJXAIOU",[[-1,4554,"set global validate_password.length=0"],[1,4591,"ALTER USER 'root'@'localhost' IDENTIFIED BY 'GJXAIOU'"]],[4554,4593],[4609,4609]]],[1571557624037,["GJX@GJXAIOU",[[-1,4609,"\n"]],[4609,4609],[4608,4608]]],[1571557628525,["GJX@GJXAIOU",[[-1,4599,"GJXAIOU"]],[4606,4606],[4599,4599]]],[1571557630433,["GJX@GJXAIOU",[[1,4599,"123456"]],[4599,4599],[4605,4605]]],[1571557640238,["GJX@GJXAIOU",[[-1,4838,"复制代码"]],[4838,4842],[4838,4838]]],[1571557641396,["GJX@GJXAIOU",[[-1,4838,"\n"]],[4838,4838],[4837,4837]]],[1571557651054,["GJX@GJXAIOU",[[-1,4957,"复制代码"]],[4957,4961],[4957,4957]]],[1571557651541,["GJX@GJXAIOU",[[-1,4957,"\n"]],[4957,4957],[4956,4956]]],[1571557852779,["GJX@GJXAIOU",[[1,4199,"****"]],[4199,4199],[4201,4201]]],[1571557854041,["GJX@GJXAIOU",[[1,4201,"xiu"]],[4201,4201],[4204,4204]]],[1571557854877,["GJX@GJXAIOU",[[-1,4201,"xiu"]],[4204,4204],[4201,4201]]],[1571557862189,["GJX@GJXAIOU",[[1,4201,"修改 my.cng"]],[4201,4201],[4210,4210]]],[1571557862957,["GJX@GJXAIOU",[[-1,4209,"g"]],[4210,4210],[4209,4209]]],[1571557874617,["GJX@GJXAIOU",[[1,4209,"f 前要设置权限："]],[4209,4209],[4218,4218]]],[1571557878661,["GJX@GJXAIOU",[[-1,4217,"："]],[4218,4218],[4217,4217]]],[1571557890095,["GJX@GJXAIOU",[[1,4217,"，设置时候将权限返回回去"]],[4217,4217],[4229,4229]]],[1571558092839,["GJX@GJXAIOU",[[-1,4577,"0"]],[4578,4578],[4577,4577]]],[1571558093210,["GJX@GJXAIOU",[[1,4577,"1"]],[4577,4577],[4578,4578]]],[1571571214772,["GJX@GJXAIOU",[[1,4644,"CREATE USER 'repl'@'192.168.238.135' IDENTIFIED BY 'GJXAIOU_mysql';\n"]],[4644,4644],[4712,4712]]],[1571571220877,["GJX@GJXAIOU",[[-1,4703,"_mysql"]],[4709,4709],[4703,4703]]],[1571571223446,["GJX@GJXAIOU",[[1,4703,"——哦"]],[4703,4703],[4706,4706]]],[1571571225941,["GJX@GJXAIOU",[[-1,4703,"——哦"]],[4706,4706],[4703,4703]]],[1571571228137,["GJX@GJXAIOU",[[1,4703,"_o2o"]],[4703,4703],[4707,4707]]],[1571571233131,["GJX@GJXAIOU",[[-1,4644,"CREATE USER 'repl'@'192.168.238.135' IDENTIFIED BY 'GJXAIOU_o2o';"]],[4644,4709],[4644,4644]]]],null,"GJX@GJXAIOU"],["90a60f09-63b1-4f41-a110-85d75d9a3e02",1572098611056,"# CentOS7 安装 MySQL详解\n\n## 引言\n\n\nLinux上安装软件常见的几种方式：\n\n*   源码编译\n*   压缩包解压（一般为tar.gz）\n*   编译好的安装包（RPM、DPKG等）\n*   在线安装（YUM、APT等）\n\n以上几种方式便捷性依次增加，但通用性依次下降，比如直接下载压缩包进行解压，这种方式一般需要自己做一些额外的配置工作，但只要掌握了方法，各个平台基本都适用，YUM虽然简单，但是平台受限，网络受限，必要的时候还需要增加一些特定YUM源。\n\n几种安装方式最好都能掌握，原则上能用简单的就用简单的：YUM>RPM>tar.gz>源码\n\n本文是介绍MySQL在CentOS上的安装，主要步骤都是参考了MySQL官方文档：[dev.mysql.com/doc/refman/…](https://dev.mysql.com/doc/refman/5.7/en/installing.html)\n\n\n## 一、YUM\n\n#### 0、删除已安装的MySQL\n\n##### 检查MariaDB\n\n```\nshell> rpm -qa|grep mariadb\nmariadb-server-5.5.60-1.el7_5.x86_64\nmariadb-5.5.60-1.el7_5.x86_64\nmariadb-libs-5.5.60-1.el7_5.x86_64\n```\n\n##### 删除mariadb\n\n如果不存在（上面检查结果返回空）则跳过步骤\n```\nshell> rpm -e --nodeps mariadb-server\nshell> rpm -e --nodeps mariadb\nshell> rpm -e --nodeps mariadb-libs\n```\n其实yum方式安装是可以不用删除mariadb的，安装MySQL会覆盖掉之前已存在的mariadb_\n\n##### 检查MySQL\n```\nshell> rpm -qa|grep mysql\n```\n\n##### 删除MySQL\n\n如果不存在（上面检查结果返回空）则跳过步骤\n```\nshell> rpm -e --nodeps xxx\n```\n\n### 1、添加MySQL Yum Repository\n\n 从CentOS 7开始，MariaDB成为Yum源中默认的数据库安装包。也就是说在CentOS 7及以上的系统中使用yum安装MySQL默认安装的会是MariaDB（MySQL的一个分支）。如果想安装官方MySQL版本，需要使用MySQL提供的Yum源。\n\n##### 下载MySQL源\n\n官网地址：[dev.mysql.com/downloads/r…](https://dev.mysql.com/downloads/repo/yum/)\n\n查看系统版本：\n\n```\nshell> cat /etc/redhat-release\nCentOS Linux release 7.6.1810 (Core)\n```\n\n选择对应的版本进行下载，例如CentOS 7当前在官网查看最新Yum源的下载地址为： [dev.mysql.com/get/mysql80…](https://dev.mysql.com/get/mysql80-community-release-el7-3.noarch.rpm)\n\n```\nshell> wget https://dev.mysql.com/get/mysql80-community-release-el7-3.noarch.rpm\n```\n\n##### 安装MySQL源\n例如CentOS7当前最新MySQL源安装：\n```\nshell> sudo rpm -Uvh mysql80-community-release-el7-3.noarch.rpm\n复制代码\n```\n\n##### 检查是否安装成功\n\n执行成功后会在`/etc/yum.repos.d/`目录下生成两个repo文件`mysql-community.repo`及 `mysql-community-source.repo`\n\n并且通过`yum repolist`可以看到mysql相关资源\n\n```\nshell> yum repolist enabled | grep \"mysql.*-community.*\"\n!mysql-connectors-community/x86_64 MySQL Connectors Community                108\n!mysql-tools-community/x86_64      MySQL Tools Community                      90\n!mysql80-community/x86_64          MySQL 8.0 Community Server                113\n```\n\n### 2、选择MySQL版本\n\n使用MySQL Yum Repository安装MySQL，默认会选择当前最新的稳定版本，例如通过上面的MySQL源进行安装的话，默安装会选择MySQL 8.0版本，**如果就是想要安装该版本，可以直接跳过此步骤**，如果不是，比如我这里希望安装MySQL5.7版本，就需要“切换一下版本”：\n\n##### 查看当前MySQL Yum Repository中所有MySQL版本（每个版本在不同的子仓库中）\n\n```\nshell> yum repolist all | grep mysql\n```\n\n##### 切换版本\n```\nshell> sudo yum-config-manager --disable mysql80-community\nshell> sudo yum-config-manager --enable mysql57-community\n```\n\n除了使用yum-config-manager之外，还可以直接编辑`/etc/yum.repos.d/mysql-community.repo`文件\n\nenabled=0禁用\n```\n[mysql80-community]\nname=MySQL 8.0 Community Server\nbaseurl=http://repo.mysql.com/yum/mysql-8.0-community/el/7/$basearch/\nenabled=0\ngpgcheck=1\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-mysql\n```\n\nenabled=1启用\n```\n# Enable to use MySQL 5.7\n[mysql57-community]\nname=MySQL 5.7 Community Server\nbaseurl=http://repo.mysql.com/yum/mysql-5.7-community/el/7/$basearch/\nenabled=1\ngpgcheck=1\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-mysql\n```\n\n##### 检查当前启用的MySQL仓库\n```\nshell> yum repolist enabled | grep mysql\n```\n\n如果同时启用了多个仓库，安装时会选择最新版本_\n\n### 3、安装MySQL\n```\nshell> sudo yum install mysql-community-server\n```\n\n该命令会安装MySQL服务器 (mysql-community-server) 及其所需的依赖、相关组件，包括mysql-community-client、mysql-community-common、mysql-community-libs等\n\n如果带宽不够，这个步骤时间会比较长，请耐心等待~\n\n### 4、启动MySQL\n\n##### 启动\n```\nshell> sudo systemctl start mysqld.service\n```\n\nCentOS 6：\n```\nshell> sudo service mysqld start\n复制代码\n```\n\n##### 查看状态\n\n```\nshell> sudo systemctl status mysqld.service\n复制代码\n```\n\nCentOS 6：\n\n```\nshell> sudo service mysqld status\n复制代码\n```\n\n##### 停止\n\n```\nshell> sudo systemctl stop mysqld.service\n复制代码\n```\n\nCentOS 6：\n\n```\nshell> sudo service mysqld stop\n复制代码\n```\n\n##### 重启\n\n```\nshell> sudo systemctl restart mysqld.service\n复制代码\n```\n\nCentOS 6：\n\n```\nshell> sudo service mysqld restart\n复制代码\n```\n\n### 5、修改密码\n\n##### 初始密码\n\nMySQL第一次启动后会创建超级管理员账号`root@localhost`，初始密码存储在日志文件中：\n\n```\nshell> sudo grep 'temporary password' /var/log/mysqld.log\n```\n\n##### 修改默认密码\n\n```\nshell> mysql -uroot -p\n```\n\n```\nmysql> ALTER USER 'root'@'localhost' IDENTIFIED BY '123456';\nERROR 1819 (HY000): Your password does not satisfy the current policy requirements\n```\n\n\n出现上面的提示是因为密码太简单了，解决方法如下：\n**修改 my.cnf 前要设置权限，设置时候将权限返回回去**\n1.  使用复杂密码，MySQL默认的密码策略是要包含数字、字母及特殊字符；\n2.  如果只是测试用，不想用那么复杂的密码，可以修改默认策略，即`validate_password_policy`（以及`validate_password_length`等相关参数），使其支持简单密码的设定，具体方法可以自行百度；\n**具体方法**：\n想设置符合的密码，然后设置上面两个策略\n\n```\nmysql>ALTER USER 'root'@'localhost' IDENTIFIED BY 'Root_12root';\nmysql>set global validate_password.policy=0;\nmysql>set global validate_password.length=1;\nmysql>ALTER USER 'root'@'localhost' IDENTIFIED BY '123456';\n```\n\n\n### 6、允许root远程访问\n\n```\nmysql> GRANT ALL PRIVILEGES ON *.* TO 'root'@'%' IDENTIFIED BY '123456' WITH GRANT OPTION;\nmysql> FLUSH PRIVILEGES;\n复制代码\n```\n\n\n\n\n### 7、设置编码为utf8\n\n##### 查看编码\n\n```\nmysql> SHOW VARIABLES LIKE 'character%';\n```\n\n##### 设置编码\n\n编辑/etc/my.cnf，[mysqld]节点增加以下代码：\n\n```\n[mysqld]\ncharacter_set_server=utf8\ninit-connect='SET NAMES utf8'\n```\n\n### 8、设置开机启动\n\n```\nshell> systemctl enable mysqld\nshell> systemctl daemon-reload\n复制代码\n```\n\n## 二、RPM\n\n> 除安装过程外，其他步骤和yum方式安装相同，不再赘述\n\n### 0、删除已旧版本\n\n略\n\n### 1、下载MySQL安装包\n\n下载地址：[dev.mysql.com/downloads/m…](https://dev.mysql.com/downloads/mysql/)\n\n选择对应的版本：\n\n![](https://user-gold-cdn.xitu.io/2019/6/18/16b66894c80e9b32?imageView2/0/w/1280/h/960/format/webp/ignore-error/1)\n\n```\nshell> wget https://dev.mysql.com/get/Downloads/MySQL-5.7/mysql-5.7.26-1.el7.x86_64.rpm-bundle.tar\n复制代码\n```\n\n### 2、安装MySQL\n\n##### 解压（解打包）\n\n```\nshell> tar -xvf mysql-5.7.26-1.el7.x86_64.rpm-bundle.tar\ntar -xvf mysql-5.7.26-1.el7.x86_64.rpm-bundle.tar\nmysql-community-embedded-devel-5.7.26-1.el7.x86_64.rpm\nmysql-community-libs-5.7.26-1.el7.x86_64.rpm\nmysql-community-embedded-5.7.26-1.el7.x86_64.rpm\nmysql-community-test-5.7.26-1.el7.x86_64.rpm\nmysql-community-embedded-compat-5.7.26-1.el7.x86_64.rpm\nmysql-community-common-5.7.26-1.el7.x86_64.rpm\nmysql-community-devel-5.7.26-1.el7.x86_64.rpm\nmysql-community-client-5.7.26-1.el7.x86_64.rpm\nmysql-community-server-5.7.26-1.el7.x86_64.rpm\n复制代码\n```\n\n我们主要安装的是这四个（如果有需要也可以一并安装其它的）：\n\n```\nmysql-community-libs-5.7.26-1.el7.x86_64.rpm\nmysql-community-common-5.7.26-1.el7.x86_64.rpm\nmysql-community-client-5.7.26-1.el7.x86_64.rpm\nmysql-community-server-5.7.26-1.el7.x86_64.rpm\n复制代码\n```\n\n如果不想下载rpm-bundle，官网也提供单独的rpm下载链接\n\n##### 安装\n\n各rpm包是有依赖关系的，所以需要按照一定顺序进行安装，安装期间如果提示缺少哪些依赖也要先安装相应的包：\n\n```\nshell> rpm -ivh mysql-community-common-5.7.26-1.el7.x86_64.rpm\nshell> rpm -ivh mysql-community-libs-5.7.26-1.el7.x86_64.rpm\nshell> rpm -ivh mysql-community-client-5.7.26-1.el7.x86_64.rpm\nshell> rpm -ivh mysql-community-server-5.7.26-1.el7.x86_64.rpm\n复制代码\n```\n\n还有一种简单的方式，可以自动处理各个包之间的依赖关系并自动下载缺少的依赖：\n\n```\nshell> yum install mysql-community-{server,client,common,libs}-*\n复制代码\n```\n\n_注意：上面的`yum install`命令需要在tar解压之后的各个rpm包所在目录内执行，否则就变成yum方式安装了，需要配置MySQL的yum源并且速度很慢，还要当前机器支持外网访问_\n\n### 3、设置\n\n略\n\n## 三、tar.gz\n\n### 0、删除旧版本\n\n略\n\n### 1、下载\n\n下载地址：[dev.mysql.com/downloads/m…](https://dev.mysql.com/downloads/mysql/)\n\n选择对应的版本：\n\n![](https://user-gold-cdn.xitu.io/2019/6/18/16b668a1b3c258aa?imageView2/0/w/1280/h/960/format/webp/ignore-error/1)\n\n```\nshell> wget https://dev.mysql.com/get/Downloads/MySQL-5.7/mysql-5.7.26-linux-glibc2.12-x86_64.tar.gz\n复制代码\n```\n\n### 2、安装&配置：\n\n##### 依赖\n\nMySQL依赖libaio库，如果没有先安装一下：\n\n```\nshell> yum install libaio\n复制代码\n```\n\n##### 创建mysql用户\n\n不需要登录的一个系统账号，启动MySQL服务时会使用该账号\n\n```\nshell> groupadd mysql\nshell> useradd -r -g mysql -s /bin/false mysql\n复制代码\n```\n\n##### 解压并创建链接\n\n```\nshell> cd /usr/local\nshell> tar zxvf /path/to/mysql-5.7.26-linux-glibc2.12-x86_64.tar.gz\nshell> ln -s mysql-5.7.26-linux-glibc2.12-x86_64/ mysql\n复制代码\n```\n\n##### 创建mysql-files目录\n\n这一步并不是必须的，可以设置secure_file_priv的值指向该目录（用于限制数据导入导出操作的目录）\n\n```\nshell> cd mysql\nshell> mkdir mysql-files\nshell> chown mysql:mysql mysql-files\nshell> chmod 750 mysql-files\n复制代码\n```\n\n##### 初始化\n\n```\nshell> bin/mysqld --initialize --user=mysql\n复制代码\n```\n\n如果初始化时报错如下：\n\n```\nerror while loading shared libraries: libnuma.so.1: cannot open shared object file: No such file or directory\n复制代码\n```\n\n是因为libnuma没有安装（或者默认安装的是32位），我们这里需要64位的：\n\n```\nshell> yum install numactl.x86_64\n复制代码\n```\n\n执行完后重新初始化即可 初始化成功后返回结果中有一行包含初始密码，第一次登录时要用到它：\n\n```\nA temporary password is generated for root@localhost: 8M0ary878s*U\n复制代码\n```\n\n##### 启用SSL（非必须）\n\n```\nshell> bin/mysql_ssl_rsa_setup\n复制代码\n```\n\n##### 启动\n\n```\nshell> bin/mysqld_safe --user=mysql &\n复制代码\n```\n\n查看进程可以看到一些默认参数，可以在配置文件中修改这些参数\n\n```\nshell> ps -ef | grep mysql\nroot     14604 12719  0 00:03 pts/0    00:00:00 /bin/sh bin/mysqld_safe --user=mysql\nmysql    14674 14604  0 00:03 pts/0    00:00:00 /usr/local/mysql/bin/mysqld --basedir=/usr/local/mysql --datadir=/usr/local/mysql/data --plugin-dir=/usr/local/mysql/lib/plugin --user=mysql --log-error=VM_2_24_centos.err --pid-file=VM_2_24_centos.pid\n复制代码\n```\n\n##### 设置环境变量\n\n避免每次执行mysql命令都要加上路径，在`/etc/profile`中添加：\n\n```\nexport PATH=$PATH:/usr/local/mysql/bin\n复制代码\n```\n\n##### 设置为服务\n\n```\nshell> cp support-files/mysql.server /etc/init.d/mysqld\nshell> service mysqld start|stop|restart|status\n复制代码\n```\n\n##### 开机启动\n\n```\nshell> chkconfig --add mysqld\nshell> chkconfig --list mysqld\nmysqld         \t0:关\t1:关\t2:开\t3:开\t4:开\t5:开\t6:关\n复制代码\n```\n\n_其他配置与yum、rpm相同，不再赘述_\n\n## 四、源码安装\n\n就别费这个劲了吧...\n\n## 结束语\n\n我们不是Linux运维专家，也不是MySQL专家，生在这个年代也不知算是幸福还是不幸，线上的环境已经越来越少有人（主要指平时写代码的人）手动去搞这些数据库、中间件的安装配置了，为什么呢？因为各种云产品实在是太方便了呀，一般的公司也不会差这几个钱，既方便又稳定，何乐而不为呢~但是我们自己搞一搞用于自己测试还是必要的，而且还有不少公司的开发环境、测试环境偶尔还是需要手动搞一下的，当然，还有那些个自己搞机房的巨头们。\n\n那我们既然不是专家，上面所写的内容如果有纰漏也是在所难免的，如果被看到了还希望能够及时批评指正~",[[1572098577859,["GJX@GJXAIOU",[[-1,1607,"复制代码"]],[1607,1611],[1607,1607]]]],null,"GJX@GJXAIOU"],["f5992385-f180-4f26-a2c5-4c791e4b86ad",1572158482940,"# CentOS7 安装 MySQL详解\n\n## 引言\n\n\nLinux上安装软件常见的几种方式：\n\n*   源码编译\n*   压缩包解压（一般为tar.gz）\n*   编译好的安装包（RPM、DPKG等）\n*   在线安装（YUM、APT等）\n\n以上几种方式便捷性依次增加，但通用性依次下降，比如直接下载压缩包进行解压，这种方式一般需要自己做一些额外的配置工作，但只要掌握了方法，各个平台基本都适用，YUM虽然简单，但是平台受限，网络受限，必要的时候还需要增加一些特定YUM源。\n\n几种安装方式最好都能掌握，原则上能用简单的就用简单的：YUM>RPM>tar.gz>源码\n\n本文是介绍MySQL在CentOS上的安装，主要步骤都是参考了MySQL官方文档：[dev.mysql.com/doc/refman/…](https://dev.mysql.com/doc/refman/5.7/en/installing.html)\n\n\n## 一、YUM\n\n#### 0、删除已安装的MySQL\n\n##### 检查MariaDB\n\n```\nshell> rpm -qa|grep mariadb\nmariadb-server-5.5.60-1.el7_5.x86_64\nmariadb-5.5.60-1.el7_5.x86_64\nmariadb-libs-5.5.60-1.el7_5.x86_64\n```\n\n##### 删除mariadb\n\n如果不存在（上面检查结果返回空）则跳过步骤\n```\nshell> rpm -e --nodeps mariadb-server\nshell> rpm -e --nodeps mariadb\nshell> rpm -e --nodeps mariadb-libs\n```\n其实yum方式安装是可以不用删除mariadb的，安装MySQL会覆盖掉之前已存在的mariadb_\n\n##### 检查MySQL\n```\nshell> rpm -qa|grep mysql\n```\n\n##### 删除MySQL\n\n如果不存在（上面检查结果返回空）则跳过步骤\n```\nshell> rpm -e --nodeps xxx\n```\n\n### 1、添加MySQL Yum Repository\n\n 从CentOS 7开始，MariaDB成为Yum源中默认的数据库安装包。也就是说在CentOS 7及以上的系统中使用yum安装MySQL默认安装的会是MariaDB（MySQL的一个分支）。如果想安装官方MySQL版本，需要使用MySQL提供的Yum源。\n\n##### 下载MySQL源\n\n官网地址：[dev.mysql.com/downloads/r…](https://dev.mysql.com/downloads/repo/yum/)\n\n查看系统版本：\n\n```\nshell> cat /etc/redhat-release\nCentOS Linux release 7.6.1810 (Core)\n```\n\n选择对应的版本进行下载，例如CentOS 7当前在官网查看最新Yum源的下载地址为： [dev.mysql.com/get/mysql80…](https://dev.mysql.com/get/mysql80-community-release-el7-3.noarch.rpm)\n\n```\nshell> wget https://dev.mysql.com/get/mysql80-community-release-el7-3.noarch.rpm\n```\n\n##### 安装MySQL源\n例如CentOS7当前最新MySQL源安装：\n```\nshell> sudo rpm -Uvh mysql80-community-release-el7-3.noarch.rpm\n\n```\n\n##### 检查是否安装成功\n\n执行成功后会在`/etc/yum.repos.d/`目录下生成两个repo文件`mysql-community.repo`及 `mysql-community-source.repo`\n\n并且通过`yum repolist`可以看到mysql相关资源\n\n```\nshell> yum repolist enabled | grep \"mysql.*-community.*\"\n!mysql-connectors-community/x86_64 MySQL Connectors Community                108\n!mysql-tools-community/x86_64      MySQL Tools Community                      90\n!mysql80-community/x86_64          MySQL 8.0 Community Server                113\n```\n\n### 2、选择MySQL版本\n\n使用MySQL Yum Repository安装MySQL，默认会选择当前最新的稳定版本，例如通过上面的MySQL源进行安装的话，默安装会选择MySQL 8.0版本，**如果就是想要安装该版本，可以直接跳过此步骤**，如果不是，比如我这里希望安装MySQL5.7版本，就需要“切换一下版本”：\n\n##### 查看当前MySQL Yum Repository中所有MySQL版本（每个版本在不同的子仓库中）\n\n```\nshell> yum repolist all | grep mysql\n```\n\n##### 切换版本\n```\nshell> sudo yum-config-manager --disable mysql80-community\nshell> sudo yum-config-manager --enable mysql57-community\n```\n\n除了使用yum-config-manager之外，还可以直接编辑`/etc/yum.repos.d/mysql-community.repo`文件\n\nenabled=0禁用\n```\n[mysql80-community]\nname=MySQL 8.0 Community Server\nbaseurl=http://repo.mysql.com/yum/mysql-8.0-community/el/7/$basearch/\nenabled=0\ngpgcheck=1\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-mysql\n```\n\nenabled=1启用\n```\n# Enable to use MySQL 5.7\n[mysql57-community]\nname=MySQL 5.7 Community Server\nbaseurl=http://repo.mysql.com/yum/mysql-5.7-community/el/7/$basearch/\nenabled=1\ngpgcheck=1\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-mysql\n```\n\n##### 检查当前启用的MySQL仓库\n```\nshell> yum repolist enabled | grep mysql\n```\n\n如果同时启用了多个仓库，安装时会选择最新版本_\n\n### 3、安装MySQL\n```\nshell> sudo yum install mysql-community-server\n```\n\n该命令会安装MySQL服务器 (mysql-community-server) 及其所需的依赖、相关组件，包括mysql-community-client、mysql-community-common、mysql-community-libs等\n\n如果带宽不够，这个步骤时间会比较长，请耐心等待~\n\n### 4、启动MySQL\n\n##### 启动\n```\nshell> sudo systemctl start mysqld.service\n```\n\nCentOS 6：\n```\nshell> sudo service mysqld start\n复制代码\n```\n\n##### 查看状态\n\n```\nshell> sudo systemctl status mysqld.service\n复制代码\n```\n\nCentOS 6：\n\n```\nshell> sudo service mysqld status\n复制代码\n```\n\n##### 停止\n\n```\nshell> sudo systemctl stop mysqld.service\n复制代码\n```\n\nCentOS 6：\n\n```\nshell> sudo service mysqld stop\n复制代码\n```\n\n##### 重启\n\n```\nshell> sudo systemctl restart mysqld.service\n复制代码\n```\n\nCentOS 6：\n\n```\nshell> sudo service mysqld restart\n复制代码\n```\n\n### 5、修改密码\n\n##### 初始密码\n\nMySQL第一次启动后会创建超级管理员账号`root@localhost`，初始密码存储在日志文件中：\n\n```\nshell> sudo grep 'temporary password' /var/log/mysqld.log\n```\n\n##### 修改默认密码\n\n```\nshell> mysql -uroot -p\n```\n\n```\nmysql> ALTER USER 'root'@'localhost' IDENTIFIED BY '123456';\nERROR 1819 (HY000): Your password does not satisfy the current policy requirements\n```\n\n\n出现上面的提示是因为密码太简单了，解决方法如下：\n**修改 my.cnf 前要设置权限，设置时候将权限返回回去**\n1.  使用复杂密码，MySQL默认的密码策略是要包含数字、字母及特殊字符；\n2.  如果只是测试用，不想用那么复杂的密码，可以修改默认策略，即`validate_password_policy`（以及`validate_password_length`等相关参数），使其支持简单密码的设定，具体方法可以自行百度；\n**具体方法**：\n想设置符合的密码，然后设置上面两个策略\n\n```\nmysql>ALTER USER 'root'@'localhost' IDENTIFIED BY 'Root_12root';\nmysql>set global validate_password.policy=0;\nmysql>set global validate_password.length=1;\nmysql>ALTER USER 'root'@'localhost' IDENTIFIED BY '123456';\n```\n\n\n### 6、允许root远程访问\n\n```\nmysql> GRANT ALL PRIVILEGES ON *.* TO 'root'@'%' IDENTIFIED BY '123456' WITH GRANT OPTION;\nmysql> FLUSH PRIVILEGES;\n复制代码\n```\n\n\n\n\n### 7、设置编码为utf8\n\n##### 查看编码\n\n```\nmysql> SHOW VARIABLES LIKE 'character%';\n```\n\n##### 设置编码\n\n编辑/etc/my.cnf，[mysqld]节点增加以下代码：\n\n```\n[mysqld]\ncharacter_set_server=utf8\ninit-connect='SET NAMES utf8'\n```\n\n### 8、设置开机启动\n\n```\nshell> systemctl enable mysqld\nshell> systemctl daemon-reload\n复制代码\n```\n\n## 二、RPM\n\n> 除安装过程外，其他步骤和yum方式安装相同，不再赘述\n\n### 0、删除已旧版本\n\n略\n\n### 1、下载MySQL安装包\n\n下载地址：[dev.mysql.com/downloads/m…](https://dev.mysql.com/downloads/mysql/)\n\n选择对应的版本：\n\n![](https://user-gold-cdn.xitu.io/2019/6/18/16b66894c80e9b32?imageView2/0/w/1280/h/960/format/webp/ignore-error/1)\n\n```\nshell> wget https://dev.mysql.com/get/Downloads/MySQL-5.7/mysql-5.7.26-1.el7.x86_64.rpm-bundle.tar\n复制代码\n```\n\n### 2、安装MySQL\n\n##### 解压（解打包）\n\n```\nshell> tar -xvf mysql-5.7.26-1.el7.x86_64.rpm-bundle.tar\ntar -xvf mysql-5.7.26-1.el7.x86_64.rpm-bundle.tar\nmysql-community-embedded-devel-5.7.26-1.el7.x86_64.rpm\nmysql-community-libs-5.7.26-1.el7.x86_64.rpm\nmysql-community-embedded-5.7.26-1.el7.x86_64.rpm\nmysql-community-test-5.7.26-1.el7.x86_64.rpm\nmysql-community-embedded-compat-5.7.26-1.el7.x86_64.rpm\nmysql-community-common-5.7.26-1.el7.x86_64.rpm\nmysql-community-devel-5.7.26-1.el7.x86_64.rpm\nmysql-community-client-5.7.26-1.el7.x86_64.rpm\nmysql-community-server-5.7.26-1.el7.x86_64.rpm\n复制代码\n```\n\n我们主要安装的是这四个（如果有需要也可以一并安装其它的）：\n\n```\nmysql-community-libs-5.7.26-1.el7.x86_64.rpm\nmysql-community-common-5.7.26-1.el7.x86_64.rpm\nmysql-community-client-5.7.26-1.el7.x86_64.rpm\nmysql-community-server-5.7.26-1.el7.x86_64.rpm\n复制代码\n```\n\n如果不想下载rpm-bundle，官网也提供单独的rpm下载链接\n\n##### 安装\n\n各rpm包是有依赖关系的，所以需要按照一定顺序进行安装，安装期间如果提示缺少哪些依赖也要先安装相应的包：\n\n```\nshell> rpm -ivh mysql-community-common-5.7.26-1.el7.x86_64.rpm\nshell> rpm -ivh mysql-community-libs-5.7.26-1.el7.x86_64.rpm\nshell> rpm -ivh mysql-community-client-5.7.26-1.el7.x86_64.rpm\nshell> rpm -ivh mysql-community-server-5.7.26-1.el7.x86_64.rpm\n复制代码\n```\n\n还有一种简单的方式，可以自动处理各个包之间的依赖关系并自动下载缺少的依赖：\n\n```\nshell> yum install mysql-community-{server,client,common,libs}-*\n复制代码\n```\n\n_注意：上面的`yum install`命令需要在tar解压之后的各个rpm包所在目录内执行，否则就变成yum方式安装了，需要配置MySQL的yum源并且速度很慢，还要当前机器支持外网访问_\n\n### 3、设置\n\n略\n\n## 三、tar.gz\n\n### 0、删除旧版本\n\n略\n\n### 1、下载\n\n下载地址：[dev.mysql.com/downloads/m…](https://dev.mysql.com/downloads/mysql/)\n\n选择对应的版本：\n\n![](https://user-gold-cdn.xitu.io/2019/6/18/16b668a1b3c258aa?imageView2/0/w/1280/h/960/format/webp/ignore-error/1)\n\n```\nshell> wget https://dev.mysql.com/get/Downloads/MySQL-5.7/mysql-5.7.26-linux-glibc2.12-x86_64.tar.gz\n复制代码\n```\n\n### 2、安装&配置：\n\n##### 依赖\n\nMySQL依赖libaio库，如果没有先安装一下：\n\n```\nshell> yum install libaio\n复制代码\n```\n\n##### 创建mysql用户\n\n不需要登录的一个系统账号，启动MySQL服务时会使用该账号\n\n```\nshell> groupadd mysql\nshell> useradd -r -g mysql -s /bin/false mysql\n复制代码\n```\n\n##### 解压并创建链接\n\n```\nshell> cd /usr/local\nshell> tar zxvf /path/to/mysql-5.7.26-linux-glibc2.12-x86_64.tar.gz\nshell> ln -s mysql-5.7.26-linux-glibc2.12-x86_64/ mysql\n复制代码\n```\n\n##### 创建mysql-files目录\n\n这一步并不是必须的，可以设置secure_file_priv的值指向该目录（用于限制数据导入导出操作的目录）\n\n```\nshell> cd mysql\nshell> mkdir mysql-files\nshell> chown mysql:mysql mysql-files\nshell> chmod 750 mysql-files\n复制代码\n```\n\n##### 初始化\n\n```\nshell> bin/mysqld --initialize --user=mysql\n复制代码\n```\n\n如果初始化时报错如下：\n\n```\nerror while loading shared libraries: libnuma.so.1: cannot open shared object file: No such file or directory\n复制代码\n```\n\n是因为libnuma没有安装（或者默认安装的是32位），我们这里需要64位的：\n\n```\nshell> yum install numactl.x86_64\n复制代码\n```\n\n执行完后重新初始化即可 初始化成功后返回结果中有一行包含初始密码，第一次登录时要用到它：\n\n```\nA temporary password is generated for root@localhost: 8M0ary878s*U\n复制代码\n```\n\n##### 启用SSL（非必须）\n\n```\nshell> bin/mysql_ssl_rsa_setup\n复制代码\n```\n\n##### 启动\n\n```\nshell> bin/mysqld_safe --user=mysql &\n复制代码\n```\n\n查看进程可以看到一些默认参数，可以在配置文件中修改这些参数\n\n```\nshell> ps -ef | grep mysql\nroot     14604 12719  0 00:03 pts/0    00:00:00 /bin/sh bin/mysqld_safe --user=mysql\nmysql    14674 14604  0 00:03 pts/0    00:00:00 /usr/local/mysql/bin/mysqld --basedir=/usr/local/mysql --datadir=/usr/local/mysql/data --plugin-dir=/usr/local/mysql/lib/plugin --user=mysql --log-error=VM_2_24_centos.err --pid-file=VM_2_24_centos.pid\n复制代码\n```\n\n##### 设置环境变量\n\n避免每次执行mysql命令都要加上路径，在`/etc/profile`中添加：\n\n```\nexport PATH=$PATH:/usr/local/mysql/bin\n复制代码\n```\n\n##### 设置为服务\n\n```\nshell> cp support-files/mysql.server /etc/init.d/mysqld\nshell> service mysqld start|stop|restart|status\n复制代码\n```\n\n##### 开机启动\n\n```\nshell> chkconfig --add mysqld\nshell> chkconfig --list mysqld\nmysqld         \t0:关\t1:关\t2:开\t3:开\t4:开\t5:开\t6:关\n复制代码\n```\n\n_其他配置与yum、rpm相同，不再赘述_\n\n## 四、源码安装\n\n就别费这个劲了吧...\n\n## 结束语\n\n我们不是Linux运维专家，也不是MySQL专家，生在这个年代也不知算是幸福还是不幸，线上的环境已经越来越少有人（主要指平时写代码的人）手动去搞这些数据库、中间件的安装配置了，为什么呢？因为各种云产品实在是太方便了呀，一般的公司也不会差这几个钱，既方便又稳定，何乐而不为呢~但是我们自己搞一搞用于自己测试还是必要的，而且还有不少公司的开发环境、测试环境偶尔还是需要手动搞一下的，当然，还有那些个自己搞机房的巨头们。\n\n那我们既然不是专家，上面所写的内容如果有纰漏也是在所难免的，如果被看到了还希望能够及时批评指正~",[[1572158433840,["GJX@GJXAIOU",[[-1,4671,"GRANT ALL PRIVILEGES ON *.* TO 'root"],[1,4707,"create user 'GJXAIOU"],[-1,4712," IDENTIFIED BY '123456' WITH GRANT OPTION;"],[1,4754,"identified by 'gjx4874663916#';\n"]],[4671,4754],[4728,4728]]],[1572158439432,["GJX@GJXAIOU",[[-1,4714,"4874663916#"]],[4725,4725],[4714,4714]]],[1572158456585,["GJX@GJXAIOU",[[1,4717,"mysql> grant all privileges on *.* to 'GJXAIOU'@'%' with grant option;"]],[4717,4717],[4787,4787]]],[1572158461160,["GJX@GJXAIOU",[[-1,4813,"复制代码"]],[4813,4817],[4813,4813]]]],null,"GJX@GJXAIOU"],["d13d65ba-7dea-4242-8d74-5b1c2e7a1f09",1572945834866,"# CentOS7 安装 MySQL详解\n\n## 引言\n\n\nLinux上安装软件常见的几种方式：\n\n*   源码编译\n*   压缩包解压（一般为tar.gz）\n*   编译好的安装包（RPM、DPKG等）\n*   在线安装（YUM、APT等）\n\n以上几种方式便捷性依次增加，但通用性依次下降，比如直接下载压缩包进行解压，这种方式一般需要自己做一些额外的配置工作，但只要掌握了方法，各个平台基本都适用，YUM虽然简单，但是平台受限，网络受限，必要的时候还需要增加一些特定YUM源。\n\n几种安装方式最好都能掌握，原则上能用简单的就用简单的：YUM>RPM>tar.gz>源码\n\n本文是介绍MySQL在CentOS上的安装，主要步骤都是参考了MySQL官方文档：[dev.mysql.com/doc/refman/…](https://dev.mysql.com/doc/refman/5.7/en/installing.html)\n\n\n## 一、YUM\n\n#### 0、删除已安装的MySQL\n\n##### 检查MariaDB\n\n```\nshell> rpm -qa|grep mariadb\nmariadb-server-5.5.60-1.el7_5.x86_64\nmariadb-5.5.60-1.el7_5.x86_64\nmariadb-libs-5.5.60-1.el7_5.x86_64\n```\n\n##### 删除mariadb\n\n如果不存在（上面检查结果返回空）则跳过步骤\n```\nshell> rpm -e --nodeps mariadb-server\nshell> rpm -e --nodeps mariadb\nshell> rpm -e --nodeps mariadb-libs\n```\n其实yum方式安装是可以不用删除mariadb的，安装MySQL会覆盖掉之前已存在的mariadb_\n\n##### 检查MySQL\n```\nshell> rpm -qa|grep mysql\n```\n\n##### 删除MySQL\n\n如果不存在（上面检查结果返回空）则跳过步骤\n```\nshell> rpm -e --nodeps xxx\n```\n\n### 1、添加MySQL Yum Repository\n\n 从CentOS 7开始，MariaDB成为Yum源中默认的数据库安装包。也就是说在CentOS 7及以上的系统中使用yum安装MySQL默认安装的会是MariaDB（MySQL的一个分支）。如果想安装官方MySQL版本，需要使用MySQL提供的Yum源。\n\n##### 下载MySQL源\n\n官网地址：[dev.mysql.com/downloads/r…](https://dev.mysql.com/downloads/repo/yum/)\n\n查看系统版本：\n\n```\nshell> cat /etc/redhat-release\nCentOS Linux release 7.6.1810 (Core)\n```\n\n选择对应的版本进行下载，例如CentOS 7当前在官网查看最新Yum源的下载地址为： [dev.mysql.com/get/mysql80…](https://dev.mysql.com/get/mysql80-community-release-el7-3.noarch.rpm)\n\n```\nshell> wget https://dev.mysql.com/get/mysql80-community-release-el7-3.noarch.rpm\n```\n\n##### 安装MySQL源\n例如CentOS7当前最新MySQL源安装：\n```\nshell> sudo rpm -Uvh mysql80-community-release-el7-3.noarch.rpm\n\n```\n\n##### 检查是否安装成功\n\n执行成功后会在`/etc/yum.repos.d/`目录下生成两个repo文件`mysql-community.repo`及 `mysql-community-source.repo`\n\n并且通过`yum repolist`可以看到mysql相关资源\n\n```\nshell> yum repolist enabled | grep \"mysql.*-community.*\"\n!mysql-connectors-community/x86_64 MySQL Connectors Community                108\n!mysql-tools-community/x86_64      MySQL Tools Community                      90\n!mysql80-community/x86_64          MySQL 8.0 Community Server                113\n```\n\n### 2、选择MySQL版本\n\n使用MySQL Yum Repository安装MySQL，默认会选择当前最新的稳定版本，例如通过上面的MySQL源进行安装的话，默安装会选择MySQL 8.0版本，**如果就是想要安装该版本，可以直接跳过此步骤**，如果不是，比如我这里希望安装MySQL5.7版本，就需要“切换一下版本”：\n\n##### 查看当前MySQL Yum Repository中所有MySQL版本（每个版本在不同的子仓库中）\n\n```\nshell> yum repolist all | grep mysql\n```\n\n##### 切换版本\n```\nshell> sudo yum-config-manager --disable mysql80-community\nshell> sudo yum-config-manager --enable mysql57-community\n```\n\n除了使用yum-config-manager之外，还可以直接编辑`/etc/yum.repos.d/mysql-community.repo`文件\n\nenabled=0禁用\n```\n[mysql80-community]\nname=MySQL 8.0 Community Server\nbaseurl=http://repo.mysql.com/yum/mysql-8.0-community/el/7/$basearch/\nenabled=0\ngpgcheck=1\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-mysql\n```\n\nenabled=1启用\n```\n# Enable to use MySQL 5.7\n[mysql57-community]\nname=MySQL 5.7 Community Server\nbaseurl=http://repo.mysql.com/yum/mysql-5.7-community/el/7/$basearch/\nenabled=1\ngpgcheck=1\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-mysql\n```\n\n##### 检查当前启用的MySQL仓库\n```\nshell> yum repolist enabled | grep mysql\n```\n\n如果同时启用了多个仓库，安装时会选择最新版本_\n\n### 3、安装MySQL\n```\nshell> sudo yum install mysql-community-server\n```\n\n该命令会安装MySQL服务器 (mysql-community-server) 及其所需的依赖、相关组件，包括mysql-community-client、mysql-community-common、mysql-community-libs等\n\n如果带宽不够，这个步骤时间会比较长，请耐心等待~\n\n### 4、启动MySQL\n\n##### 启动\n```\nshell> sudo systemctl start mysqld.service\n```\n\nCentOS 6：\n```\nshell> sudo service mysqld start\n复制代码\n```\n\n##### 查看状态\n\n```\nshell> sudo systemctl status mysqld.service\n复制代码\n```\n\nCentOS 6：\n\n```\nshell> sudo service mysqld status\n复制代码\n```\n\n##### 停止\n\n```\nshell> sudo systemctl stop mysqld.service\n复制代码\n```\n\nCentOS 6：\n\n```\nshell> sudo service mysqld stop\n复制代码\n```\n\n##### 重启\n\n```\nshell> sudo systemctl restart mysqld.service\n复制代码\n```\n\nCentOS 6：\n\n```\nshell> sudo service mysqld restart\n复制代码\n```\n\n### 5、修改密码\n\n##### 初始密码\n\nMySQL第一次启动后会创建超级管理员账号`root@localhost`，初始密码存储在日志文件中：\n\n```\nshell> sudo grep 'temporary password' /var/log/mysqld.log\n```\n\n##### 修改默认密码\n\n```\nshell> mysql -uroot -p\n```\n\n```\nmysql> ALTER USER 'root'@'localhost' IDENTIFIED BY '123456';\nERROR 1819 (HY000): Your password does not satisfy the current policy requirements\n```\n\n\n出现上面的提示是因为密码太简单了，解决方法如下：\n**修改 my.cnf 前要设置权限，设置时候将权限返回回去**\n1.  使用复杂密码，MySQL默认的密码策略是要包含数字、字母及特殊字符；\n2.  如果只是测试用，不想用那么复杂的密码，可以修改默认策略，即`validate_password_policy`（以及`validate_password_length`等相关参数），使其支持简单密码的设定，具体方法可以自行百度；\n**具体方法**：\n想设置符合的密码，然后设置上面两个策略\n\n```\nmysql>ALTER USER 'root'@'localhost' IDENTIFIED BY 'Root_12root';\nmysql>set global validate_password.policy=0;\nmysql>set global validate_password.length=1;\nmysql>ALTER USER 'root'@'localhost' IDENTIFIED BY '123456';\n```\n\n\n### 6、允许root远程访问\n\n```\nmysql> create user 'GJXAIOU'@'%'identified by 'gjx';\nmysql> grant all privileges on *.* to 'GJXAIOU'@'%' with grant option;\nmysql> FLUSH PRIVILEGES;\n\n```\n\n\n\n\n### 7、设置编码为utf8\n\n##### 查看编码\n\n```\nmysql> SHOW VARIABLES LIKE 'character%';\n```\n\n##### 设置编码\n\n编辑/etc/my.cnf，[mysqld]节点增加以下代码：\n\n```\n[mysqld]\ncharacter_set_server=utf8\ninit-connect='SET NAMES utf8'\n```\n\n### 8、设置开机启动\n\n```\nshell> systemctl enable mysqld\nshell> systemctl daemon-reload\n复制代码\n```\n\n## 二、RPM\n\n> 除安装过程外，其他步骤和yum方式安装相同，不再赘述\n\n### 0、删除已旧版本\n\n略\n\n### 1、下载MySQL安装包\n\n下载地址：[dev.mysql.com/downloads/m…](https://dev.mysql.com/downloads/mysql/)\n\n选择对应的版本：\n\n![](https://user-gold-cdn.xitu.io/2019/6/18/16b66894c80e9b32?imageView2/0/w/1280/h/960/format/webp/ignore-error/1)\n\n```\nshell> wget https://dev.mysql.com/get/Downloads/MySQL-5.7/mysql-5.7.26-1.el7.x86_64.rpm-bundle.tar\n复制代码\n```\n\n### 2、安装MySQL\n\n##### 解压（解打包）\n\n```\nshell> tar -xvf mysql-5.7.26-1.el7.x86_64.rpm-bundle.tar\ntar -xvf mysql-5.7.26-1.el7.x86_64.rpm-bundle.tar\nmysql-community-embedded-devel-5.7.26-1.el7.x86_64.rpm\nmysql-community-libs-5.7.26-1.el7.x86_64.rpm\nmysql-community-embedded-5.7.26-1.el7.x86_64.rpm\nmysql-community-test-5.7.26-1.el7.x86_64.rpm\nmysql-community-embedded-compat-5.7.26-1.el7.x86_64.rpm\nmysql-community-common-5.7.26-1.el7.x86_64.rpm\nmysql-community-devel-5.7.26-1.el7.x86_64.rpm\nmysql-community-client-5.7.26-1.el7.x86_64.rpm\nmysql-community-server-5.7.26-1.el7.x86_64.rpm\n复制代码\n```\n\n我们主要安装的是这四个（如果有需要也可以一并安装其它的）：\n\n```\nmysql-community-libs-5.7.26-1.el7.x86_64.rpm\nmysql-community-common-5.7.26-1.el7.x86_64.rpm\nmysql-community-client-5.7.26-1.el7.x86_64.rpm\nmysql-community-server-5.7.26-1.el7.x86_64.rpm\n复制代码\n```\n\n如果不想下载rpm-bundle，官网也提供单独的rpm下载链接\n\n##### 安装\n\n各rpm包是有依赖关系的，所以需要按照一定顺序进行安装，安装期间如果提示缺少哪些依赖也要先安装相应的包：\n\n```\nshell> rpm -ivh mysql-community-common-5.7.26-1.el7.x86_64.rpm\nshell> rpm -ivh mysql-community-libs-5.7.26-1.el7.x86_64.rpm\nshell> rpm -ivh mysql-community-client-5.7.26-1.el7.x86_64.rpm\nshell> rpm -ivh mysql-community-server-5.7.26-1.el7.x86_64.rpm\n复制代码\n```\n\n还有一种简单的方式，可以自动处理各个包之间的依赖关系并自动下载缺少的依赖：\n\n```\nshell> yum install mysql-community-{server,client,common,libs}-*\n复制代码\n```\n\n_注意：上面的`yum install`命令需要在tar解压之后的各个rpm包所在目录内执行，否则就变成yum方式安装了，需要配置MySQL的yum源并且速度很慢，还要当前机器支持外网访问_\n\n### 3、设置\n\n略\n\n## 三、tar.gz\n\n### 0、删除旧版本\n\n略\n\n### 1、下载\n\n下载地址：[dev.mysql.com/downloads/m…](https://dev.mysql.com/downloads/mysql/)\n\n选择对应的版本：\n\n![](https://user-gold-cdn.xitu.io/2019/6/18/16b668a1b3c258aa?imageView2/0/w/1280/h/960/format/webp/ignore-error/1)\n\n```\nshell> wget https://dev.mysql.com/get/Downloads/MySQL-5.7/mysql-5.7.26-linux-glibc2.12-x86_64.tar.gz\n复制代码\n```\n\n### 2、安装&配置：\n\n##### 依赖\n\nMySQL依赖libaio库，如果没有先安装一下：\n\n```\nshell> yum install libaio\n复制代码\n```\n\n##### 创建mysql用户\n\n不需要登录的一个系统账号，启动MySQL服务时会使用该账号\n\n```\nshell> groupadd mysql\nshell> useradd -r -g mysql -s /bin/false mysql\n复制代码\n```\n\n##### 解压并创建链接\n\n```\nshell> cd /usr/local\nshell> tar zxvf /path/to/mysql-5.7.26-linux-glibc2.12-x86_64.tar.gz\nshell> ln -s mysql-5.7.26-linux-glibc2.12-x86_64/ mysql\n复制代码\n```\n\n##### 创建mysql-files目录\n\n这一步并不是必须的，可以设置secure_file_priv的值指向该目录（用于限制数据导入导出操作的目录）\n\n```\nshell> cd mysql\nshell> mkdir mysql-files\nshell> chown mysql:mysql mysql-files\nshell> chmod 750 mysql-files\n复制代码\n```\n\n##### 初始化\n\n```\nshell> bin/mysqld --initialize --user=mysql\n复制代码\n```\n\n如果初始化时报错如下：\n\n```\nerror while loading shared libraries: libnuma.so.1: cannot open shared object file: No such file or directory\n复制代码\n```\n\n是因为libnuma没有安装（或者默认安装的是32位），我们这里需要64位的：\n\n```\nshell> yum install numactl.x86_64\n复制代码\n```\n\n执行完后重新初始化即可 初始化成功后返回结果中有一行包含初始密码，第一次登录时要用到它：\n\n```\nA temporary password is generated for root@localhost: 8M0ary878s*U\n复制代码\n```\n\n##### 启用SSL（非必须）\n\n```\nshell> bin/mysql_ssl_rsa_setup\n复制代码\n```\n\n##### 启动\n\n```\nshell> bin/mysqld_safe --user=mysql &\n复制代码\n```\n\n查看进程可以看到一些默认参数，可以在配置文件中修改这些参数\n\n```\nshell> ps -ef | grep mysql\nroot     14604 12719  0 00:03 pts/0    00:00:00 /bin/sh bin/mysqld_safe --user=mysql\nmysql    14674 14604  0 00:03 pts/0    00:00:00 /usr/local/mysql/bin/mysqld --basedir=/usr/local/mysql --datadir=/usr/local/mysql/data --plugin-dir=/usr/local/mysql/lib/plugin --user=mysql --log-error=VM_2_24_centos.err --pid-file=VM_2_24_centos.pid\n复制代码\n```\n\n##### 设置环境变量\n\n避免每次执行mysql命令都要加上路径，在`/etc/profile`中添加：\n\n```\nexport PATH=$PATH:/usr/local/mysql/bin\n复制代码\n```\n\n##### 设置为服务\n\n```\nshell> cp support-files/mysql.server /etc/init.d/mysqld\nshell> service mysqld start|stop|restart|status\n复制代码\n```\n\n##### 开机启动\n\n```\nshell> chkconfig --add mysqld\nshell> chkconfig --list mysqld\nmysqld         \t0:关\t1:关\t2:开\t3:开\t4:开\t5:开\t6:关\n复制代码\n```\n\n_其他配置与yum、rpm相同，不再赘述_\n\n## 四、源码安装\n\n就别费这个劲了吧...\n\n## 结束语\n\n我们不是Linux运维专家，也不是MySQL专家，生在这个年代也不知算是幸福还是不幸，线上的环境已经越来越少有人（主要指平时写代码的人）手动去搞这些数据库、中间件的安装配置了，为什么呢？因为各种云产品实在是太方便了呀，一般的公司也不会差这几个钱，既方便又稳定，何乐而不为呢~但是我们自己搞一搞用于自己测试还是必要的，而且还有不少公司的开发环境、测试环境偶尔还是需要手动搞一下的，当然，还有那些个自己搞机房的巨头们。\n\n那我们既然不是专家，上面所写的内容如果有纰漏也是在所难免的，如果被看到了还希望能够及时批评指正~",[[1572945830043,["GJX@GJXAIOU",[[-1,3327,"##### 启动\n```\nshell> sudo systemctl start mysqld.service\n```"]],[3327,3386],[3327,3327]]],[1572945830580,["GJX@GJXAIOU",[[-1,3328,"\n"]],[3327,3327],[3326,3326]]],[1572945831106,["GJX@GJXAIOU",[[-1,3327,"\n"]],[3326,3326],[3325,3325]]],[1572945835010,["GJX@GJXAIOU",[[-1,3396,"```\nshell> sudo systemctl status mysqld.service\n复制代码\n```\n"]],[3395,3452],[3395,3395]]],[1572945835500,["GJX@GJXAIOU",[[-1,3396,"\n"]],[3395,3395],[3394,3394]]],[1572945838762,["GJX@GJXAIOU",[[-1,3445,"复制代码"]],[3445,3449],[3445,3445]]],[1572945841443,["GJX@GJXAIOU",[[-1,3461,"```\nshell> sudo systemctl stop mysqld.service\n复制代码\n```"]],[3461,3515],[3461,3461]]],[1572945841833,["GJX@GJXAIOU",[[-1,3462,"\n"]],[3461,3461],[3460,3460]]],[1572945842452,["GJX@GJXAIOU",[[-1,3461,"\n"]],[3460,3460],[3459,3459]]],[1572945844301,["GJX@GJXAIOU",[[-1,3406,"\n"]],[3406,3406],[3405,3405]]],[1572945845978,["GJX@GJXAIOU",[[-1,3374,"复制代码"]],[3374,3378],[3374,3374]]],[1572945846348,["GJX@GJXAIOU",[[-1,3374,"\n"]],[3374,3374],[3373,3373]]]],null,"GJX@GJXAIOU"],["c26aa9b0-9ec3-4c22-9f07-274056a805da",1573871394540,"# CentOS7 安装 MySQL详解\n\n## 引言\n\n\nLinux上安装软件常见的几种方式：\n\n*   源码编译\n*   压缩包解压（一般为tar.gz）\n*   编译好的安装包（RPM、DPKG等）\n*   在线安装（YUM、APT等）\n\n以上几种方式便捷性依次增加，但通用性依次下降，比如直接下载压缩包进行解压，这种方式一般需要自己做一些额外的配置工作，但只要掌握了方法，各个平台基本都适用，YUM虽然简单，但是平台受限，网络受限，必要的时候还需要增加一些特定YUM源。\n\n几种安装方式最好都能掌握，原则上能用简单的就用简单的：YUM>RPM>tar.gz>源码\n\n本文是介绍MySQL在CentOS上的安装，主要步骤都是参考了MySQL官方文档：[dev.mysql.com/doc/refman/…](https://dev.mysql.com/doc/refman/5.7/en/installing.html)\n\n\n## 一、YUM\n\n#### 0、删除已安装的MySQL\n\n##### 检查MariaDB\n\n```\nshell> rpm -qa|grep mariadb\nmariadb-server-5.5.60-1.el7_5.x86_64\nmariadb-5.5.60-1.el7_5.x86_64\nmariadb-libs-5.5.60-1.el7_5.x86_64\n```\n\n##### 删除mariadb\n\n如果不存在（上面检查结果返回空）则跳过步骤\n```\nshell> rpm -e --nodeps mariadb-server\nshell> rpm -e --nodeps mariadb\nshell> rpm -e --nodeps mariadb-libs\n```\n其实yum方式安装是可以不用删除mariadb的，安装MySQL会覆盖掉之前已存在的mariadb_\n\n##### 检查MySQL\n```\nshell> rpm -qa|grep mysql\n```\n\n##### 删除MySQL\n\n如果不存在（上面检查结果返回空）则跳过步骤\n```\nshell> rpm -e --nodeps xxx\n```\n\n### 1、添加MySQL Yum Repository\n\n 从CentOS 7开始，MariaDB成为Yum源中默认的数据库安装包。也就是说在CentOS 7及以上的系统中使用yum安装MySQL默认安装的会是MariaDB（MySQL的一个分支）。如果想安装官方MySQL版本，需要使用MySQL提供的Yum源。\n\n##### 下载MySQL源\n\n官网地址：[dev.mysql.com/downloads/r…](https://dev.mysql.com/downloads/repo/yum/)\n\n查看系统版本：\n\n```\nshell> cat /etc/redhat-release\nCentOS Linux release 7.6.1810 (Core)\n```\n\n选择对应的版本进行下载，例如CentOS 7当前在官网查看最新Yum源的下载地址为： [dev.mysql.com/get/mysql80…](https://dev.mysql.com/get/mysql80-community-release-el7-3.noarch.rpm)\n\n```\nshell> wget https://dev.mysql.com/get/mysql80-community-release-el7-3.noarch.rpm\n```\n\n##### 安装MySQL源\n例如CentOS7当前最新MySQL源安装：\n```\nshell> sudo rpm -Uvh mysql80-community-release-el7-3.noarch.rpm\n\n```\n\n##### 检查是否安装成功\n\n执行成功后会在`/etc/yum.repos.d/`目录下生成两个repo文件`mysql-community.repo`及 `mysql-community-source.repo`\n\n并且通过`yum repolist`可以看到mysql相关资源\n\n```\nshell> yum repolist enabled | grep \"mysql.*-community.*\"\n!mysql-connectors-community/x86_64 MySQL Connectors Community                108\n!mysql-tools-community/x86_64      MySQL Tools Community                      90\n!mysql80-community/x86_64          MySQL 8.0 Community Server                113\n```\n\n### 2、选择MySQL版本\n\n使用MySQL Yum Repository安装MySQL，默认会选择当前最新的稳定版本，例如通过上面的MySQL源进行安装的话，默安装会选择MySQL 8.0版本，**如果就是想要安装该版本，可以直接跳过此步骤**，如果不是，比如我这里希望安装MySQL5.7版本，就需要“切换一下版本”：\n\n##### 查看当前MySQL Yum Repository中所有MySQL版本（每个版本在不同的子仓库中）\n\n```\nshell> yum repolist all | grep mysql\n```\n\n##### 切换版本\n```\nshell> sudo yum-config-manager --disable mysql80-community\nshell> sudo yum-config-manager --enable mysql57-community\n```\n\n除了使用yum-config-manager之外，还可以直接编辑`/etc/yum.repos.d/mysql-community.repo`文件\n\nenabled=0禁用\n```\n[mysql80-community]\nname=MySQL 8.0 Community Server\nbaseurl=http://repo.mysql.com/yum/mysql-8.0-community/el/7/$basearch/\nenabled=0\ngpgcheck=1\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-mysql\n```\n\nenabled=1启用\n```\n# Enable to use MySQL 5.7\n[mysql57-community]\nname=MySQL 5.7 Community Server\nbaseurl=http://repo.mysql.com/yum/mysql-5.7-community/el/7/$basearch/\nenabled=1\ngpgcheck=1\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-mysql\n```\n\n##### 检查当前启用的MySQL仓库\n```\nshell> yum repolist enabled | grep mysql\n```\n\n如果同时启用了多个仓库，安装时会选择最新版本_\n\n### 3、安装MySQL\n```\nshell> sudo yum install mysql-community-server\n```\n\n该命令会安装MySQL服务器 (mysql-community-server) 及其所需的依赖、相关组件，包括mysql-community-client、mysql-community-common、mysql-community-libs等\n\n如果带宽不够，这个步骤时间会比较长，请耐心等待~\n\n### 4、启动MySQL\n\nCentOS 6：\n```\nshell> sudo service mysqld start\n```\n\n##### 查看状态\n\nCentOS 6：\n```\nshell> sudo service mysqld status\n\n```\n\n##### 停止\n\nCentOS 6：\n\n```\nshell> sudo service mysqld stop\n复制代码\n```\n\n##### 重启\n\n```\nshell> sudo systemctl restart mysqld.service\n复制代码\n```\n\nCentOS 6：\n\n```\nshell> sudo service mysqld restart\n复制代码\n```\n\n### 5、修改密码\n\n##### 初始密码\n\nMySQL第一次启动后会创建超级管理员账号`root@localhost`，初始密码存储在日志文件中：\n\n```\nshell> sudo grep 'temporary password' /var/log/mysqld.log\n```\n\n##### 修改默认密码\n\n```\nshell> mysql -uroot -p\n```\n\n```\nmysql> ALTER USER 'root'@'localhost' IDENTIFIED BY '123456';\nERROR 1819 (HY000): Your password does not satisfy the current policy requirements\n```\n\n\n出现上面的提示是因为密码太简单了，解决方法如下：\n**修改 my.cnf 前要设置权限，设置时候将权限返回回去**\n1.  使用复杂密码，MySQL默认的密码策略是要包含数字、字母及特殊字符；\n2.  如果只是测试用，不想用那么复杂的密码，可以修改默认策略，即`validate_password_policy`（以及`validate_password_length`等相关参数），使其支持简单密码的设定，具体方法可以自行百度；\n**具体方法**：\n想设置符合的密码，然后设置上面两个策略\n\n```\nmysql>ALTER USER 'root'@'localhost' IDENTIFIED BY 'Root_12root';\nmysql>set global validate_password.policy=0;\nmysql>set global validate_password.length=1;\nmysql>ALTER USER 'root'@'localhost' IDENTIFIED BY '123456';\n```\n\n\n### 6、允许root远程访问\n\n```\nmysql> create user 'GJXAIOU'@'%'identified by 'gjx';\nmysql> grant all privileges on *.* to 'GJXAIOU'@'%' with grant option;\nmysql> FLUSH PRIVILEGES;\n\n```\n\n\n\n\n### 7、设置编码为utf8\n\n##### 查看编码\n\n```\nmysql> SHOW VARIABLES LIKE 'character%';\n```\n\n##### 设置编码\n\n编辑/etc/my.cnf，[mysqld]节点增加以下代码：\n\n```\n[mysqld]\ncharacter_set_server=utf8\ninit-connect='SET NAMES utf8'\n```\n\n### 8、设置开机启动\n\n```\nshell> systemctl enable mysqld\nshell> systemctl daemon-reload\n复制代码\n```\n\n## 二、RPM\n\n> 除安装过程外，其他步骤和yum方式安装相同，不再赘述\n\n### 0、删除已旧版本\n\n略\n\n### 1、下载MySQL安装包\n\n下载地址：[dev.mysql.com/downloads/m…](https://dev.mysql.com/downloads/mysql/)\n\n选择对应的版本：\n\n![](https://user-gold-cdn.xitu.io/2019/6/18/16b66894c80e9b32?imageView2/0/w/1280/h/960/format/webp/ignore-error/1)\n\n```\nshell> wget https://dev.mysql.com/get/Downloads/MySQL-5.7/mysql-5.7.26-1.el7.x86_64.rpm-bundle.tar\n复制代码\n```\n\n### 2、安装MySQL\n\n##### 解压（解打包）\n\n```\nshell> tar -xvf mysql-5.7.26-1.el7.x86_64.rpm-bundle.tar\ntar -xvf mysql-5.7.26-1.el7.x86_64.rpm-bundle.tar\nmysql-community-embedded-devel-5.7.26-1.el7.x86_64.rpm\nmysql-community-libs-5.7.26-1.el7.x86_64.rpm\nmysql-community-embedded-5.7.26-1.el7.x86_64.rpm\nmysql-community-test-5.7.26-1.el7.x86_64.rpm\nmysql-community-embedded-compat-5.7.26-1.el7.x86_64.rpm\nmysql-community-common-5.7.26-1.el7.x86_64.rpm\nmysql-community-devel-5.7.26-1.el7.x86_64.rpm\nmysql-community-client-5.7.26-1.el7.x86_64.rpm\nmysql-community-server-5.7.26-1.el7.x86_64.rpm\n复制代码\n```\n\n我们主要安装的是这四个（如果有需要也可以一并安装其它的）：\n\n```\nmysql-community-libs-5.7.26-1.el7.x86_64.rpm\nmysql-community-common-5.7.26-1.el7.x86_64.rpm\nmysql-community-client-5.7.26-1.el7.x86_64.rpm\nmysql-community-server-5.7.26-1.el7.x86_64.rpm\n复制代码\n```\n\n如果不想下载rpm-bundle，官网也提供单独的rpm下载链接\n\n##### 安装\n\n各rpm包是有依赖关系的，所以需要按照一定顺序进行安装，安装期间如果提示缺少哪些依赖也要先安装相应的包：\n\n```\nshell> rpm -ivh mysql-community-common-5.7.26-1.el7.x86_64.rpm\nshell> rpm -ivh mysql-community-libs-5.7.26-1.el7.x86_64.rpm\nshell> rpm -ivh mysql-community-client-5.7.26-1.el7.x86_64.rpm\nshell> rpm -ivh mysql-community-server-5.7.26-1.el7.x86_64.rpm\n复制代码\n```\n\n还有一种简单的方式，可以自动处理各个包之间的依赖关系并自动下载缺少的依赖：\n\n```\nshell> yum install mysql-community-{server,client,common,libs}-*\n复制代码\n```\n\n_注意：上面的`yum install`命令需要在tar解压之后的各个rpm包所在目录内执行，否则就变成yum方式安装了，需要配置MySQL的yum源并且速度很慢，还要当前机器支持外网访问_\n\n### 3、设置\n\n略\n\n## 三、tar.gz\n\n### 0、删除旧版本\n\n略\n\n### 1、下载\n\n下载地址：[dev.mysql.com/downloads/m…](https://dev.mysql.com/downloads/mysql/)\n\n选择对应的版本：\n\n![](https://user-gold-cdn.xitu.io/2019/6/18/16b668a1b3c258aa?imageView2/0/w/1280/h/960/format/webp/ignore-error/1)\n\n```\nshell> wget https://dev.mysql.com/get/Downloads/MySQL-5.7/mysql-5.7.26-linux-glibc2.12-x86_64.tar.gz\n复制代码\n```\n\n### 2、安装&配置：\n\n##### 依赖\n\nMySQL依赖libaio库，如果没有先安装一下：\n\n```\nshell> yum install libaio\n复制代码\n```\n\n##### 创建mysql用户\n\n不需要登录的一个系统账号，启动MySQL服务时会使用该账号\n\n```\nshell> groupadd mysql\nshell> useradd -r -g mysql -s /bin/false mysql\n复制代码\n```\n\n##### 解压并创建链接\n\n```\nshell> cd /usr/local\nshell> tar zxvf /path/to/mysql-5.7.26-linux-glibc2.12-x86_64.tar.gz\nshell> ln -s mysql-5.7.26-linux-glibc2.12-x86_64/ mysql\n复制代码\n```\n\n##### 创建mysql-files目录\n\n这一步并不是必须的，可以设置secure_file_priv的值指向该目录（用于限制数据导入导出操作的目录）\n\n```\nshell> cd mysql\nshell> mkdir mysql-files\nshell> chown mysql:mysql mysql-files\nshell> chmod 750 mysql-files\n复制代码\n```\n\n##### 初始化\n\n```\nshell> bin/mysqld --initialize --user=mysql\n复制代码\n```\n\n如果初始化时报错如下：\n\n```\nerror while loading shared libraries: libnuma.so.1: cannot open shared object file: No such file or directory\n复制代码\n```\n\n是因为libnuma没有安装（或者默认安装的是32位），我们这里需要64位的：\n\n```\nshell> yum install numactl.x86_64\n复制代码\n```\n\n执行完后重新初始化即可 初始化成功后返回结果中有一行包含初始密码，第一次登录时要用到它：\n\n```\nA temporary password is generated for root@localhost: 8M0ary878s*U\n复制代码\n```\n\n##### 启用SSL（非必须）\n\n```\nshell> bin/mysql_ssl_rsa_setup\n复制代码\n```\n\n##### 启动\n\n```\nshell> bin/mysqld_safe --user=mysql &\n复制代码\n```\n\n查看进程可以看到一些默认参数，可以在配置文件中修改这些参数\n\n```\nshell> ps -ef | grep mysql\nroot     14604 12719  0 00:03 pts/0    00:00:00 /bin/sh bin/mysqld_safe --user=mysql\nmysql    14674 14604  0 00:03 pts/0    00:00:00 /usr/local/mysql/bin/mysqld --basedir=/usr/local/mysql --datadir=/usr/local/mysql/data --plugin-dir=/usr/local/mysql/lib/plugin --user=mysql --log-error=VM_2_24_centos.err --pid-file=VM_2_24_centos.pid\n复制代码\n```\n\n##### 设置环境变量\n\n避免每次执行mysql命令都要加上路径，在`/etc/profile`中添加：\n\n```\nexport PATH=$PATH:/usr/local/mysql/bin\n复制代码\n```\n\n##### 设置为服务\n\n```\nshell> cp support-files/mysql.server /etc/init.d/mysqld\nshell> service mysqld start|stop|restart|status\n复制代码\n```\n\n##### 开机启动\n\n```\nshell> chkconfig --add mysqld\nshell> chkconfig --list mysqld\nmysqld         \t0:关\t1:关\t2:开\t3:开\t4:开\t5:开\t6:关\n复制代码\n```\n\n_其他配置与yum、rpm相同，不再赘述_\n\n## 四、源码安装\n\n就别费这个劲了吧...\n\n## 结束语\n\n我们不是Linux运维专家，也不是MySQL专家，生在这个年代也不知算是幸福还是不幸，线上的环境已经越来越少有人（主要指平时写代码的人）手动去搞这些数据库、中间件的安装配置了，为什么呢？因为各种云产品实在是太方便了呀，一般的公司也不会差这几个钱，既方便又稳定，何乐而不为呢~但是我们自己搞一搞用于自己测试还是必要的，而且还有不少公司的开发环境、测试环境偶尔还是需要手动搞一下的，当然，还有那些个自己搞机房的巨头们。\n\n那我们既然不是专家，上面所写的内容如果有纰漏也是在所难免的，如果被看到了还希望能够及时批评指正~",[[1573871385923,["GJX@GJXAIOUPC",[[1,1435,"[https://"],[1,1495,"](https://dev.mysql.com/get/mysql80-community-release-el7-3.noarch.rpm)"]],[1435,1495],[1575,1575]]],[1573871390694,["GJX@GJXAIOUPC",[[-1,1435,"[https://"],[-1,1504,"](https://dev.mysql.com/get/mysql80-community-release-el7-3.noarch.rpm)"]],[1575,1575],[1435,1495]]],[1573871393532,["GJX@GJXAIOUPC",[[1,1435,"https://"]],[1435,1495],[1503,1503]]],[1573871400417,["GJX@GJXAIOUPC",[[-1,1427,"https://"]],[1427,1434],[1427,1427]]],[1573892917352,["GJX@GJXAIOUPC",[[-1,18,"详解"]],[18,20],[18,18]]]],null,"GJX@GJXAIOUPC"]]}