<svg id="SvgjsSvg1232" width="1411.1701965332031" height="1006.7604675292969" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs"><defs id="SvgjsDefs1233"><marker id="SvgjsMarker1266" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1267" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1274" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1275" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1282" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1283" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1286" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1287" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1322" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1323" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1330" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1331" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1334" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1335" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1350" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1351" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1354" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1355" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1378" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1379" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1382" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1383" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1400" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1401" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1408" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1409" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1412" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1413" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1442" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1443" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1456" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1457" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker></defs><g id="SvgjsG1234" transform="translate(646.4722290039062,25.001342837304414)"><path id="SvgjsPath1235" d="M 0 0L 206 0L 206 58L 0 58Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1236"><text id="SvgjsText1237" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="186px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="19.375" transform="rotate(0)"><tspan id="SvgjsTspan1238" dy="16" x="103"><tspan id="SvgjsTspan1239" style="text-decoration:;">ReentrantLock.lock()</tspan></tspan></text></g></g><g id="SvgjsG1240" transform="translate(699.4722290039062,127.28416609563743)"><path id="SvgjsPath1241" d="M 0 0L 100 0L 100 40.5300812138006L 0 40.5300812138006Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1242"><text id="SvgjsText1243" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="80px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="10.6400406069003" transform="rotate(0)"><tspan id="SvgjsTspan1244" dy="16" x="50"><tspan id="SvgjsTspan1245" style="text-decoration:;">sync#lock()</tspan></tspan></text></g></g><g id="SvgjsG1246" transform="translate(676.4722290039062,203.09435935425586)"><path id="SvgjsPath1247" d="M 0 42L 73 0L 146 42L 73 84Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1248"><text id="SvgjsText1249" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="126px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="32.795" transform="rotate(0)"><tspan id="SvgjsTspan1250" dy="16" x="73"><tspan id="SvgjsTspan1251" style="text-decoration:;">abstract void lock()</tspan></tspan></text></g></g><g id="SvgjsG1252" transform="translate(498.97222900390625,335.0943593542558)"><path id="SvgjsPath1253" d="M 0 0L 135 0L 135 67L 0 67Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1254"><text id="SvgjsText1255" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="115px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="23.875" transform="rotate(0)"><tspan id="SvgjsTspan1256" dy="16" x="67.5"><tspan id="SvgjsTspan1257" style="text-decoration:;">FairSync#lock()</tspan></tspan></text></g></g><g id="SvgjsG1258" transform="translate(804.4722290039062,347.0943593542558)"><path id="SvgjsPath1259" d="M 0 0L 146 0L 146 67L 0 67Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1260"><text id="SvgjsText1261" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="126px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="23.875" transform="rotate(0)"><tspan id="SvgjsTspan1262" dy="16" x="73"><tspan id="SvgjsTspan1263" style="text-decoration:;">NonFairSync#lock()</tspan></tspan></text></g></g><g id="SvgjsG1264"><path id="SvgjsPath1265" d="M676.4722290039062 245.09435935425574L566.4722290039059 245.09435935425574L566.4722290039059 335.0943593542558" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1266)"></path><rect id="SvgjsRect1268" width="39" height="16" x="556.972229003906" y="237.09435935425574" fill="#ffffff"></rect><text id="SvgjsText1269" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="39px" fill="#323232" font-weight="400" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="235.46935935425574" transform="rotate(0)"><tspan id="SvgjsTspan1270" dy="16" x="576.472229003906"><tspan id="SvgjsTspan1271" style="text-decoration:;">公平锁</tspan></tspan></text></g><g id="SvgjsG1272"><path id="SvgjsPath1273" d="M822.4722290039062 245.09435935425574L877.4722290039062 245.09435935425574L877.4722290039062 347.0943593542558" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1274)"></path><rect id="SvgjsRect1276" width="52" height="16" x="851.4722290039062" y="260.59435935425574" fill="#ffffff"></rect><text id="SvgjsText1277" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="52px" fill="#323232" font-weight="400" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="258.96935935425574" transform="rotate(0)"><tspan id="SvgjsTspan1278" dy="16" x="877.4722290039062"><tspan id="SvgjsTspan1279" style="text-decoration:;">非公平锁</tspan></tspan></text></g><g id="SvgjsG1280"><path id="SvgjsPath1281" d="M749.4722290039062 83.0013428373044L749.4722290039062 104.1427544664709L749.4722290039062 104.1427544664709L749.4722290039062 127.28416609563743" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1282)"></path></g><g id="SvgjsG1284"><path id="SvgjsPath1285" d="M756.4142913801552 167.81424730943803L756.4142913801552 185.45430333184697L756.4142913801552 185.45430333184697L756.4142913801552 203.09435935425586" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1286)"></path></g><g id="SvgjsG1288" transform="translate(267.214919062386,332.10020730747175)"><path id="SvgjsPath1289" d="M 0 0L 119 0L 135 16L 135 67L 0 67L 0 0Z" stroke="none" fill-opacity="1" fill="#ccff99"></path><path id="SvgjsPath1290" d="M 119 0L 119 16L 135 16Z" stroke="none" fill-opacity="1" fill="#cdcdcd"></path><path id="SvgjsPath1291" d="M 0 0L 119 0L 135 16L 135 67L 0 67L 0 0Z" stroke="none" fill="none"></path><g id="SvgjsG1292"><text id="SvgjsText1293" font-family="微软雅黑" text-anchor="start" font-size="13px" width="115px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="8.375" transform="rotate(0)"><tspan id="SvgjsTspan1294" dy="16" x="10"><tspan id="SvgjsTspan1295" style="text-decoration:;">final void lock() {</tspan></tspan><tspan id="SvgjsTspan1296" dy="16" x="10"><tspan id="SvgjsTspan1297" style="text-decoration:;">   acquire(1);</tspan></tspan><tspan id="SvgjsTspan1298" dy="16" x="10"><tspan id="SvgjsTspan1299" style="text-decoration:;">  }</tspan></tspan></text></g></g><g id="SvgjsG1300" transform="translate(498.97222900390625,459.5388037987008)"><path id="SvgjsPath1301" d="M 0 0L 135 0L 135 67L 0 67Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1302"><text id="SvgjsText1303" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="115px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="23.875" transform="rotate(0)"><tspan id="SvgjsTspan1304" dy="16" x="67.5"><tspan id="SvgjsTspan1305" style="text-decoration:;">AQS#acquire(1)</tspan></tspan></text></g></g><g id="SvgjsG1306" transform="translate(498.97222900390625,569.205470465368)"><path id="SvgjsPath1307" d="M 0 33.5L 67.5 0L 135 33.5L 67.5 67L 0 33.5Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1308"><text id="SvgjsText1309" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="115px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="16.375" transform="rotate(0)"><tspan id="SvgjsTspan1310" dy="16" x="67.5"><tspan id="SvgjsTspan1311" style="text-decoration:;">FairSync#tryAcqui</tspan></tspan><tspan id="SvgjsTspan1312" dy="16" x="67.5"><tspan id="SvgjsTspan1313" style="text-decoration:;">re()</tspan></tspan></text></g></g><g id="SvgjsG1314" transform="translate(333.23413376581107,683.8562007729529)"><path id="SvgjsPath1315" d="M 0 0L 165 0L 165 51.940369450188086L 0 51.940369450188086Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1316"><text id="SvgjsText1317" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="145px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="16.345184725094043" transform="rotate(0)"><tspan id="SvgjsTspan1318" dy="16" x="82.5"><tspan id="SvgjsTspan1319" style="text-decoration:;">获取到锁，加锁过程完成</tspan></tspan></text></g></g><g id="SvgjsG1320"><path id="SvgjsPath1321" d="M498.4722290039059 605.6499149098123L415.7341337658112 605.6499149098123L415.7341337658112 683.8562007729529" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1322)"></path><rect id="SvgjsRect1324" width="26" height="16" x="405.00003845328825" y="597.6499149098123" fill="#ffffff"></rect><text id="SvgjsText1325" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="26px" fill="#323232" font-weight="400" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="596.0249149098123" transform="rotate(0)"><tspan id="SvgjsTspan1326" dy="16" x="418.00003845328825"><tspan id="SvgjsTspan1327" style="text-decoration:;">true</tspan></tspan></text></g><g id="SvgjsG1328"><path id="SvgjsPath1329" d="M566.4722290039061 402.0943593542558L566.4722290039061 430.31658157647803L566.4722290039061 430.31658157647803L566.4722290039061 459.5388037987008" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1330)"></path></g><g id="SvgjsG1332"><path id="SvgjsPath1333" d="M566.4722290039061 526.5388037987009L566.4722290039061 547.3721371320345L566.4722290039061 547.3721371320345L566.4722290039061 569.205470465368" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1334)"></path></g><g id="SvgjsG1336" transform="translate(642.5833401150168,680.8263854980469)"><path id="SvgjsPath1337" d="M 0 0L 135 0L 135 58L 0 58Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1338"><text id="SvgjsText1339" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="115px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="19.375" transform="rotate(0)"><tspan id="SvgjsTspan1340" dy="16" x="67.5"><tspan id="SvgjsTspan1341" style="text-decoration:;">AQS#addWaiter()</tspan></tspan></text></g></g><g id="SvgjsG1342" transform="translate(626.0697719405649,788.0224639294202)"><path id="SvgjsPath1343" d="M 0 0L 165 0L 165 58L 0 58Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1344"><text id="SvgjsText1345" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="145px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="19.375" transform="rotate(0)"><tspan id="SvgjsTspan1346" dy="16" x="82.5"><tspan id="SvgjsTspan1347" style="text-decoration:;">AQS#acquireQuened()</tspan></tspan></text></g></g><g id="SvgjsG1348"><path id="SvgjsPath1349" d="M710.0833401150169 738.8263854980469L710.0833401150169 763.4244247137335L708.5697719405649 763.4244247137335L708.5697719405649 788.0224639294202" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1350)"></path></g><g id="SvgjsG1352"><path id="SvgjsPath1353" d="M633.9722290039062 602.7054704653681L710.0833401150169 602.7054704653681L710.0833401150169 680.8263854980469" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1354)"></path></g><g id="SvgjsG1356" transform="translate(25.01454089936759,426.2347100623764)"><path id="SvgjsPath1357" d="M 0 0L 415.03663547295974 0L 431.03663547295974 16L 431.03663547295974 148.13943057288157L 0 148.13943057288157L 0 0Z" stroke="none" fill-opacity="1" fill="#ffffaa"></path><path id="SvgjsPath1358" d="M 415.03663547295974 0L 415.03663547295974 16L 431.03663547295974 16Z" stroke="none" fill-opacity="1" fill="#cdcdcd"></path><path id="SvgjsPath1359" d="M 0 0L 415.03663547295974 0L 431.03663547295974 16L 431.03663547295974 148.13943057288157L 0 148.13943057288157L 0 0Z" stroke="none" fill="none"></path><g id="SvgjsG1360"><text id="SvgjsText1361" font-family="微软雅黑" text-anchor="start" font-size="13px" width="412px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="17.944715286440783" transform="rotate(0)"><tspan id="SvgjsTspan1362" dy="16" x="10"><tspan id="SvgjsTspan1363" style="text-decoration:;">// 首先尝试通过 FairSync 的 tryAcquire() 获取锁，如果返回 false 即</tspan></tspan><tspan id="SvgjsTspan1364" dy="16" x="10"><tspan id="SvgjsTspan1365" style="text-decoration:;">没有获取锁，则通过 acquireQueued 来放入后面的阻塞队列（排队）</tspan></tspan><tspan id="SvgjsTspan1366" dy="16" x="10"><tspan id="SvgjsTspan1367" style="text-decoration:;">public final void acquire(int arg) {</tspan></tspan><tspan id="SvgjsTspan1368" dy="16" x="10"><tspan id="SvgjsTspan1369" style="text-decoration:;">    if (!tryAcquire(arg) &amp;&amp; </tspan></tspan><tspan id="SvgjsTspan1370" dy="16" x="10"><tspan id="SvgjsTspan1371" style="text-decoration:;">acquireQueued(addWaiter(Node.EXCLUSIVE), arg))</tspan></tspan><tspan id="SvgjsTspan1372" dy="16" x="10"><tspan id="SvgjsTspan1373" style="text-decoration:;">        selfInterrupt();</tspan></tspan><tspan id="SvgjsTspan1374" dy="16" x="10"><tspan id="SvgjsTspan1375" style="text-decoration:;">}</tspan></tspan></text></g></g><g id="SvgjsG1376"><path id="SvgjsPath1377" d="M498.97222900390625 365.60020730747175L447.343574033146 365.60020730747175L447.343574033146 365.60020730747175L402.214919062386 365.60020730747175" stroke-dasharray="3,3" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1378)"></path></g><g id="SvgjsG1380"><path id="SvgjsPath1381" d="M498.4722290039059 500.3044253488181L477.26170268811666 500.3044253488181L477.26170268811666 500.3044253488181L456.05117637232735 500.3044253488181" stroke-dasharray="3,3" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1382)"></path></g><g id="SvgjsG1384" transform="translate(807.6875152587891,460.4833718894647)"><path id="SvgjsPath1385" d="M 0 32.555431909236205L 69.78471374511719 0L 139.56942749023438 32.555431909236205L 69.78471374511719 65.11086381847241L 0 32.555431909236205Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1386"><text id="SvgjsText1387" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="120px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="22.930431909236205" transform="rotate(0)"><tspan id="SvgjsTspan1388" dy="16" x="70"><tspan id="SvgjsTspan1389" style="text-decoration:;">CAS 获取锁</tspan></tspan></text></g></g><g id="SvgjsG1390" transform="translate(834.4513654828515,588.8573484627461)"><path id="SvgjsPath1391" d="M 0 0L 173.51430762721293 0L 173.51430762721293 67L 0 67Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1392"><text id="SvgjsText1393" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="154px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="16.375" transform="rotate(0)"><tspan id="SvgjsTspan1394" dy="16" x="87"><tspan id="SvgjsTspan1395" style="text-decoration:;">获取到锁，设置当前线程</tspan></tspan><tspan id="SvgjsTspan1396" dy="16" x="87"><tspan id="SvgjsTspan1397" style="text-decoration:;">持有该锁，返回。</tspan></tspan></text></g></g><g id="SvgjsG1398"><path id="SvgjsPath1399" d="M807.6875152587891 493.03880379870134L720.0798721313474 493.03880379870134L720.0798721313474 493.5388037987011L632.4722290039058 493.5388037987011" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1400)"></path><rect id="SvgjsRect1402" width="29" height="16" x="705.5798721313474" y="485.2888037987012" fill="#ffffff"></rect><text id="SvgjsText1403" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="29px" fill="#323232" font-weight="400" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="483.6638037987012" transform="rotate(0)"><tspan id="SvgjsTspan1404" dy="16" x="720.0798721313474"><tspan id="SvgjsTspan1405" style="text-decoration:;">false</tspan></tspan></text></g><g id="SvgjsG1406"><path id="SvgjsPath1407" d="M877.4722290039062 416.5884732635311L877.4722290039062 438.5359225764979L877.4722290039062 438.5359225764979L877.4722290039062 460.4833718894647" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1408)"></path></g><g id="SvgjsG1410"><path id="SvgjsPath1411" d="M880.4921423254584 525.5942357079371L880.4921423254584 544.3852348097998L879.4195910002053 544.3852348097998L879.4195910002053 563.1762339116627" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1412)"></path><rect id="SvgjsRect1414" width="26" height="16" x="866.9558666628318" y="536.3852348097998" fill="#ffffff"></rect><text id="SvgjsText1415" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="26px" fill="#323232" font-weight="400" align="top" lineHeight="16px" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="534.7602348097998" transform="rotate(0)"><tspan id="SvgjsTspan1416" dy="16" x="879.9558666628318"><tspan id="SvgjsTspan1417" style="text-decoration:;">true</tspan></tspan></text></g><g id="SvgjsG1418" transform="translate(987.1807120691313,300.4734443215759)"><path id="SvgjsPath1419" d="M 0 0L 382.976685973093 0L 398.976685973093 16L 398.976685973093 154.67647058823542L 0 154.67647058823542L 0 0Z" stroke="none" fill-opacity="1" fill="#ffffaa"></path><path id="SvgjsPath1420" d="M 382.976685973093 0L 382.976685973093 16L 398.976685973093 16Z" stroke="none" fill-opacity="1" fill="#cdcdcd"></path><path id="SvgjsPath1421" d="M 0 0L 382.976685973093 0L 398.976685973093 16L 398.976685973093 154.67647058823542L 0 154.67647058823542L 0 0Z" stroke="none" fill="none"></path><g id="SvgjsG1422"><text id="SvgjsText1423" font-family="微软雅黑" text-anchor="start" font-size="13px" width="379px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="13.713235294117709" transform="rotate(0)"><tspan id="SvgjsTspan1424" dy="16" x="10"><tspan id="SvgjsTspan1425" style="text-decoration:;">final void lock() {</tspan></tspan><tspan id="SvgjsTspan1426" dy="16" x="10"><tspan id="SvgjsTspan1427" style="text-decoration:;">      // CAS 尝试将 0 换成 1 然后设置排它锁</tspan></tspan><tspan id="SvgjsTspan1428" dy="16" x="10"><tspan id="SvgjsTspan1429" style="text-decoration:;">       if (compareAndSetState(0, 1)){</tspan></tspan><tspan id="SvgjsTspan1430" dy="16" x="10"><tspan id="SvgjsTspan1431" style="text-decoration:;">              setExclusiveOwnerThread(Thread.currentThread());</tspan></tspan><tspan id="SvgjsTspan1432" dy="16" x="10"><tspan id="SvgjsTspan1433" style="text-decoration:;">       }else{</tspan></tspan><tspan id="SvgjsTspan1434" dy="16" x="10"><tspan id="SvgjsTspan1435" style="text-decoration:;">              acquire(1);</tspan></tspan><tspan id="SvgjsTspan1436" dy="16" x="10"><tspan id="SvgjsTspan1437" style="text-decoration:;">      }</tspan></tspan><tspan id="SvgjsTspan1438" dy="16" x="10"><tspan id="SvgjsTspan1439" style="text-decoration:;">  }</tspan></tspan></text></g></g><g id="SvgjsG1440"><path id="SvgjsPath1441" d="M950.4722290039062 377.81167961569366L968.3664843058048 377.81167961569366L968.3664843058048 377.81167961569366L987.1807120691313 377.81167961569366" stroke-dasharray="3,3" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1442)"></path></g><g id="SvgjsG1444" transform="translate(630.0403601758591,897.7675835104556)"><path id="SvgjsPath1445" d="M 0 0L 157.0588235294117 0L 157.0588235294117 84L 0 84Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1446"><text id="SvgjsText1447" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="138px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="16.875" transform="rotate(0)"><tspan id="SvgjsTspan1448" dy="16" x="79"><tspan id="SvgjsTspan1449" style="text-decoration:;">acquireQueued() 返</tspan></tspan><tspan id="SvgjsTspan1450" dy="16" x="79"><tspan id="SvgjsTspan1451" style="text-decoration:;">回，表示线程获取到</tspan></tspan><tspan id="SvgjsTspan1452" dy="16" x="79"><tspan id="SvgjsTspan1453" style="text-decoration:;">锁，加锁过程结束</tspan></tspan></text></g></g><g id="SvgjsG1454"><path id="SvgjsPath1455" d="M707.1317183778492 846.0224639294202L707.1317183778492 871.8950237199379L708.7462497094069 871.8950237199379L708.7462497094069 897.7675835104556" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1456)"></path></g></svg>