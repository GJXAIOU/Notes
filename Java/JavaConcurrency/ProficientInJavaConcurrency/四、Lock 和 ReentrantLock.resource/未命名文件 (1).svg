<svg id="SvgjsSvg1458" width="1112.9757690429688" height="996.4826965332031" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs"><defs id="SvgjsDefs1459"><marker id="SvgjsMarker1492" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1493" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1500" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1501" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1508" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1509" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1512" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1513" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1548" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1549" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1556" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1557" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1560" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1561" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1578" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1579" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1582" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1583" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1610" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1611" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1630" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1631" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1638" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1639" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1642" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1643" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1672" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1673" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1686" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1687" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1690" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1691" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker></defs><g id="SvgjsG1460" transform="translate(500.4583435058594,25.001342837304414)"><path id="SvgjsPath1461" d="M 0 0L 206 0L 206 58L 0 58Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1462"><text id="SvgjsText1463" font-family="微软雅黑" text-anchor="middle" font-size="16px" width="186px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="16px" weight="400" font-style="" opacity="1" y="17" transform="rotate(0)"><tspan id="SvgjsTspan1464" dy="20" x="103"><tspan id="SvgjsTspan1465" style="text-decoration:;">ReentrantLock.lock()</tspan></tspan></text></g></g><g id="SvgjsG1466" transform="translate(535.9583435058594,125.28416609563743)"><path id="SvgjsPath1467" d="M 0 0L 135 0L 135 38.663740398503194L 0 38.663740398503194Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1468"><text id="SvgjsText1469" font-family="微软雅黑" text-anchor="middle" font-size="16px" width="115px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="16px" weight="400" font-style="" opacity="1" y="7.331870199251597" transform="rotate(0)"><tspan id="SvgjsTspan1470" dy="20" x="67.5"><tspan id="SvgjsTspan1471" style="text-decoration:;">sync#lock()</tspan></tspan></text></g></g><g id="SvgjsG1472" transform="translate(516.4583435058594,201.09435935425586)"><path id="SvgjsPath1473" d="M 0 39L 96 0L 192 39L 96 78Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1474"><text id="SvgjsText1475" font-family="微软雅黑" text-anchor="middle" font-size="16px" width="172px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="16px" weight="400" font-style="" opacity="1" y="27.39" transform="rotate(0)"><tspan id="SvgjsTspan1476" dy="20" x="96"><tspan id="SvgjsTspan1477" style="text-decoration:;">abstract void lock()</tspan></tspan></text></g></g><g id="SvgjsG1478" transform="translate(369.4583435058594,336.3263854980469)"><path id="SvgjsPath1479" d="M 0 0L 148 0L 148 67L 0 67Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1480"><text id="SvgjsText1481" font-family="微软雅黑" text-anchor="middle" font-size="16px" width="128px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="16px" weight="400" font-style="" opacity="1" y="21.5" transform="rotate(0)"><tspan id="SvgjsTspan1482" dy="20" x="74"><tspan id="SvgjsTspan1483" style="text-decoration:;">FairSync#lock()</tspan></tspan></text></g></g><g id="SvgjsG1484" transform="translate(688.4583435058594,347.0943593542558)"><path id="SvgjsPath1485" d="M 0 0L 176 0L 176 67L 0 67Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1486"><text id="SvgjsText1487" font-family="微软雅黑" text-anchor="middle" font-size="16px" width="156px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="16px" weight="400" font-style="" opacity="1" y="21.5" transform="rotate(0)"><tspan id="SvgjsTspan1488" dy="20" x="88"><tspan id="SvgjsTspan1489" style="text-decoration:;">NonFairSync#lock()</tspan></tspan></text></g></g><g id="SvgjsG1490"><path id="SvgjsPath1491" d="M516.4583435058594 240.09435935425574L443.45834350585903 240.09435935425574L443.45834350585903 336.3263854980469" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1492)"></path><rect id="SvgjsRect1494" width="48" height="20" x="419.4583435058591" y="241.71037242615114" fill="#ffffff"></rect><text id="SvgjsText1495" font-family="微软雅黑" text-anchor="middle" font-size="16px" width="48px" fill="#323232" font-weight="400" align="top" lineHeight="20px" anchor="middle" family="微软雅黑" size="16px" weight="400" font-style="" opacity="1" y="239.71037242615114" transform="rotate(0)"><tspan id="SvgjsTspan1496" dy="20" x="443.4583435058591"><tspan id="SvgjsTspan1497" style="text-decoration:;">公平锁</tspan></tspan></text></g><g id="SvgjsG1498"><path id="SvgjsPath1499" d="M708.4583435058594 240.09435935425574L776.4583435058594 240.09435935425574L776.4583435058594 347.0943593542558" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1500)"></path><rect id="SvgjsRect1502" width="64" height="20" x="744.4583435058594" y="249.59435935425574" fill="#ffffff"></rect><text id="SvgjsText1503" font-family="微软雅黑" text-anchor="middle" font-size="16px" width="64px" fill="#323232" font-weight="400" align="top" lineHeight="20px" anchor="middle" family="微软雅黑" size="16px" weight="400" font-style="" opacity="1" y="247.59435935425574" transform="rotate(0)"><tspan id="SvgjsTspan1504" dy="20" x="776.4583435058594"><tspan id="SvgjsTspan1505" style="text-decoration:;">非公平锁</tspan></tspan></text></g><g id="SvgjsG1506"><path id="SvgjsPath1507" d="M603.4583435058594 83.0013428373044L603.4583435058594 104.14275446647093L603.4583435058594 104.14275446647093L603.4583435058594 125.28416609563743" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1508)"></path></g><g id="SvgjsG1510"><path id="SvgjsPath1511" d="M612.4583435058594 163.94790649414062L612.4583435058594 182.52113292419824L612.4583435058594 182.52113292419824L612.4583435058594 201.09435935425586" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1512)"></path></g><g id="SvgjsG1514" transform="translate(535.9583435058594,336.3263854980469)"><path id="SvgjsPath1515" d="M 0 0L 119 0L 135 16L 135 67L 0 67L 0 0Z" stroke="none" fill-opacity="1" fill="#ccff99"></path><path id="SvgjsPath1516" d="M 119 0L 119 16L 135 16Z" stroke="none" fill-opacity="1" fill="#cdcdcd"></path><path id="SvgjsPath1517" d="M 0 0L 119 0L 135 16L 135 67L 0 67L 0 0Z" stroke="none" fill="none"></path><g id="SvgjsG1518"><text id="SvgjsText1519" font-family="微软雅黑" text-anchor="start" font-size="13px" width="115px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="8.375" transform="rotate(0)"><tspan id="SvgjsTspan1520" dy="16" x="10"><tspan id="SvgjsTspan1521" style="text-decoration:;">final void lock() {</tspan></tspan><tspan id="SvgjsTspan1522" dy="16" x="10"><tspan id="SvgjsTspan1523" style="text-decoration:;">   acquire(1);</tspan></tspan><tspan id="SvgjsTspan1524" dy="16" x="10"><tspan id="SvgjsTspan1525" style="text-decoration:;">  }</tspan></tspan></text></g></g><g id="SvgjsG1526" transform="translate(369.4583435058594,460.3263854980469)"><path id="SvgjsPath1527" d="M 0 0L 148 0L 148 67L 0 67Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1528"><text id="SvgjsText1529" font-family="微软雅黑" text-anchor="middle" font-size="16px" width="128px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="16px" weight="400" font-style="" opacity="1" y="21.5" transform="rotate(0)"><tspan id="SvgjsTspan1530" dy="20" x="74"><tspan id="SvgjsTspan1531" style="text-decoration:;">AQS#acquire(1)</tspan></tspan></text></g></g><g id="SvgjsG1532" transform="translate(347.4583435058594,565.205470465368)"><path id="SvgjsPath1533" d="M 0 39L 96 0L 192 39L 96 78L 0 39Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1534"><text id="SvgjsText1535" font-family="微软雅黑" text-anchor="middle" font-size="16px" width="172px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="16px" weight="400" font-style="" opacity="1" y="27" transform="rotate(0)"><tspan id="SvgjsTspan1536" dy="20" x="96"><tspan id="SvgjsTspan1537" style="text-decoration:;">FairSync#tryAcquire()</tspan></tspan></text></g></g><g id="SvgjsG1538" transform="translate(216.2202482677642,683.8562007729529)"><path id="SvgjsPath1539" d="M 0 0L 165 0L 165 51.940369450188086L 0 51.940369450188086Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1540"><text id="SvgjsText1541" font-family="微软雅黑" text-anchor="middle" font-size="16px" width="145px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="16px" weight="400" font-style="" opacity="1" y="3.970184725094043" transform="rotate(0)"><tspan id="SvgjsTspan1542" dy="20" x="82.5"><tspan id="SvgjsTspan1543" style="text-decoration:;">获取到锁，加锁过程</tspan></tspan><tspan id="SvgjsTspan1544" dy="20" x="82.5"><tspan id="SvgjsTspan1545" style="text-decoration:;">完成</tspan></tspan></text></g></g><g id="SvgjsG1546"><path id="SvgjsPath1547" d="M347.4583435058594 607.6317786337675L298.7202482677643 607.6317786337675L298.7202482677643 683.8562007729529" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1548)"></path><rect id="SvgjsRect1550" width="31" height="20" x="283.2202482677643" y="611.3749420843127" fill="#ffffff"></rect><text id="SvgjsText1551" font-family="微软雅黑" text-anchor="middle" font-size="16px" width="31px" fill="#323232" font-weight="400" align="top" lineHeight="20px" anchor="middle" family="微软雅黑" size="16px" weight="400" font-style="" opacity="1" y="609.3749420843127" transform="rotate(0)"><tspan id="SvgjsTspan1552" dy="20" x="298.7202482677643"><tspan id="SvgjsTspan1553" style="text-decoration:;">true</tspan></tspan></text></g><g id="SvgjsG1554"><path id="SvgjsPath1555" d="M443.45834350585926 403.3263854980469L443.45834350585926 431.8263854980469L443.45834350585926 431.8263854980469L443.45834350585926 460.3263854980469" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1556)"></path></g><g id="SvgjsG1558"><path id="SvgjsPath1559" d="M443.45834350585926 527.3263854980469L443.45834350585926 546.2659279817074L443.45834350585926 546.2659279817074L443.45834350585926 565.205470465368" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1560)"></path></g><g id="SvgjsG1562" transform="translate(507.7083435058594,680.8263854980469)"><path id="SvgjsPath1563" d="M 0 0L 157.5 0L 157.5 58L 0 58Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1564"><text id="SvgjsText1565" font-family="微软雅黑" text-anchor="middle" font-size="16px" width="138px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="16px" weight="400" font-style="" opacity="1" y="17" transform="rotate(0)"><tspan id="SvgjsTspan1566" dy="20" x="79"><tspan id="SvgjsTspan1567" style="text-decoration:;">AQS#addWaiter()</tspan></tspan></text></g></g><g id="SvgjsG1568" transform="translate(490.4583435058594,784.0224639294202)"><path id="SvgjsPath1569" d="M 0 0L 192 0L 192 58L 0 58Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1570"><text id="SvgjsText1571" font-family="微软雅黑" text-anchor="middle" font-size="16px" width="172px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="16px" weight="400" font-style="" opacity="1" y="17" transform="rotate(0)"><tspan id="SvgjsTspan1572" dy="20" x="96"><tspan id="SvgjsTspan1573" style="text-decoration:;">AQS#acquireQuened(</tspan></tspan><tspan id="SvgjsTspan1574" dy="20" x="96"><tspan id="SvgjsTspan1575" style="text-decoration:;">)</tspan></tspan></text></g></g><g id="SvgjsG1576"><path id="SvgjsPath1577" d="M586.4583435058594 738.8263854980469L586.4583435058594 761.4244247137335L586.4583435058594 761.4244247137335L586.4583435058594 784.0224639294202" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1578)"></path></g><g id="SvgjsG1580"><path id="SvgjsPath1581" d="M539.4583435058594 604.2054704653682L586.4583435058595 604.2054704653682L586.4583435058595 680.8263854980469" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1582)"></path><rect id="SvgjsRect1584" width="36" height="20" x="568.4583435058595" y="609.0159279817076" fill="#ffffff"></rect><text id="SvgjsText1585" font-family="微软雅黑" text-anchor="middle" font-size="16px" width="36px" fill="#323232" font-weight="400" align="top" lineHeight="20px" anchor="middle" family="微软雅黑" size="16px" weight="400" font-style="" opacity="1" y="607.0159279817076" transform="rotate(0)"><tspan id="SvgjsTspan1586" dy="20" x="586.4583435058595"><tspan id="SvgjsTspan1587" style="text-decoration:;">false</tspan></tspan></text></g><g id="SvgjsG1588" transform="translate(55.00065540132073,820.7566702116061)"><path id="SvgjsPath1589" d="M 0 0L 415.03663547295974 0L 431.03663547295974 16L 431.03663547295974 148.13943057288157L 0 148.13943057288157L 0 0Z" stroke="none" fill-opacity="1" fill="#ffffaa"></path><path id="SvgjsPath1590" d="M 415.03663547295974 0L 415.03663547295974 16L 431.03663547295974 16Z" stroke="none" fill-opacity="1" fill="#cdcdcd"></path><path id="SvgjsPath1591" d="M 0 0L 415.03663547295974 0L 431.03663547295974 16L 431.03663547295974 148.13943057288157L 0 148.13943057288157L 0 0Z" stroke="none" fill="none"></path><g id="SvgjsG1592"><text id="SvgjsText1593" font-family="微软雅黑" text-anchor="start" font-size="13px" width="412px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="17.944715286440783" transform="rotate(0)"><tspan id="SvgjsTspan1594" dy="16" x="10"><tspan id="SvgjsTspan1595" style="text-decoration:;">// 首先尝试通过 FairSync 的 tryAcquire() 获取锁，如果返回 false 即</tspan></tspan><tspan id="SvgjsTspan1596" dy="16" x="10"><tspan id="SvgjsTspan1597" style="text-decoration:;">没有获取锁，则通过 acquireQueued 来放入后面的阻塞队列（排队）</tspan></tspan><tspan id="SvgjsTspan1598" dy="16" x="10"><tspan id="SvgjsTspan1599" style="text-decoration:;">public final void acquire(int arg) {</tspan></tspan><tspan id="SvgjsTspan1600" dy="16" x="10"><tspan id="SvgjsTspan1601" style="text-decoration:;">    if (!tryAcquire(arg) &amp;&amp; </tspan></tspan><tspan id="SvgjsTspan1602" dy="16" x="10"><tspan id="SvgjsTspan1603" style="text-decoration:;">acquireQueued(addWaiter(Node.EXCLUSIVE), arg))</tspan></tspan><tspan id="SvgjsTspan1604" dy="16" x="10"><tspan id="SvgjsTspan1605" style="text-decoration:;">        selfInterrupt();</tspan></tspan><tspan id="SvgjsTspan1606" dy="16" x="10"><tspan id="SvgjsTspan1607" style="text-decoration:;">}</tspan></tspan></text></g></g><g id="SvgjsG1608"><path id="SvgjsPath1609" d="M369.4583435058594 501.0920070481641L25.000655401320728 501.0920070481641L25.000655401320728 911.4599142899984L55.00065540132073 911.4599142899984" stroke-dasharray="3,3" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1610)"></path></g><g id="SvgjsG1612" transform="translate(706.6736297607422,460.3263854980469)"><path id="SvgjsPath1613" d="M 0 33.5L 69.78471374511719 0L 139.56942749023438 33.5L 69.78471374511719 67L 0 33.5Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1614"><text id="SvgjsText1615" font-family="微软雅黑" text-anchor="middle" font-size="16px" width="120px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="16px" weight="400" font-style="" opacity="1" y="21.5" transform="rotate(0)"><tspan id="SvgjsTspan1616" dy="20" x="70"><tspan id="SvgjsTspan1617" style="text-decoration:;">CAS 获取锁</tspan></tspan></text></g></g><g id="SvgjsG1618" transform="translate(688.4583435058594,587.8573484627461)"><path id="SvgjsPath1619" d="M 0 0L 176 0L 176 67L 0 67Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1620"><text id="SvgjsText1621" font-family="微软雅黑" text-anchor="middle" font-size="16px" width="156px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="16px" weight="400" font-style="" opacity="1" y="1.5" transform="rotate(0)"><tspan id="SvgjsTspan1622" dy="20" x="88"><tspan id="SvgjsTspan1623" style="text-decoration:;">获取到锁，设置当前</tspan></tspan><tspan id="SvgjsTspan1624" dy="20" x="88"><tspan id="SvgjsTspan1625" style="text-decoration:;">线程持有该锁，返</tspan></tspan><tspan id="SvgjsTspan1626" dy="20" x="88"><tspan id="SvgjsTspan1627" style="text-decoration:;">回。</tspan></tspan></text></g></g><g id="SvgjsG1628"><path id="SvgjsPath1629" d="M706.6736297607422 493.5388037987011L610.2321112469599 493.5388037987011L610.2321112469599 493.5388037987011L514.5058789880603 493.5388037987011" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1630)"></path><rect id="SvgjsRect1632" width="36" height="20" x="592.5897543744012" y="483.5388037987011" fill="#ffffff"></rect><text id="SvgjsText1633" font-family="微软雅黑" text-anchor="middle" font-size="16px" width="36px" fill="#323232" font-weight="400" align="top" lineHeight="20px" anchor="middle" family="微软雅黑" size="16px" weight="400" font-style="" opacity="1" y="481.5388037987011" transform="rotate(0)"><tspan id="SvgjsTspan1634" dy="20" x="610.5897543744012"><tspan id="SvgjsTspan1635" style="text-decoration:;">false</tspan></tspan></text></g><g id="SvgjsG1636"><path id="SvgjsPath1637" d="M776.4583435058594 414.0943593542558L776.4583435058594 437.34425147361185L776.4583435058594 437.34425147361185L776.4583435058594 460.3263854980469" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1638)"></path></g><g id="SvgjsG1640"><path id="SvgjsPath1641" d="M776.4583435058594 527.3263854980469L776.4583435058594 557.5918669803965L776.4583435058594 557.5918669803965L776.4583435058594 587.8573484627461" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1642)"></path><rect id="SvgjsRect1644" width="31" height="20" x="760.9583435058594" y="547.5918669803965" fill="#ffffff"></rect><text id="SvgjsText1645" font-family="微软雅黑" text-anchor="middle" font-size="16px" width="31px" fill="#323232" font-weight="400" align="top" lineHeight="20px" anchor="middle" family="微软雅黑" size="16px" weight="400" font-style="" opacity="1" y="545.5918669803965" transform="rotate(0)"><tspan id="SvgjsTspan1646" dy="20" x="776.4583435058594"><tspan id="SvgjsTspan1647" style="text-decoration:;">true</tspan></tspan></text></g><g id="SvgjsG1648" transform="translate(688.9859034373701,817.4881502039292)"><path id="SvgjsPath1649" d="M 0 0L 382.976685973093 0L 398.976685973093 16L 398.976685973093 154.67647058823542L 0 154.67647058823542L 0 0Z" stroke="none" fill-opacity="1" fill="#ffffaa"></path><path id="SvgjsPath1650" d="M 382.976685973093 0L 382.976685973093 16L 398.976685973093 16Z" stroke="none" fill-opacity="1" fill="#cdcdcd"></path><path id="SvgjsPath1651" d="M 0 0L 382.976685973093 0L 398.976685973093 16L 398.976685973093 154.67647058823542L 0 154.67647058823542L 0 0Z" stroke="none" fill="none"></path><g id="SvgjsG1652"><text id="SvgjsText1653" font-family="微软雅黑" text-anchor="start" font-size="13px" width="379px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="13.713235294117709" transform="rotate(0)"><tspan id="SvgjsTspan1654" dy="16" x="10"><tspan id="SvgjsTspan1655" style="text-decoration:;">final void lock() {</tspan></tspan><tspan id="SvgjsTspan1656" dy="16" x="10"><tspan id="SvgjsTspan1657" style="text-decoration:;">      // CAS 尝试将 0 换成 1 然后设置排它锁</tspan></tspan><tspan id="SvgjsTspan1658" dy="16" x="10"><tspan id="SvgjsTspan1659" style="text-decoration:;">       if (compareAndSetState(0, 1)){</tspan></tspan><tspan id="SvgjsTspan1660" dy="16" x="10"><tspan id="SvgjsTspan1661" style="text-decoration:;">              setExclusiveOwnerThread(Thread.currentThread());</tspan></tspan><tspan id="SvgjsTspan1662" dy="16" x="10"><tspan id="SvgjsTspan1663" style="text-decoration:;">       }else{</tspan></tspan><tspan id="SvgjsTspan1664" dy="16" x="10"><tspan id="SvgjsTspan1665" style="text-decoration:;">              acquire(1);</tspan></tspan><tspan id="SvgjsTspan1666" dy="16" x="10"><tspan id="SvgjsTspan1667" style="text-decoration:;">      }</tspan></tspan><tspan id="SvgjsTspan1668" dy="16" x="10"><tspan id="SvgjsTspan1669" style="text-decoration:;">  }</tspan></tspan></text></g></g><g id="SvgjsG1670"><path id="SvgjsPath1671" d="M864.4583435058594 377.9008272408223L888.4742464239166 377.9008272408223L888.4742464239166 817.4881502039292" stroke-dasharray="3,3" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1672)"></path></g><g id="SvgjsG1674" transform="translate(490.4583435058594,889.1701431274414)"><path id="SvgjsPath1675" d="M 0 0L 192 0L 192 82.26027138253721L 0 82.26027138253721Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1676"><text id="SvgjsText1677" font-family="微软雅黑" text-anchor="start" font-size="16px" width="172px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="16px" weight="400" font-style="" opacity="1" y="9.130135691268606" transform="rotate(0)"><tspan id="SvgjsTspan1678" dy="20" x="10"><tspan id="SvgjsTspan1679" style="text-decoration:;">acquireQueued() 返</tspan></tspan><tspan id="SvgjsTspan1680" dy="20" x="10"><tspan id="SvgjsTspan1681" style="text-decoration:;">回，表示线程获取到</tspan></tspan><tspan id="SvgjsTspan1682" dy="20" x="10"><tspan id="SvgjsTspan1683" style="text-decoration:;">锁，加锁过程结束</tspan></tspan></text></g></g><g id="SvgjsG1684"><path id="SvgjsPath1685" d="M586.6745664300504 842.0224639294202L586.6745664300504 865.1701431274414L586.6745664300504 865.1701431274414L586.6745664300504 889.1701431274414" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1686)"></path></g><g id="SvgjsG1688"><path id="SvgjsPath1689" d="M517.4583435058594 369.8263854980469L526.0218208565416 369.8263854980469L526.0218208565416 369.8263854980469L535.9583435058594 369.8263854980469" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1690)"></path></g></svg>