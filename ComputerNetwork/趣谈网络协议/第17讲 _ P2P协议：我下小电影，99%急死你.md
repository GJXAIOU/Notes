# 第17讲 \| P2P协议：我下小电影，99%急死你

作者: 刘超

完成时间:

总结时间:



<audio><source src="https://static001.geekbang.org/resource/audio/70/af/70a9034e8e3d8cd4c67174c1e09bfcaf.mp3" type="audio/mpeg"></audio>

如果你想下载一个电影，一般会通过什么方式呢？

当然，最简单的方式就是通过**HTTP**进行下载。但是相信你有过这样的体验，通过浏览器下载的时候，只要文件稍微大点，下载的速度就奇慢无比。

还有种下载文件的方式，就是通过**FTP**，也即**文件传输协议**。FTP采用两个TCP连接来传输一个文件。

- **控制连接**：服务器以被动的方式，打开众所周知用于FTP的端口21，客户端则主动发起连接。该连接将命令从客户端传给服务器，并传回服务器的应答。常用的命令有：list——获取文件目录；reter——取一个文件；store——存一个文件。

- **数据连接**：每当一个文件在客户端与服务器之间传输时，就创建一个数据连接。


<!-- -->

## FTP的两种工作模式

每传输一个文件，都要建立一个全新的数据连接。FTP有两种工作模式，分别是**主动模式**（**PORT**）和**被动模式**（**PASV**），这些都是站在FTP服务器的角度来说的。

主动模式下，客户端随机打开一个大于1024的端口N，向服务器的命令端口21发起连接，同时开放N+1端口监听，并向服务器发出 “port N+1” 命令，由服务器从自己的数据端口20，主动连接到客户端指定的数据端口N+1。

被动模式下，当开启一个FTP连接时，客户端打开两个任意的本地端口N（大于1024）和N+1。第一个端口连接服务器的21端口，提交PASV命令。然后，服务器会开启一个任意的端口P（大于1024），返回“227 entering passive mode”消息，里面有FTP服务器开放的用来进行数据传输的端口。客户端收到消息取得端口号之后，会通过N+1号端口连接服务器的端口P，然后在两个端口之间进行数据传输。

<!-- [[[read_end]]] -->

## P2P是什么？

但是无论是HTTP的方式，还是FTP的方式，都有一个比较大的缺点，就是**难以解决单一服务器的带宽压力**， 因为它们使用的都是传统的客户端服务器的方式。

后来，一种创新的、称为P2P的方式流行起来。**P2P**就是**peer-to-peer**。资源开始并不集中地存储在某些设备上，而是分散地存储在多台设备上。这些设备我们姑且称为peer。

想要下载一个文件的时候，你只要得到那些已经存在了文件的peer，并和这些peer之间，建立点对点的连接，而不需要到中心服务器上，就可以就近下载文件。一旦下载了文件，你也就成为peer中的一员，你旁边的那些机器，也可能会选择从你这里下载文件，所以当你使用P2P软件的时候，例如BitTorrent，往往能够看到，既有下载流量，也有上传的流量，也即你自己也加入了这个P2P的网络，自己从别人那里下载，同时也提供给其他人下载。可以想象，这种方式，参与的人越多，下载速度越快，一切完美。

## 种子（.torrent）文件

但是有一个问题，当你想下载一个文件的时候，怎么知道哪些peer有这个文件呢？

这就用到**种子**啦，也即咱们比较熟悉的**.torrent文件**。.torrent文件由两部分组成，分别是：**announce**（**tracker URL**）和**文件信息**。

文件信息里面有这些内容。

- **info区**：这里指定的是该种子有几个文件、文件有多长、目录结构，以及目录和文件的名字。

- **Name字段**：指定顶层目录名字。

- **每个段的大小**：BitTorrent（简称BT）协议把一个文件分成很多个小段，然后分段下载。

- **段哈希值**：将整个种子中，每个段的SHA-1哈希值拼在一起。


<!-- -->

下载时，BT客户端首先解析.torrent文件，得到tracker地址，然后连接tracker服务器。tracker服务器回应下载者的请求，将其他下载者（包括发布者）的IP提供给下载者。下载者再连接其他下载者，根据.torrent文件，两者分别对方告知自己已经有的块，然后交换对方没有的数据。此时不需要其他服务器参与，并分散了单个线路上的数据流量，因此减轻了服务器的负担。

下载者每得到一个块，需要算出下载块的Hash验证码，并与.torrent文件中的对比。如果一样，则说明块正确，不一样则需要重新下载这个块。这种规定是为了解决下载内容的准确性问题。

从这个过程也可以看出，这种方式特别依赖tracker。tracker需要收集下载者信息的服务器，并将此信息提供给其他下载者，使下载者们相互连接起来，传输数据。虽然下载的过程是非中心化的，但是加入这个P2P网络的时候，都需要借助tracker中心服务器，这个服务器是用来登记有哪些用户在请求哪些资源。

所以，这种工作方式有一个弊端，一旦tracker服务器出现故障或者线路遭到屏蔽，BT工具就无法正常工作了。

## 去中心化网络（DHT）

那能不能彻底非中心化呢？

于是，后来就有了一种叫作**DHT**（**Distributed Hash Table**）的去中心化网络。每个加入这个DHT网络的人，都要负责存储这个网络里的资源信息和其他成员的联系信息，相当于所有人一起构成了一个庞大的分布式存储数据库。

有一种著名的DHT协议，叫**Kademlia协议**。这个和区块链的概念一样，很抽象，我来详细讲一下这个协议。

任何一个BitTorrent启动之后，它都有两个角色。一个是**peer**，监听一个TCP端口，用来上传和下载文件，这个角色表明，我这里有某个文件。另一个角色**DHT node**，监听一个UDP的端口，通过这个角色，这个节点加入了一个DHT的网络。

![](<https://static001.geekbang.org/resource/image/80/27/80ecacb45587d201cbb9a08c31476d27.jpg?wh=1848*1359>)<br>

 在DHT网络里面，每一个DHT node都有一个ID。这个ID是一个很长的串。每个DHT node都有责任掌握一些知识，也就是**文件索引**，也即它应该知道某些文件是保存在哪些节点上。它只需要有这些知识就可以了，而它自己本身不一定就是保存这个文件的节点。

## 哈希值

当然，每个DHT node不会有全局的知识，也即不知道所有的文件保存在哪里，它只需要知道一部分。那应该知道哪一部分呢？这就需要用哈希算法计算出来。

每个文件可以计算出一个哈希值，而**DHT node的ID是和哈希值相同长度的串**。

DHT算法是这样规定的：如果一个文件计算出一个哈希值，则和这个哈希值一样的那个DHT node，就有责任知道从哪里下载这个文件，即便它自己没保存这个文件。

当然不一定这么巧，总能找到和哈希值一模一样的，有可能一模一样的DHT node也下线了，所以DHT算法还规定：除了一模一样的那个DHT node应该知道，ID和这个哈希值非常接近的N个DHT node也应该知道。

什么叫和哈希值接近呢？例如只修改了最后一位，就很接近；修改了倒数2位，也不远；修改了倒数3位，也可以接受。总之，凑齐了规定的N这个数就行。

刚才那个图里，文件1通过哈希运算，得到匹配ID的DHT node为node C，当然还会有其他的，我这里没有画出来。所以，node C有责任知道文件1的存放地址，虽然node C本身没有存放文件1。

同理，文件2通过哈希运算，得到匹配ID的DHT node为node E，但是node D和E的ID值很近，所以node D也知道。当然，文件2本身没有必要一定在node D和E里，但是碰巧这里就在E那有一份。

接下来一个新的节点node new上线了。如果想下载文件1，它首先要加入DHT网络，如何加入呢？

在这种模式下，种子.torrent文件里面就不再是tracker的地址了，而是一个list的node的地址，而所有这些node都是已经在DHT网络里面的。当然随着时间的推移，很可能有退出的，有下线的，但是我们假设，不会所有的都联系不上，总有一个能联系上。

node new只要在种子里面找到一个DHT node，就加入了网络。

node new会计算文件1的哈希值，并根据这个哈希值了解到，和这个哈希值匹配，或者很接近的node上知道如何下载这个文件，例如计算出来的哈希值就是node C。

但是node new不知道怎么联系上node C，因为种子里面的node列表里面很可能没有node C，但是它可以问，DHT网络特别像一个社交网络，node new只有去它能联系上的node问，你们知道不知道node C的联系方式呀？

在DHT网络中，每个node都保存了一定的联系方式，但是肯定没有node的所有联系方式。DHT网络中，节点之间通过互相通信，也会交流联系方式，也会删除联系方式。和人们的方式一样，你有你的朋友圈，你的朋友有它的朋友圈，你们互相加微信，就互相认识了，过一段时间不联系，就删除朋友关系。

有个理论是，社交网络中，任何两个人直接的距离不超过六度，也即你想联系比尔盖茨，也就六个人就能够联系到了。

所以，node new想联系node C，就去万能的朋友圈去问，并且求转发，朋友再问朋友，很快就能找到。如果找不到C，也能找到和C的ID很像的节点，它们也知道如何下载文件1。

在node C上，告诉node new，下载文件1，要去B、D、 F，于是node new选择和node B进行peer连接，开始下载，它一旦开始下载，自己本地也有文件1了，于是node new告诉node C以及和node C的ID很像的那些节点，我也有文件1了，可以加入那个文件拥有者列表了。

但是你会发现node new上没有文件索引，但是根据哈希算法，一定会有某些文件的哈希值是和node new的ID匹配上的。在DHT网络中，会有节点告诉它，你既然加入了咱们这个网络，你也有责任知道某些文件的下载地址。

好了，一切都分布式了。

这里面遗留几个细节的问题。

- DHT node ID以及文件哈希是个什么东西？

<!-- -->

节点ID是一个随机选择的160bits（20字节）空间，文件的哈希也使用这样的160bits空间。

- 所谓ID相似，具体到什么程度算相似？

<!-- -->

在Kademlia网络中，距离是通过异或（XOR）计算的。我们就不以160bits举例了。我们以5位来举例。

01010与01000的距离，就是两个ID之间的异或值，为00010，也即为2。 01010与00010的距离为01000，也即为8,。01010与00011的距离为01001，也即8+1=9 。以此类推，高位不同的，表示距离更远一些；低位不同的，表示距离更近一些，总的距离为所有的不同的位的距离之和。

这个距离不能比喻为地理位置，因为在Kademlia网络中，位置近不算近，ID近才算近，所以我把这个距离比喻为社交距离，也即在朋友圈中的距离，或者社交网络中的距离。这个和你住的位置没有关系，和人的经历关系比较大。

还是以5位ID来举例，就像在领英中，排第一位的表示最近一份工作在哪里，第二位的表示上一份工作在哪里，然后第三位的是上上份工作，第四位的是研究生在哪里读，第五位的表示大学在哪里读。

如果你是一个猎头，在上面找候选人，当然最近的那份工作是最重要的。而对于工作经历越丰富的候选人，大学在哪里读的反而越不重要。

## DHT网络中的朋友圈是怎么维护的？

就像人一样，虽然我们常联系人的只有少数，但是朋友圈里肯定是远近都有。DHT网络的朋友圈也是一样，远近都有，并且**按距离分层**。

假设某个节点的ID为01010，如果一个节点的ID，前面所有位数都与它相同，只有最后1位不同。这样的节点只有1个，为01011。与基础节点的异或值为00001，即距离为1；对于01010而言，这样的节点归为“k-bucket 1”。

如果一个节点的ID，前面所有位数都相同，从倒数第2位开始不同，这样的节点只有2个，即01000和01001，与基础节点的异或值为00010和00011，即距离范围为2和3；对于01010而言，这样的节点归为“k-bucket 2”。

如果一个节点的ID，前面所有位数相同，从倒数第i位开始不同，这样的节点只有2^(i-1)个，与基础节点的距离范围为[2^(i-1), 2^i)；对于01010而言，这样的节点归为“k-bucket i”。

最终到从倒数160位就开始都不同。

你会发现，差距越大，陌生人越多，但是朋友圈不能都放下，所以每一层都只放K个，这是参数可以配置。

## DHT网络是如何查找朋友的？

假设，node A 的ID为00110，要找node B ID为10000，异或距离为10110，距离范围在[2^4, 2^5)，所以这个目标节点可能在“k-bucket 5”中，这就说明B的ID与A的ID从第5位开始不同，所以B可能在“k-bucket 5”中。

然后，A看看自己的k-bucket 5有没有B。如果有，太好了，找到你了；如果没有，在k-bucket 5里随便找一个C。因为是二进制，C、B都和A的第5位不同，那么C的ID第5位肯定与B相同，即它与B的距离会小于2^4，相当于比A、B之间的距离缩短了一半以上。

再请求C，在它自己的通讯录里，按同样的查找方式找一下B。如果C知道B，就告诉A；如果C也不知道B，那C按同样的搜索方法，可以在自己的通讯录里找到一个离B更近的D朋友（D、B之间距离小于2^3），把D推荐给A，A请求D进行下一步查找。

Kademlia的这种查询机制，是通过折半查找的方式来收缩范围，对于总的节点数目为N，最多只需要查询log2(N)次，就能够找到。

例如，图中这个最差的情况。

![](<https://static001.geekbang.org/resource/image/dc/b4/dc6d713751d09ea5dd0d79c65433aeb4.jpg?wh=3021*653>)

A和B每一位都不一样，所以相差31，A找到的朋友C，不巧正好在中间。和A的距离是16，和B距离为15，于是C去自己朋友圈找的时候，不巧找到D，正好又在中间，距离C为8，距离B为7。于是D去自己朋友圈找的时候，不巧找到E，正好又在中间，距离D为4，距离B为3，E在朋友圈找到F，距离E为2，距离B为1，最终在F的朋友圈距离1的地方找到B。当然这是最最不巧的情况，每次找到的朋友都不远不近，正好在中间。

如果碰巧了，在A的朋友圈里面有G，距离B只有3，然后在G的朋友圈里面一下子就找到了B，两次就找到了。

在DHT网络中，朋友之间怎么沟通呢？

Kademlia算法中，每个节点只有4个指令。

- PING：测试一个节点是否在线，还活着没，相当于打个电话，看还能打通不。

- STORE：要求一个节点存储一份数据，既然加入了组织，有义务保存一份数据。

- FIND\_NODE：根据节点ID查找一个节点，就是给一个160位的ID，通过上面朋友圈的方式找到那个节点。

- FIND\_VALUE：根据KEY查找一个数据，实则上跟FIND\_NODE非常类似。KEY就是文件对应的160位的ID，就是要找到保存了文件的节点。


<!-- -->

DHT网络中，朋友圈如何更新呢？

- 每个bucket里的节点，都按最后一次接触的时间倒序排列，这就相当于，朋友圈里面最近联系过的人往往是最熟的。

- 每次执行四个指令中的任意一个都会触发更新。

- 当一个节点与自己接触时，检查它是否已经在k-bucket中，也就是说是否已经在朋友圈。如果在，那么将它挪到k-bucket列表的最底，也就是最新的位置，刚联系过，就置顶一下，方便以后多联系；如果不在，新的联系人要不要加到通讯录里面呢？假设通讯录已满的情况，PING一下列表最上面，也即最旧的一个节点。如果PING通了，将旧节点挪到列表最底，并丢弃新节点，老朋友还是留一下；如果PING不通，删除旧节点，并将新节点加入列表，这人联系不上了，删了吧。


<!-- -->

这个机制保证了任意节点加入和离开都不影响整体网络。

## 小结

好了，今天的讲解就到这里了，我们总结一下：

- 下载一个文件可以使用HTTP或FTP，这两种都是集中下载的方式，而P2P则换了一种思路，采取非中心化下载的方式；

- P2P也是有两种，一种是依赖于tracker的，也即元数据集中，文件数据分散；另一种是基于分布式的哈希算法，元数据和文件数据全部分散。


<!-- -->

接下来，给你留两个思考题：

1. 除了这种去中心化分布式哈希的算法，你还能想到其他的应用场景吗？

2. 在前面所有的章节中，要下载一个文件，都需要使用域名。但是网络通信是使用IP的，那你知道怎么实现两者的映射机制吗？


<!-- -->

我们的专栏马上更新过半了，不知你掌握得如何？每节课后我留的思考题，你都有没有认真思考，并在留言区写下答案呢？我会从已发布的文章中选出一批认真留言的同学，赠送<span class="orange">学习奖励礼券</span>

和我整理的<span class="orange">独家网络协议知识图谱</span>

。

欢迎你留言和我讨论。趣谈网络协议，我们下期见！

## 精选留言(118)

- ![img](%E7%AC%AC17%E8%AE%B2%20_%20P2P%E5%8D%8F%E8%AE%AE%EF%BC%9A%E6%88%91%E4%B8%8B%E5%B0%8F%E7%94%B5%E5%BD%B1%EF%BC%8C99%25%E6%80%A5%E6%AD%BB%E4%BD%A0.resource/resize,m_fill,h_34,w_34.jpeg)

  风太息

  99%卡住的原因是什么呢，似乎没讲

  2018-06-25

  **5

  **143

- ![img](https://static001.geekbang.org/account/avatar/00/11/eb/82/4b56fa5f.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  rtoday

  试着解析为什么99.99% 如果有误还望高手指正与指导 不论是依赖tracker，还是分布式哈希算法，p2p开宗明义就是要减轻server压力，把压力转嫁给client。 99.99%的定义，是最后校验出了错误，漏失某个文件。 而为什么会漏失呢？还是p2p开宗明义说的，把压力转嫁给client，当client流量压力过大而下线了，其他人就无法找到这个文件了，顶多DHT网络告诉每个client，漏失的文件在某个下线的人手上。你们就乖乖等他上线，并且把手上的99.99%分享给其他新来的new node吧。 为了解决这个问题，最早应该是迅雷，提供了p2sp，长效种子，让server也有义务承担一些压力。 至于迅雷为什么也会99.99%，应该是更进阶的技术问题了。比如下载网站专门防止迅雷盗链。你有张良计，我有过墙梯。

  2018-07-17

  **2

  **97

- ![img](%E7%AC%AC17%E8%AE%B2%20_%20P2P%E5%8D%8F%E8%AE%AE%EF%BC%9A%E6%88%91%E4%B8%8B%E5%B0%8F%E7%94%B5%E5%BD%B1%EF%BC%8C99%25%E6%80%A5%E6%AD%BB%E4%BD%A0.resource/132.jpeg)

  方圆佰李

  Node new想下载文件1，但它本身并没有文件1，那是通过什么计算出文件1的哈希值的？

  2018-06-28

  **5

  **26

- ![img](%E7%AC%AC17%E8%AE%B2%20_%20P2P%E5%8D%8F%E8%AE%AE%EF%BC%9A%E6%88%91%E4%B8%8B%E5%B0%8F%E7%94%B5%E5%BD%B1%EF%BC%8C99%25%E6%80%A5%E6%AD%BB%E4%BD%A0.resource/resize,m_fill,h_34,w_34-1662307686408-7565.jpeg)

  月饼

  P2P网络是怎么解决局域网穿透的？upnp吗？

  2018-06-28

  **

  **22

- ![img](https://static001.geekbang.org/account/avatar/00/11/60/16/d1dd4972.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  ismind

  刘老师，您好，我们都付费买了课程，肯定是想学好的，为什么不发不出来呢？那样的话，真的非常感谢您了。

  作者回复: 运营策划的活动，哈哈

  2018-06-26

  **

  **22

- ![img](https://static001.geekbang.org/account/avatar/00/11/9e/80/b87f8b49.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  LongXiaJun

  哈哈哈，想要网络协议知识图谱~

  2018-06-25

  **

  **16

- ![img](https://static001.geekbang.org/account/avatar/00/10/09/42/1f762b72.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  Hurt

  看一两遍是不够了 得看三四遍

  2018-06-26

  **

  **9

- ![img](https://static001.geekbang.org/account/avatar/00/11/93/5d/91f1d849.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  darren

  这就是种子过久了失效的原因吗？

  作者回复: 所有服务器都停了，也就下载不到了

  2019-06-27

  **

  **7

- ![img](https://static001.geekbang.org/account/avatar/00/15/22/f4/9fd6f8f0.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  核桃

  关于DHT算法还有一个著名的应用glusterfs，作为几大分布式文件系统之一，目前生产环境正在使用，dht算法对于并发写入非常不友好的，同时因为考虑文件安全性使用冗余码，例如8+2，那么如果是20个节点的集群，当数据规模上来以后，每个节点几乎都会保存很多元信息，通信量就太大了

  2020-12-25

  **

  **7

- ![img](https://static001.geekbang.org/account/avatar/00/10/e4/29/07400492.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  bochs

  这一节好多算法！己经迷路了我！

  2018-06-27

  **

  **5

- ![img](https://static001.geekbang.org/account/avatar/00/10/5e/2b/df3983e2.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  朱显杰

  还是没有回答99%的问题呢

  2018-06-26

  **

  **5

- ![img](https://static001.geekbang.org/account/avatar/00/10/2f/25/d2162fce.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  龚极客

  思考题1，调用域名解析库解析出ip,或者本地hosts文件 思考题2，区块链数字货币 疑问，标题为啥老是卡在99%没说啊喂，不会那么巧每次node下线吧，我看还是显示有流量在下载就是没完成啊。

  作者回复: 这个。。。标题党，我以为不会有人纠结

  2018-06-25

  **

  **5

- ![img](https://static001.geekbang.org/account/avatar/00/10/2a/15/1708b35c.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  不想学习

  每个都是客户端，没有固定公网ip，怎么互相连接上？这块貌似没讲清楚啊

  2018-08-04

  **2

  **4

- ![img](https://static001.geekbang.org/account/avatar/00/10/58/39/1af79bd5.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  soga

  新加入dht网络的节点最开始没有任何其他节点的信息吧？要怎么启动？是会默认给一两个节点做初始的已知网络节点吗？如果是的话，这些初始节点怎么得到？

  作者回复: 种子里面有

  2018-07-05

  **

  **4

- ![img](https://static001.geekbang.org/account/avatar/00/0f/b7/34/e38f5ff5.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  winlans

  第二是DNS吧，每次域名请求都会先查找本地hosts文件，如果没有匹配的就会去请求dns服务换取ip。这也是有时候dns配置错误，会导致QQ正常，网页却打不开的奇怪现象。

  2018-06-25

  **

  **4

- ![img](data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QN5aHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjI2MTlEODM3NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjI2MTlEODM2NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OTYyRTNCMDNBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OTYyRTNCMDRBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRm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)

  起风了001

  这章跳过去了. 算法用文字描述太难看懂, 而且这个协议专业性比较强, 如果不是专门做p2p的感觉可以先跳过, 以后有时间再回头看

  作者回复: 可以呀

  2019-05-22

  **

  **2

- ![img](https://static001.geekbang.org/account/avatar/00/12/0f/71/9273e8a4.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  时间是最真的答案

  迅雷下载是不是使用的P2P协议？

  作者回复: 是的

  2019-04-09

  **

  **3

- ![img](https://static001.geekbang.org/account/avatar/00/11/c2/2e/e25b62e7.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  风车车

  思考题老师也没讲解，看评论只有赞，没有对评论内容进行对错 纠正。

  作者回复: 每周三篇文章，压力太大，来不急讲，后面会补上

  2018-07-16

  **

  **2

- ![img](https://static001.geekbang.org/account/avatar/00/11/41/bc/13de31c5.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  羽毛

  求图谱 新 node怎样加入网络？

  2018-06-26

  **

  **2

- ![img](https://static001.geekbang.org/account/avatar/00/10/01/05/9b9503cb.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  太多的借口

  本地host文件与dns查询

  2018-06-26

  **

  **2

- ![img](https://static001.geekbang.org/account/avatar/00/11/4f/08/d3421893.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  海昌

  思考题二：默认应该先到本地的hosts文件找下，再到dns吧

  2018-06-26

  **

  **2

- ![img](https://static001.geekbang.org/account/avatar/00/10/09/42/1f762b72.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  Hurt

  快播 以前的方式 是不是这样的啊

  2018-06-25

  **

  **2

- ![img](https://static001.geekbang.org/account/avatar/00/14/38/c8/972a5024.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  凉凉

  Node new 从哪获取文件1的种子文件的？

  作者回复: 你如果是一个bt客户端，你肯定有种子，要不下载啥

  2019-02-13

  **

  **1

- ![img](https://static001.geekbang.org/account/avatar/00/12/28/8f/d3fe98f4.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  达

  一致性哈希的另一种描述，老师讲解得很生动

  2018-10-29

  **1

  **1

- ![img](https://static001.geekbang.org/account/avatar/00/12/ae/36/680dad56.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  赵梅

  同问，Node new想下载文件1，但它本身并没有文件1，那是通过什么计算出文件1的哈希值的？

  作者回复: 种子里面有

  2018-09-27

  **

  **1

- ![img](https://static001.geekbang.org/account/avatar/00/11/67/95/5bd8911f.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  kevinwang527

  老师的每篇文章我都会看三遍，虽然有些文章没有留言，那是因为平常用的比较少。我们现在做的游戏就是分布式的，然后，用hash来算出每个节点的位置。因为游戏服务器的节点一般都有状态的，所以要保证hash值的一致。这里面算距离的方法很值得借鉴。 第二个问题 DNS

  2018-07-28

  **

  **1

- ![img](https://static001.geekbang.org/account/avatar/00/10/09/42/1f762b72.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  Hurt

  我也想要网络的图解

  2018-06-25

  **

  **1

- ![img](data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QN5aHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjI2MTlEODM3NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjI2MTlEODM2NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OTYyRTNCMDNBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OTYyRTNCMDRBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRm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)

  网络已断开

  老师，在dht网络中如何办法保证一个文件哈希值能找到一个node的哈希与之对应；或者只是找相似，找临近？

  2018-06-25

  **

  **1

- ![img](https://static001.geekbang.org/account/avatar/00/11/1f/89/de5b1fab.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  言志

  回答问题： 1、有应用在区块链网络上。 2、域名映射IP通过DNS查询获得。

  2018-06-25

  **

  **1

- ![img](https://static001.geekbang.org/account/avatar/00/2e/27/b4/df65c0f7.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)![img](https://static001.geekbang.org/resource/image/eb/56/eb5afbf568af2917033e5a860de0b756.png?x-oss-process=image/resize,w_14)

  | ~浑蛋~![img](https://static001.geekbang.org/resource/image/8a/95/8ac15yy848f71919ef784a1c9065e495.png)

  问题1：没看明白问题啥意思😂 问题2：dns协议 .torrent文件去哪找

  2022-06-27

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/1b/d0/0d/752ff95f.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  justorez

  关于 99% 的问题，来自比特彗星的解答： 1. torrent文件发布时间较早，已经没有完整的BT种子可供下载了，BT任务健康度小于100%。这种情况下除非有人补种，或有人提供长效种子上传，或在emule插件里能够找到相同文件继续下载，否则永远无法完成。不过对于视频文件而言，差一点点数据基本不会影响正常播放了。 2. BT任务里除了有视频文件外还有一些很小的图片或文本文件，视频文件已经通过长效种子很快下载完成了，图片等小文件没有长效种子源，下载很慢。这种情况可以选择不下载图片等小文件。 3. 早期BitComet软件的bug。对于相邻文件边界处的分块，早期BitComet软件可能会由于下载到错误数据而反复重新下载，造成长时间无法完成。对这种情况首先推荐升级到最新版BitComet。对旧版BitComet可以尝试先停止任务后再重新启动任务，也能提高快速下载完成的几率。

  2022-05-29

  **

  **

- ![img](https://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEJW8PREFPamKa8z1fgiaGib83l1IV6grtSxESQz832BACELvB8pDoz9icGuU4R3lbwlulzHH0L1RokZQ/132)

  林克盛

  想到了git和svn的关系

  2022-04-02

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/18/fe/2d/e23fc6ee.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  深水蓝

  “每个 DHT node 不会有全局的知识”，那这个 DHT 的第1个节点是是怎么知道所有的信息的呢？

  2022-02-01

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/10/0c/0f/93d1c8eb.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  mickey

  DHT有点像OSPF、RIP。

  2021-11-20

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/10/50/4d/db91e218.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)![img](https://static001.geekbang.org/resource/image/eb/56/eb5afbf568af2917033e5a860de0b756.png?x-oss-process=image/resize,w_14)

  sam700000

  当年用emule的各种二次改版下资源，就知道了这个去中心化的kad网络，不过它还带了个ed2k，那时候用的是xtreme和scarangel，2006年的时候吧，还在上高中，那时候感觉这个东西真的好酷，还自带IRC聊天室，还为了独立ip的highIP打电话给电信，现在也还能用，只是网络里的人少了，kad搜不到啥了，那时候经常看别人的共享资源来着，还有vagga和迅雷那类都算是吸血骡，还有veryCD也没了，时间好快

  2021-10-13

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/23/fe/e0/5b0db40e.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  小然

  启动BT软件就加入了网络吗？还是开始下载的时候加入？

  2021-09-08

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/29/80/48/6fe342fa.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  吃点啥

  学习

  2021-07-30

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/10/5e/e0/e45b7839.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  赵亮

  哈希的碰撞概率不是很低么？为啥文件的哈希能和某个node一样？

  2021-06-05

  **

  **

- ![img](http://thirdwx.qlogo.cn/mmopen/vi_32/6cyOoRd2dROgiblAJkW6RLhUyH1wwU0NNibIIuV930eQ9TiaNT41K61kBSVkvYoDYg7mJtuEoCQY1awBmV0WW6BFg/132)

  大方方

  那个百分之99卡住 很有可能是下载软件自动过滤掉了一些小的说明文件或者附带的无用文件，比如广告图片或者txt之类，导致原始链接下线后 这部分几十K的文件在网络上集体丢失。

  2021-05-03

  **

  **

- ![img](http://thirdwx.qlogo.cn/mmopen/vi_32/6cyOoRd2dROgiblAJkW6RLhUyH1wwU0NNibIIuV930eQ9TiaNT41K61kBSVkvYoDYg7mJtuEoCQY1awBmV0WW6BFg/132)

  大方方

  加入DHT网络后 可以通过询问网络里的人更新联系地址， 那么种子初始的地址列表是怎么规划确定的呢？另外， 假设种子列表里只有10个地址 ，四五年后 这10个地址都不可用了， 整个DHT网络是不是就丢了？ 是不是要定期制作新的种子以维护DHT网络的下载入口？ 

  2021-05-03

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/21/f8/2b/339660f1.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)![img](https://static001.geekbang.org/resource/image/eb/56/eb5afbf568af2917033e5a860de0b756.png?x-oss-process=image/resize,w_14)

  Wangyf

  介....我看到这一节的标题，干净点进来看看为嘛卡在99%，因为我这几天真就是经常，剩不到1M了，速度变成0了，结果....结果怎么没个解释啊😓😓

  2021-04-02

  **

  **

- ![img](https://thirdwx.qlogo.cn/mmopen/vi_32/ia5NFICdEuzaQ8Vib0depvkB6UmxPBFib51aClSJYfCIa7tn2nXauddwxDvbxYuQ9UeRGVICLfTtDJysnDJ5EfQcg/132)

  Geek_8866d4

  根据DHT的ID,而没有ip地址，怎么链接其他的peer呢

  2021-03-23

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/1b/a9/b0/0c701ef3.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  吃鱼

  “DHT node 的 ID 是和哈希值相同长度的串”这句话的意思就是只是长度相同内容不相同， 举例文件哈希值为abc node 的 ID值为 bcd 他们的长度相等都是3 但是根据下文的意思 好像不只是长度相同，内容也相同。纠结了半天

  2021-02-02

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/24/19/6e/6c6fbea8.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  choice

  1、DHT node中保存的信息有： （1）自己下载过的文件 （2）文件哈希值和自己ID接近的文件索引 （3）保存一部分其他node的联系信息，按距离分层保存 2、计算文件哈希值知道哪些node保存有要下载文件的索引，比如是node C，如果torrent文件中没有node C的地址，只能通过torrent文件中已知的node地址来**查找**node C，如果没有node C或者不可用，就寻找ID接近的node得到文件索引，从而知道去哪个node下载文件。

  2021-02-01

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/19/eb/67/840e4179.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  薯拾

  “PING 一下列表最上面，也即最旧的一个节点。如果 PING 通了，将旧节点挪到列表最底，并丢弃新节点，老朋友还是留一下”前面提到是按照联系时间倒序排列，那么列表最上面应该是最新的一个节点呀？这里描述是不是有点问题

  2020-11-26

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/10/e9/e8/31df61df.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  军秋

  去中心化的分布式哈希算法，这不是git的存储策略吗？

  2020-11-07

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/10/45/8c/f3fa78f0.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  韦

  如果id是随机的，那么就是列表里存了id和ip的映射关系吧

  2020-07-29

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/17/0c/5f/4cbcbfb9.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  hello

  一个新来的节点怎么加入这个社交网络呢？通过什么方法认识到第一个网络中的人？

  2020-06-30

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/12/d6/39/6b45878d.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  意无尽

  不晓得为啥，看了这个后，觉得用种子下载很不安全啊，P2P 的下载方式，虽然是快了，但是别人也可以从你这里下载😳。

  作者回复: 是呀，互惠互利

  2020-06-07

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/19/01/4b/a276c1d0.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  儘管如此世界依然美麗

  第一个问题就不是很清楚了，如果老师方便的话，可以解答一下吗？【redis的集群算不算？】 第二个问题是：通过DNS协议。或者通过修改本机的hosts，来添加映射

  2020-05-17

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/12/41/af/4307867a.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  JJj

  1、tracker模式下怎么就近找peer？因为要去它那下载文件。 2、文件的哈希是针对文件名吧

  2020-05-09

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/12/e1/df/6e6a4c6b.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  kevin

  请教老师两个问题 1.在dht中，结点和文件的hash值算出来有可能是都不一样的，那他们怎么对应起来？ 2. 为什么不把相同hash的文件放在当前结点？那不是可以省去找相邻结点的麻烦？

  2020-05-04

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/19/d9/ff/b23018a6.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  Heaven

  首先是第二个问题,对于域名和Ip的解析,肯定是DNS在工作,同样DNS和P2P类似,都是自己维护了一个DNS列表,如果没有其分布式上的本地DNS请求,然后依次的查询

  2020-05-02

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/0f/de/3c/b1fe1f52.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)![img](https://static001.geekbang.org/resource/image/eb/56/eb5afbf568af2917033e5a860de0b756.png?x-oss-process=image/resize,w_14)

  wsjx

  p2p协议数据包有特定格式吗，抓包每次都不一样

  2020-03-29

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/13/6a/01/d9cb531d.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)![img](https://static001.geekbang.org/resource/image/eb/56/eb5afbf568af2917033e5a860de0b756.png?x-oss-process=image/resize,w_14)

  这得从我捡到一个鼠标垫开始说起

  p2p越来越不好用了

  2020-03-29

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/1d/39/f9/b946719a.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  King-ZJ

  这一节讲的也是生活中常用的下载文件操作，从HTTP或FTP下载到P2P下载，前进的方向也是以速度为原则。在P2P中，第一个是元数据为中心化的，数据是分布式的，缺点是元数据服务器是整个下载速度的瓶颈；为了更快地下载速度，元数据和数据都设计成分布式，通过DHT来实现，其中细节还是很复杂的，通过老师的比喻，还是更接近这个知识一点了。

  2020-03-23

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/14/8d/c5/898b13b4.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  亢（知行合一的路上）

  P2P 协议促使大家一起分享，都是贡献者也是受益者，只要达到一定的规模，个人来去自由，网络稳定存在。 算法尽可能让大家互补，几个节点组合出一个完整的文件，另外几个节点又能完整组合出来，不依赖某一个节点。

  2020-03-17

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/0f/f2/13/3ee5a9b4.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  chenzesam

  原来是这样的P2P

  2020-03-17

  **

  **

- ![img](https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLVZRHorm7z67yJxOCpYWJESPfhia00RDg4oicvPuyCwTKln2BFRMiahOKz9z22RnnEmickA64bHdB7pA/132)

  土豆小小

  如果中途有设备下线，是不是重新找最近的资源点，然后交换资源信息，根据片段来继续下载

  2020-03-09

  **

  **

- ![img](data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QN5aHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjI2MTlEODM3NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjI2MTlEODM2NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OTYyRTNCMDNBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OTYyRTNCMDRBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7/7gAOQWRvYmUAZMAAAAAB/9sAhAABAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAgICAgICAgICAgIDAwMDAwMDAwMDAQEBAQEBAQIBAQICAgECAgMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwP/wAARCADuAO4DAREAAhEBAxEB/8QAfAABAAICAwEBAAAAAAAAAAAAAAYHBAgBAwUCCgEBAAAAAAAAAAAAAAAAAAAAABAAAgIBAgIECwQJBQAAAAAAAAECAwQRBSEGMWESF0FRgVITk+MUVJTUIkJiB5EyhBVFhbXFNnFygqJTEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwD9vAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGHmbhg7fD0mbl4+LF69l32wrctPBCMmpTfUk2BG7ue+Wqm4rNsua6XTi5DWvVKyutPyaoDmnnrlq19l506W9NPTYuSk2/xQqnGPlaQElxM7Dzq/S4WVj5VfhlRbC1Rfil2G3GXU9GBlAAAAAAAAAAAAAAAAAAAAAAAAAAAA4bUU5SajGKblJtJJJattvgkkBVHMnP8AJSswtilHSLcLdxcVLV9DWHCWsdF/6ST1+6uiQFW35F+VbK/Jutvum9Z23WSssk/xTm3JgdIADvx8nIxLY34t9uPdD9W2myVc1412otPR6cV0MC1uWufvTTrwd8cITlpCrcYpQhKT4KOXBaQrbf346R8aXFgWmnrxXFPimvCAAAAAAAAAAAAAAAAAAAAAAAAAAFUfmBzHKLexYVjjrGMtxsg+LU12oYia6E4tSn400vOQFTAAAAAAAuDkDmSWRFbHm2OVtUHLb7ZvWU6oLWeK2+LdMV2ofgTX3UBaAAAAAAAAAAAAAAAAAAAAAAAABi52XDAwsvNs4wxce6+S10cvRQlNQX4ptaLrYGr+RfblX3ZN8nO7Itsutk/vWWSc5Pq4sDpAAAAAABlYWXbgZeNmUPS3Guruhx0TcJJ9mWnTGa4NeFMDaDGvrysejJqeteRTVfW/HC2EbI/9ZAdwAAAAAAAAAAAAAAAAAAAAAACJc8WurlncOzwdrxateqeVT2v0wTXlA18AAAAAAAAAbFcnXSu5a2mcnq402U/8cfJuoivJGtASYAAAAAAAAAAAAAAAAAAAAAABFOdqXdyzuSjxlWse7yVZVMp/or1YGvQAAAAAAAADY3lGiWPy3tNclo5Yzv8AF9nJusyYvyxtQEjAAAAAAAAAAAAAAAAAAAAAAAdGVj15eNkYty1qyaLaLF4exbCVctOvSXADWDNxLsDLycLIj2bsa6dM/E3B6KUfHCa0afhTAxQAAAAAAZ224Nu55+LgUp+kyboV6pa9iDetljXm1VpyfUgNnqaoUU1UVLs101wqrj4oVxUILyRQHYAAAAAAAAAAAAAAAAAAAAAAAAVrz5yzPNh++cGtzyaK1HNpgtZX0QX2bopcZW0R4NdLhp5ujCmQAAAAAAXbyLyzPbaXumdW4ZuVX2aKprSWNjS0bck+Mbr9FqumMeHS2gLDAAAAAAAAAAAAAAAAAAAAAAAAAACuOZOQ6c+dmbtDrxcubc7cWX2cbIm+LlW0n7vbLw8OxJ+bxbCpM7bM/bLXVn4l+NPVpekg1CenhrsWtdseuLaAwQAHo7ftO47raqsDEuyZapSlCOlVevhtul2aql/uaAt3lrkWjbJ15u5yry86Gk6qYrXFxpripfaSd90X0NpRi+hNpSAsIAAAAAAAAAAAAAAAAAAAAAAAAAAAAD4sqrug67a4W1y/WhZCM4P/AFjJNMDw7eVuXrm5T2jCTfT6Kr0C49VLrQHNPK/L1ElKvaMJtcU7alfo/Gle7FqB7cK4VQVdcIVwitIwhFQhFeJRikkgPsAAAAAAAAAAAAAAAAAAAAAAAAAY2XmYuBRPKzL68aiv9ay2XZjq+iKXTKcvBFJt+BARGf5g8uRk4q3LsSeinDFkoy60pyhPR9aQHz3h8u+dm/K+0Ad4fLvnZvyvtAHeHy752b8r7QB3h8u+dm/K+0Ad4fLvnZvyvtAHeHy752b8r7QB3h8u+dm/K+0Ad4fLvnZvyvtAMjG575cybY1PKtxnJpRnk0Trq1fglZHtxrXXLRLxgTCMozjGUZKUZJSjKLTjKLWqlFrVNNPgwOQAAAAAAAAAAAAAAAAAAAAUZ+YW43ZG9ywHOSx9vqpUa9fsu7IphkTta8MnCyMepLrYECAAAAAAAAAAAF0/lxuN2Tt+Zg2zlOO320uhyerhTlK1qpPzYWUSa8Xa06NALHAAAAAAAAAAAAAAAAAAAABr3zx/lO6fsX9OxAImAAAAAAAAAAALY/K/+Ofyz+4AWwAAAAAAAAAAAAAAAAAAAADXvnj/ACndP2L+nYgETAAAAAAAAAAAFsflf/HP5Z/cALYAAAAAAAAAAAAAAAAAAAABVvMfJG7bxvOZuONkbdCjI937Eb7cmNq9DiUUS7Ua8S2C1nU2tJPgB4fdrvvxe0+vzPoAHdrvvxe0+vzPoAHdrvvxe0+vzPoAHdrvvxe0+vzPoAHdrvvxe0+vzPoAHdrvvxe0+vzPoAHdrvvxe0+vzPoAHdrvvxe0+vzPoAHdrvvxe0+vzPoAHdrvvxe0+vzPoAJvyby1ncvfvH323Et989z9F7rZdPs+7+9dvt+loo019OtNNfD0ATcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//Z)

  99%卡住的原因是什么呢，似乎没讲

  2020-03-05

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/15/7a/32/27a8572a.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  渣渣

  第一个问题，就近原则或者多备可以吗，就近原则，如果tracker中心服务器挂了，就找一台最近的，多备就是如果tracker中心服务器挂了，启用备用的服务器。 第二个问题，域名到IP的解析是通过DNS。

  2020-02-26

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/0f/8f/8b/9080f1fa.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  猫头鹰波波

  请教一下，P2P是在应用层级别的协议么，下层是基于UDP么

  2020-02-02

  **

  **

- ![img](http://thirdwx.qlogo.cn/mmopen/vi_32/fBOybgVTWXYXxaicaVEysXCjkKT13dX7icAj96KibJ815mia1FvYro9KcbA3xtwnIxmPJ38Vt6rmg6vp0auGKel93A/132)

  Geek_d26e63

  k-bucket 2从倒数第二位开始不同？01000 和 01001不是最后一位不同吗

  2020-01-19

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/11/d4/44/0ec958f4.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  Eleven

  如果一个节点的 ID，前面所有位数都相同，从倒数第 2 位开始不同，这样的节点只有 2 个，即 01000 和 01001，与基础节点的异或值为 00010 和 00011，即距离范围为 2 和 3；对于 01010 而言，这样的节点归为“k-bucket 2”。 刘超老师你好，从倒数第二位开始不同，对于01010来说不是有00011，00000，00001这3个么？为什么文中说只有2个？

  2020-01-15

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/11/b3/92/6a20da3f.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)![img](https://static001.geekbang.org/resource/image/eb/56/eb5afbf568af2917033e5a860de0b756.png?x-oss-process=image/resize,w_14)

  OneDy

  似乎参考了不少wiki上的信息，看到上面还提到了： 1.节点间使用UDP进行通信；通过文件ID值可以锁定文件hash值或者关键字（keywords）.文件名称搜索可以通过关键字查询，而每一个关键字以哈希值的形式存在网络内，根据关键字对k临近多个节点查询  2.节点信息中包含RTT(往返时间)，当一个查询超时时，启动下一个查询；对于热点查询，检索器将信息存储在k临近节点上，减小中心节点负载 3.节点的添加最初需要经过引导，在这个过程里可以知道另一个节点的ip和端口，并计算一个唯一且随机的ID

  2019-11-30

  **

  **

- ![img](http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epZhOmpZpicOzalVU7kibd59dMJc25N9cfGu9icBAIUPzYNYDedtzlYHZBiazaYiadgqvlotrjM4CA6KOQ/132)

  Geek_ty

  本文对p2p的DHT部分kAD算法的讲解颇为细致了，至于整体的P2P下载其实欠缺还挺多的，好多地方没有提到

  2019-11-28

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/14/24/18/8edc6b97.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  Roger

  老师，在DHT网络是如何查找朋友的中，当A在自己的k-bucket 5中没有找到B时，随便找一个C，因为C的ID第5位和B的相同，这个地方为什么A、B之间的距离会缩短一半呢？

  2019-09-11

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/14/24/18/8edc6b97.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  Roger

  在DHT网络是如何查找朋友中，当A的k-bucket 5没有B是，随便找一个C，因为C的第5位和B相同，这样只能说明B到C的距离小于2^4，怎么就是A到B的距离变成了2^4？

  2019-09-11

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/15/94/cb/b9254fd7.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  celia

  感觉老师讲的freestyle

  作者回复: 哈哈

  2019-07-02

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/12/e9/29/629d9bb0.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  天王

  P2P协议，1 ftp协议和http协议，都是基于tcp协议，客户端，服务端的模式，1.1ftp协议，有2个连接，一个是控制连接，一个是数据连接，控制连接，是服务端开放21端口，客户端发起连接命令并返回服务器的应答，命令有list，reter，store，数据连接，每当传输文件时需要创建一个数据连接。1.2 ftp有两种工作模式，1.21种是主动模式，一种是被动模式，主动模式是客户端打开端口N向服务端的21端口发起连接，同时开放N+1端口监听，服务端接收到请求，主动向N+1端口连接，然后传输数据1.22 客户端向服务端21端口发起PASV命令，服务端向N端口返回端口P，客户端接收到端口P之后，N+1端口向p端口发起连接，传输数据。2 P2P peer to peer，2.1与传统的客户端服务端模式相比，资源存到多个点上，peer不受服务器带宽影响，建立点对点的连接，只要找到有资源的peer，不去服务器，直接去peer下载，一旦下载了文件，就成了peer的一员，下载的同时，也会上传，其他就近的点也可以从你这儿下载。2.2 .torrent文件 由2部分组成 tracker url和文件信息，文件信息由info文件比如文件目录，文件大小，文件，name字段，它是顶层目录的名字，每个段的大小，.torrent文件会将下载文件分成多个段，分段下载。段哈希值，将各个段拼接起来。2.3 下载的时候，首先解析.torrent文件的tracker url，拿到之后去tracker服务器获取到peer地址，然后和peer进行交换，分别把自己有的和没有的都列出来，只取自己没有的，取到之后对每一个块进行哈希验证，如果一致则使用，不一致也放弃。这种方式非常依赖tracker服务器，他需要收集下载者信息，并提供给peer，tracker服务器一旦瘫痪，整个用不了。3去中心化网络DHT，3.1每个加入的peer，都负责存储网络里的资源信息和其他成成员的联系信息，相当于所有peer构成了一个强大的分布式数据库，DHT的协议kademlia协议，一个Bittorrent启动之后，有2个角色，一个是peer，监听tcp端口，上传和下载文件，一个是DHT node，监听UDP的端口，通过这个角色，加入DHT的网络，一个DHT网络里，每一个DHT Node，都有一个id，每个DHT都保存有一些索引，哪些文件保存在哪个节点上。3.2 哈希值 每个文件都可以计算出一个哈希值，DHT node的id是和哈希值相同的串，算法规定，如果有文件的哈希值和DHT node的id一致，则这个DHT node知道从哪里下载，除了一模一样的DHT node知道，和哈希值接近的N个DHT node也知道，新节点上线，首先加入网络，种子.torrent文件不是tracker url的地址了，而是list的node地址，DHT node只要找到一个node，就加入进DHT网络，new node想访问文件1，计算哈希值c1，找到文件C，会问能访问的节点是否知道文件C，如果不知道再问朋友的朋友节点，总有知道的，返回文件1要找B F E，new node和B进行 peer to peer的连接，同时下载文件1之后，也会加入到文件1的列表，可以被其他列表下载，同时，new node的哈希值相近的，文件索引也能存某些文件的下载地址。node id和哈希值160bits20个字节大小，相近指的是异或值，跟距离远近没关系，DHT是按照层来维护的，字节位数差最后一位的在第一层，差倒数第二位的在第二层，越到外层，节点越多。3.3DHT的朋友圈如何查找，首先通过异或，找到异或值，找到最高位，如果是第五位，则去第五层找，kademlia是通过折半查找的方式找节点，时间复杂度logN。Kademlia的四个指令，ping，STORE，FIND_NODE，FIND_VALUE，3.4 朋友圈的更新 执行上面的4个命令都会更新，最近联系的放在最近联系的位置，如果朋友圈满了，则把最老的ping下，ping通则丢弃最新的，ping 不通则丢弃老的。

  2019-06-19

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/16/9f/64/a0a0904d.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  cheetah

  看晕了，继续加油

  2019-06-05

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/10/65/03/973b24ec.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  谢晋

   老师这节课程把p2p的网络原理，讲解的非常透彻，很过瘾。ipfs等分布式云存储技术也是基于p2p协议。 老师思考提：域名通过DNS解析，然后换成本地地址？找到对应本地端口吗

  2019-05-12

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/11/22/e8/8e154de6.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  圆嗝嗝

  如何从网络中下载一个文件？ 最简单的方式是通过HTTP/FTP从服务器端下载。但是这两种方式受制于单一服务器的带宽压力。 为解决这个问题，P2P出现了，它将资源分散地存储在多台设备上。 P2P有两种处理方式： · 种子文件：BT客户端解析.torrent文件得到tracker服务器地址，tracker服务器将其他下载者的IP提供给下载者，交换双方数据。但是并不是完全去中心化的，tracker服务器为中心服务器，一旦失效，BT工具就无法正常工作。 · 分布式哈希表的去中心化网络：下载内容以及提供下载内容的IP地址等信息分散存储在多台设备上，每台设备都没有整个网络的信息。

  2019-04-26

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/16/b6/24/187c7005.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  Lhyy

  Gossip 算法和这个DHT很像

  2019-04-14

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/15/2f/bf/85b957fc.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  咕咕咕

  卡在99% 我觉得是要把最后一块块数据 组装成完整的文件吧

  2019-04-10

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/0f/ed/3b/daa0ff2d.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)![img](https://static001.geekbang.org/resource/image/eb/56/eb5afbf568af2917033e5a860de0b756.png?x-oss-process=image/resize,w_14)

  千岁寒

  写的非常不错，很短的文章讲清楚了P2P的发展脉络和实现原理，核心的思想还是使用了分布式的架构代替了集中式的架构，但是协议中的诸多细节还是需要深入了解。，刘超老师能不能提供一些这方面的资料。非常感谢

  2019-03-31

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/13/27/40/ae886719.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  geekYang

  .torrent 文件从哪里获取呢？

  作者回复: 哈哈哈，我也想知道，搜索番号？

  2019-03-06

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/10/1c/e8/39a3777f.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  红猪

  以太坊底层用的就是这个，老师是否有机会讲讲gossip

  2019-02-22

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/13/2b/ec/af6d0b10.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  caohuan

  http 下载大文件 很慢 很卡，因为访问服务器，服务器资源有限，被多个客户端访问，所以给予的下载资源相对较少。 p2p 不需要通过服务器传输资源，它是peer to peer的方式，它既包括上传也包含下载的资源。 分布式哈希值为文件的对应值。

  2019-02-20

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/13/2b/ec/af6d0b10.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  caohuan

  本篇所得：1.我们在用网时，经常需要下载一些 文件和 安装包、资源，所以 下载一般会用到 http和 FTP的方式，但是http和FTP都是集中式下载，多个客户端 同时在 同一个服务器上下载，会加大 服务器的压力，并且 因为 服务器 和宽带的资源有限，所以下载的速度可能会很慢很卡;2.为解决 下载速度和卡顿，降低服务器的压力，可以采用 P2P的下载方式，它为 非集中 分布式的下载方式，它有二种方法 2.1.依赖于tracker服务器中心化网络，它为元数据集中，文件数据分散，可以在客户端间相互传送 客户请求的数据资源 2.2.基于分布式的哈希算法，它为元数据和文件数据全部分散的方式，也为分布式下载。 回答老师的问题：1.下载除了去中心化分布式 哈希算法，还可以把文件 和资源 上传到 云端，云端为 分布式系统，然后在客户端 快速下载，不知道是否是老师的出题的初衷，不对处 请指正。 2.域名 转化为IP，应该 是 应用相应的算法 指定规则，然后 运用该规则 把 域名转为IP，这只是我的猜测，可能不对，接着听刘老师后面的正确解释。

  2019-02-20

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/13/49/3c/5d54c510.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  静静聆听

  寻址的时候，有个问题，就是如果a通过地址的一半下去找b，他是怎么知道那条线上就有b呢，如果b在另一条线上呢？那是否31，15，7，这样的折半查找就找不到了。

  2018-11-25

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/12/23/25/fe87906a.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)![img](https://static001.geekbang.org/resource/image/eb/56/eb5afbf568af2917033e5a860de0b756.png?x-oss-process=image/resize,w_14)

  anzaikk

  这一节感觉很难，还在我学了异或运算，不然更看不懂，小白一个

  2018-09-22

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/0f/ae/00/025f37e7.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)![img](https://static001.geekbang.org/resource/image/eb/56/eb5afbf568af2917033e5a860de0b756.png?x-oss-process=image/resize,w_14)

  xuery

  DHT理解：当某个新的节点X加入DHT网络时，想要下载文件1，先计算出文件1的hash值-->得到存储它在哪些节点信息的节点id，假设为节点Y（当然也可能是取与Y相近的节点）-->X根据Y节点的id开始查找Y（采用K-bucket 二分查找算法）-->找到节点Y，从节点Y中查找存储文件1的节点列表，选择其中一个节点Z-->节点X与节点Z建立peer连接，开始下载文件1

  2018-09-14

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/0f/57/48/3da605c6.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  July

  在DHT网络中，node节点之间的查找是通过UDP协议吗？

  2018-08-30

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/10/21/20/1299e137.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)![img](https://static001.geekbang.org/resource/image/eb/56/eb5afbf568af2917033e5a860de0b756.png?x-oss-process=image/resize,w_14)

  秋天

  这一节分布式去中心节点的方法讲解，一头雾水，没有接触过，能给推荐本协议的书再去了解一下吗？？？？不胜感激

  2018-08-15

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/10/a8/1b/ced1d171.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  空档滑行

  有一个问题请教下，节点id是个随机数，那两个节点id重复了怎么办

  2018-08-13

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/10/53/0c/6feb3732.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  kh.

  如果文件hash对应的持有知识的node段中没有命中任何一个设备，这个文件对象要怎么发现？

  2018-08-07

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/11/53/6f/6051e0f1.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  Summer___J

  这节听得太懵了……

  2018-07-09

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/10/09/42/1f762b72.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  Hurt

  想问一下老师 百度云 这种存储和传输的方式 大致什么样的啊

  2018-07-05

  **1

  **

- ![img](https://static001.geekbang.org/account/avatar/00/11/50/1c/26dc1927.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  次郎

  点对点网络，如果都在路由器后边，怎么进行发现喝通信？

  2018-07-02

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/11/45/be/494010aa.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  zcpromising

  老师，问题一应用在区块链领域，问题二是dns

  2018-07-02

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/11/23/5b/983408b9.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)![img](https://static001.geekbang.org/resource/image/eb/56/eb5afbf568af2917033e5a860de0b756.png?x-oss-process=image/resize,w_14)

  悟空聊架构

  DNS域名解析

  2018-06-29

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/10/27/d5/0fd21753.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  一粟

  求图谱，卡99%是故意的吧，让你买会员😁

  2018-06-29

  **

  **

- ![img](data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QN5aHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjI2MTlEODM3NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjI2MTlEODM2NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OTYyRTNCMDNBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OTYyRTNCMDRBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRm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)

  小田

  图谱还是发出来吧 大家都能用上，用礼券奖励也足够了吧

  作者回复: 是的是的

  2018-06-28

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/0f/49/e2/1fad12eb.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  张洪阆

  1.分布式哈希的算法可以用于鉴权，只有全部机器都在线才能通过验证。 2.把node id解析成ip，需要类是dns的服务器？是否可以从node id里选出几个用来解析这种映射关系？

  2018-06-28

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/0f/49/e2/1fad12eb.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  张洪阆

  DHT node ID 是索引指针，文件哈希是个目标文件的索引

  2018-06-28

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/0f/bf/bd/0c40979f.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  一周思进

  1、区块链 2、域名对应的ip地址静态不变的，目前都使用基于udp的dns服务进行域名解析，还有httpdns服务同样用于域名解析，ip地址动态变化的，还会结合ddns服务进行域名解析

  2018-06-28

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/10/49/62/25b29ebc.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)![img](https://static001.geekbang.org/resource/image/eb/56/eb5afbf568af2917033e5a860de0b756.png?x-oss-process=image/resize,w_14)

  xxx

  节点地址是公网地址么

  2018-06-27

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/10/49/62/25b29ebc.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)![img](https://static001.geekbang.org/resource/image/eb/56/eb5afbf568af2917033e5a860de0b756.png?x-oss-process=image/resize,w_14)

  xxx

  有个问题哈，节点一般都没有公网ip，种子里的ip是什么地址？

  2018-06-27

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/11/0f/bd/7a9b2a0c.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)![img](https://static001.geekbang.org/resource/image/eb/56/eb5afbf568af2917033e5a860de0b756.png?x-oss-process=image/resize,w_14)

  潇洒的毅小峰

  老师求图谱啊，一个图谱比啥都重要

  2018-06-27

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/10/f6/32/358f9411.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  梦想启动的蜗牛

  老师，是不是同时下载的时候，才把你加入网络，如果你不下载的时候，你有别人需要下载的文件也会从你这下载嘛？

  2018-06-27

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/10/f6/32/358f9411.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  梦想启动的蜗牛

  想要图解😂

  2018-06-27

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/11/69/df/71563d52.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  戴劼 DAI JIE🤪

  那一个全新的DHT软件怎样才能知道节点的ip地址呢？

  2018-06-26

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/0f/8d/a7/1b8cbc80.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  pp

  1.运用在区块链的记账中 2.通过dns查找，先到递归服务器，没有缓存则从根服务器开始到每一层的权威去找

  2018-06-26

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/11/41/bc/13de31c5.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  羽毛

  求图谱  新加入node怎样加入到网络中的？

  2018-06-26

  **

  **

- ![img](http://thirdwx.qlogo.cn/mmopen/vi_32/ZfxPVYFBlAcP2hEpwnaEe4YHvHmveRM8CIYM5cByFJKdSLwh08a26uwvRvCjUuZg7fUIdia6EM6fZ6tsLbjA86Q/132)

  帅窝

  我也想要图谱，您讲的确实是深入浅出

  2018-06-25

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/0f/b4/21/6d31d152.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  日天君

  像Cassandra这种用consistent hashing的哈希环和DHT，FIND_VALUE可以理解成一样的吗 第二问我猜是下讲要DNS了吧🌝

  2018-06-25

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/11/52/e0/ef42c4ce.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  晓.光

  1.区块链2.dns

  2018-06-25

  **

  **

- ![img](http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI6c5giaHqaFj149HoLN5TLjyfrrIeLX3iaf2ebG7lYxeTHeqWiazJicn7U7u9oiaWM24MrCh9YkpV6Kbg/132)

  theta

  以为是占用带宽99％，急死你

  2018-06-25

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/0f/ac/a1/43d83698.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  云学

  我现在很期待如何搭建一个实践平台

  2018-06-25

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/0f/ac/a1/43d83698.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  云学

  请问作者是不是曾经实现过这个协议，讲解如此详细

  2018-06-25

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/11/58/2c/92c7ce3b.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)![img](https://static001.geekbang.org/resource/image/eb/56/eb5afbf568af2917033e5a860de0b756.png?x-oss-process=image/resize,w_14)

  易轻尘

  貌似一致性hash也是去中心化的一种寻找存储节点的方式，也是通过hash值寻找数据在哪个节点上。虽然元数据的存储方式不同，但是思想上还是有共通之处的。

  2018-06-25

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/0f/5c/59/4401c327.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  JerryLuo

  独家网络协议知识图谱 我需要这本 葵花宝典

  2018-06-25

  **

  **

- ![img](data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QN5aHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjI2MTlEODM3NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjI2MTlEODM2NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OTYyRTNCMDNBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OTYyRTNCMDRBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRm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)

  网络已断开

  问题一，区块链的账本同步 问题二，层层dns查找 想要知识图谱

  2018-06-25

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/10/df/4e/f3c4ff45.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  嘉俊

  哈哈，我想要老师整理的独家网络协议知识图谱。

  2018-06-25

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/10/2f/25/d2162fce.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  龚极客

  思考题1，调用域名解析库解析出ip,或者本地hosts文件 思考题2，区块链数字货币

  2018-06-25

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/0f/d1/15/7d47de48.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  咖啡猫口里的咖啡猫🐱

  我能想到的就是数据分片，，hash取膜id得到数据存放那个分片，，，但是是数据均匀很难保证，数据与数据的关联关系分散，导致查询多个分片，性能低下

  2018-06-25

  **

  **

- ![img](https://static001.geekbang.org/account/avatar/00/0f/8b/b5/6e93b07b.jpg?x-oss-process=image/resize,m_fill,h_34,w_34)

  瞬

  问题2，dns协议

  2018-06-25
