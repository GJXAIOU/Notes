# 04 \| 复杂度来源：高性能

周四，我为你讲了架构设计的主要目的是为了解决软件系统复杂度带来的问题。那么从今天开始，我将为你深入分析复杂度的6个来源，先来聊聊复杂度的来源之一高性能。

对性能孜孜不倦的追求是整个人类技术不断发展的根本驱动力。例如计算机，从电子管计算机到晶体管计算机再到集成电路计算机，运算性能从每秒几次提升到每秒几亿次。但伴随性能越来越高，相应的方法和系统复杂度也是越来越高。现代的计算机CPU集成了几亿颗晶体管，逻辑复杂度和制造复杂度相比最初的晶体管计算机，根本不可同日而语。

软件系统也存在同样的现象。最近几十年软件系统性能飞速发展，从最初的计算机只能进行简单的科学计算，到现在Google能够支撑每秒几万次的搜索。与此同时，软件系统规模也从单台计算机扩展到上万台计算机；从最初的单用户单工的字符界面Dos操作系统，到现在的多用户多工的Windows 10图形操作系统。

当然，技术发展带来了性能上的提升，不一定带来复杂度的提升。例如，硬件存储从纸带→磁带→磁盘→SSD，并没有显著带来系统复杂度的增加。因为新技术会逐步淘汰旧技术，这种情况下我们直接用新技术即可，不用担心系统复杂度会随之提升。只有那些并不是用来取代旧技术，而是开辟了一个全新领域的技术，才会给软件系统带来复杂度，因为软件系统在设计的时候就需要在这些技术之间进行判断选择或者组合。就像汽车的发明无法取代火车，飞机的出现也并不能完全取代火车，所以我们在出行的时候，需要考虑选择汽车、火车还是飞机，这个选择的过程就比较复杂了，要考虑价格、时间、速度、舒适度等各种因素。

软件系统中高性能带来的复杂度主要体现在两方面，一方面是**单台计算机内部为了高性能带来的复杂度**；另一方面是**多台计算机集群为了高性能带来的复杂度**。

## 单机复杂度

计算机内部复杂度最关键的地方就是操作系统。计算机性能的发展本质上是由硬件发展驱动的，尤其是CPU的性能发展。著名的“摩尔定律”表明了CPU的处理能力每隔18个月就翻一番；而将硬件性能充分发挥出来的关键就是操作系统，所以操作系统本身其实也是跟随硬件的发展而发展的，操作系统是软件系统的运行环境，操作系统的复杂度直接决定了软件系统的复杂度。

操作系统和性能最相关的就是**进程**和**线程**。最早的计算机其实是没有操作系统的，只有输入、计算和输出功能，用户输入一个指令，计算机完成操作，大部分时候计算机都在等待用户输入指令，这样的处理性能很显然是很低效的，因为人的输入速度是远远比不上计算机的运算速度的。

为了解决手工操作带来的低效，批处理操作系统应运而生。批处理简单来说就是先把要执行的指令预先写下来（写到纸带、磁带、磁盘等），形成一个指令清单，这个指令清单就是我们常说的“任务”，然后将任务交给计算机去执行，批处理操作系统负责读取“任务”中的指令清单并进行处理，计算机执行的过程中无须等待人工手工操作，这样性能就有了很大的提升。

批处理程序大大提升了处理性能，但有一个很明显的缺点：计算机一次只能执行一个任务，如果某个任务需要从I/O设备（例如磁带）读取大量的数据，在I/O操作的过程中，CPU其实是空闲的，而这个空闲时间本来是可以进行其他计算的。

为了进一步提升性能，人们发明了“进程”，用进程来对应一个任务，每个任务都有自己独立的内存空间，进程间互不相关，由操作系统来进行调度。此时的CPU还没有多核和多线程的概念，为了达到多进程并行运行的目的，采取了分时的方式，即把CPU的时间分成很多片段，每个片段只能执行某个进程中的指令。虽然从操作系统和CPU的角度来说还是串行处理的，但是由于CPU的处理速度很快，从用户的角度来看，感觉是多进程在并行处理。

多进程虽然要求每个任务都有独立的内存空间，进程间互不相关，但从用户的角度来看，两个任务之间能够在运行过程中就进行通信，会让任务设计变得更加灵活高效。否则如果两个任务运行过程中不能通信，只能是A任务将结果写到存储，B任务再从存储读取进行处理，不仅效率低，而且任务设计更加复杂。为了解决这个问题，进程间通信的各种方式被设计出来了，包括管道、消息队列、信号量、共享存储等。

多进程让多任务能够并行处理任务，但本身还有缺点，单个进程内部只能串行处理，而实际上很多进程内部的子任务并不要求是严格按照时间顺序来执行的，也需要并行处理。例如，一个餐馆管理进程，排位、点菜、买单、服务员调度等子任务必须能够并行处理，否则就会出现某个客人买单时间比较长（比如说信用卡刷不出来），其他客人都不能点菜的情况。为了解决这个问题，人们又发明了线程，线程是进程内部的子任务，但这些子任务都共享同一份进程数据。为了保证数据的正确性，又发明了互斥锁机制。有了多线程后，操作系统调度的最小单位就变成了线程，而进程变成了操作系统分配资源的最小单位。

多进程多线程虽然让多任务并行处理的性能大大提升，但本质上还是分时系统，并不能做到时间上真正的并行。解决这个问题的方式显而易见，就是让多个CPU能够同时执行计算任务，从而实现真正意义上的多任务并行。目前这样的解决方案有3种：SMP（Symmetric Multi-Processor，对称多处理器结构）、NUMA（Non-Uniform Memory Access，非一致存储访问结构）、MPP（Massive Parallel Processing，海量并行处理结构）。其中SMP是我们最常见的，目前流行的多核处理器就是SMP方案。

操作系统发展到现在，如果我们要完成一个高性能的软件系统，需要考虑如多进程、多线程、进程间通信、多线程并发等技术点，而且这些技术**并不是最新的就是最好的，也不是非此即彼的选择**。在做架构设计的时候，需要花费很大的精力来结合业务进行分析、判断、选择、组合，这个过程同样很复杂。举一个最简单的例子：Nginx可以用多进程也可以用多线程，JBoss采用的是多线程；Redis采用的是单进程，Memcache采用的是多线程，这些系统都实现了高性能，但内部实现差异却很大。

## 集群的复杂度

虽然计算机硬件的性能快速发展，但和业务的发展速度相比，还是小巫见大巫了，尤其是进入互联网时代后，业务的发展速度远远超过了硬件的发展速度。例如：

- 2016年“双11”支付宝每秒峰值达12万笔支付。
- 2017年春节微信红包收发红包每秒达到76万个。

要支持支付和红包这种复杂的业务，单机的性能无论如何是无法支撑的，必须采用机器集群的方式来达到高性能。例如，支付宝和微信这种规模的业务系统，后台系统的机器数量都是万台级别的。

通过大量机器来提升性能，并不仅仅是增加机器这么简单，让多台机器配合起来达到高性能的目的，是一个复杂的任务，我针对常见的几种方式简单分析一下。

1\.任务分配

任务分配的意思是指每台机器都可以处理完整的业务任务，不同的任务分配到不同的机器上执行。

我从最简单的一台服务器变两台服务器开始，来讲任务分配带来的复杂性，整体架构示意图如下。

![](<04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/8ef42bd2536b3f1860f4a879223c2dc0.jpg>)

从图中可以看到，1台服务器演变为2台服务器后，架构上明显要复杂多了，主要体现在：

- 需要增加一个任务分配器，这个分配器可能是硬件网络设备（例如，F5、交换机等），可能是软件网络设备（例如，LVS），也可能是负载均衡软件（例如，Nginx、HAProxy），还可能是自己开发的系统。选择合适的任务分配器也是一件复杂的事情，需要综合考虑性能、成本、可维护性、可用性等各方面的因素。

- 任务分配器和真正的业务服务器之间有连接和交互（即图中任务分配器到业务服务器的连接线），需要选择合适的连接方式，并且对连接进行管理。例如，连接建立、连接检测、连接中断后如何处理等。

- 任务分配器需要增加分配算法。例如，是采用轮询算法，还是按权重分配，又或者按照负载进行分配。如果按照服务器的负载进行分配，则业务服务器还要能够上报自己的状态给任务分配器。

这一大段描述，即使你可能还看不懂，但也应该感受到其中的复杂度了，更何况还要真正去实践和实现。

上面这个架构只是最简单地增加1台业务机器，我们假设单台业务服务器每秒能够处理5000次业务请求，那么这个架构理论上能够支撑10000次请求，实际上的性能一般按照8折计算，大约是8000次左右。

如果我们的性能要求继续提高，假设要求每秒提升到10万次，上面这个架构会出现什么问题呢？是不是将业务服务器增加到25台就可以了呢？显然不是，因为随着性能的增加，任务分配器本身又会成为性能瓶颈，当业务请求达到每秒10万次的时候，单台任务分配器也不够用了，任务分配器本身也需要扩展为多台机器，这时的架构又会演变成这个样子。

![](<04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/ac0e9979025df3dd7b8f6588860a9203.jpg>)

这个架构比2台业务服务器的架构要复杂，主要体现在：

- 任务分配器从1台变成了多台（对应图中的任务分配器1到任务分配器M），这个变化带来的复杂度就是需要将不同的用户分配到不同的任务分配器上（即图中的虚线“用户分配”部分），常见的方法包括DNS轮询、智能DNS、CDN（Content Delivery Network，内容分发网络）、GSLB设备（Global Server Load Balance，全局负载均衡）等。

- 任务分配器和业务服务器的连接从简单的“1对多”（1台任务分配器连接多台业务服务器）变成了“多对多”（多台任务分配器连接多台业务服务器）的网状结构。

- 机器数量从3台扩展到30台（一般任务分配器数量比业务服务器要少，这里我们假设业务服务器为25台，任务分配器为5台），状态管理、故障处理复杂度也大大增加。

上面这两个例子都是以业务处理为例，实际上“任务”涵盖的范围很广，**可以指完整的业务处理，也可以单指某个具体的任务**。例如，“存储”“运算”“缓存”等都可以作为一项任务，因此存储系统、运算系统、缓存系统都可以按照任务分配的方式来搭建架构。此外，“任务分配器”也并不一定只能是物理上存在的机器或者一个独立运行的程序，也可以是嵌入在其他程序中的算法，例如Memcache的集群架构。

<img src="04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/d2c94ac2aedbd4ayy5852d2be77b4081.jpg" style="zoom: 25%;" />

2\.任务分解

通过任务分配的方式，我们能够突破单台机器处理性能的瓶颈，通过增加更多的机器来满足业务的性能需求，但如果业务本身也越来越复杂，单纯只通过任务分配的方式来扩展性能，收益会越来越低。例如，业务简单的时候1台机器扩展到10台机器，性能能够提升8倍（需要扣除机器群带来的部分性能损耗，因此无法达到理论上的10倍那么高），但如果业务越来越复杂，1台机器扩展到10台，性能可能只能提升5倍。造成这种现象的主要原因是业务越来越复杂，单台机器处理的性能会越来越低。为了能够继续提升性能，我们需要采取第二种方式：**任务分解**。

继续以上面“任务分配”中的架构为例，“业务服务器”如果越来越复杂，我们可以将其拆分为更多的组成部分，我以微信的后台架构为例。

<img src="04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/727f995c45cyy1652e135175c0f6b411.jpg" style="zoom:33%;" />

通过上面的架构示意图可以看出，微信后台架构从逻辑上将各个子业务进行了拆分，包括：接入、注册登录、消息、LBS、摇一摇、漂流瓶、其他业务（聊天、视频、朋友圈等）。

通过这种任务分解的方式，能够把原来大一统但复杂的业务系统，拆分成小而简单但需要多个系统配合的业务系统。从业务的角度来看，任务分解既不会减少功能，也不会减少代码量（事实上代码量可能还会增加，因为从代码内部调用改为通过服务器之间的接口调用），那为何通过任务分解就能够提升性能呢？

主要有几方面的因素：

- **简单的系统更加容易做到高性能**

系统的功能越简单，影响性能的点就越少，就更加容易进行有针对性的优化。而系统很复杂的情况下，首先是比较难以找到关键性能点，因为需要考虑和验证的点太多；其次是即使花费很大力气找到了，修改起来也不容易，因为可能将A关键性能点提升了，但却无意中将B点的性能降低了，整个系统的性能不但没有提升，还有可能会下降。

- **可以针对单个任务进行扩展**

当各个逻辑任务分解到独立的子系统后，整个系统的性能瓶颈更加容易发现，而且发现后只需要针对有瓶颈的子系统进行性能优化或者提升，不需要改动整个系统，风险会小很多。以微信的后台架构为例，如果用户数增长太快，注册登录子系统性能出现瓶颈的时候，只需要优化登录注册子系统的性能（可以是代码优化，也可以简单粗暴地加机器），消息逻辑、LBS逻辑等其他子系统完全不需要改动。

既然将一个大一统的系统分解为多个子系统能够提升性能，那是不是划分得越细越好呢？例如，上面的微信后台目前是7个逻辑子系统，如果我们把这7个逻辑子系统再细分，划分为100个逻辑子系统，性能是不是会更高呢？

其实不然，这样做性能不仅不会提升，反而还会下降，最主要的原因是如果系统拆分得太细，为了完成某个业务，系统间的调用次数会呈指数级别上升，而系统间的调用通道目前都是通过网络传输的方式，性能远比系统内的函数调用要低得多。我以一个简单的图示来说明。

<img src="04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/e7f71f230bb525e48ee3d62fa938cef7.jpg" style="zoom:25%;" />

从图中可以看到，当系统拆分2个子系统的时候，用户访问需要1次系统间的请求和1次响应；当系统拆分为4个子系统的时候，系统间的请求次数从1次增长到3次；假如继续拆分下去为100个子系统，为了完成某次用户访问，系统间的请求次数变成了99次。

为了描述简单，我抽象出来一个最简单的模型：假设这些系统采用IP网络连接，理想情况下一次请求和响应在网络上耗费为1ms，业务处理本身耗时为50ms。我们也假设系统拆分对单个业务请求性能没有影响，那么系统拆分为2个子系统的时候，处理一次用户访问耗时为51ms；而系统拆分为100个子系统的时候，处理一次用户访问耗时竟然达到了149ms。

虽然系统拆分可能在某种程度上能提升业务处理性能，但提升性能也是有限的，不可能系统不拆分的时候业务处理耗时为50ms，系统拆分后业务处理耗时只要1ms，因为最终决定业务处理性能的还是业务逻辑本身，业务逻辑本身没有发生大的变化下，理论上的性能是有一个上限的，系统拆分能够让性能逼近这个极限，但无法突破这个极限。因此，任务分解带来的性能收益是有一个度的，并不是任务分解越细越好，而对于架构设计来说，如何把握这个粒度就非常关键了。

## 小结

今天我给你讲了软件系统中高性能带来的复杂度主要体现的两方面，一是单台计算机内部为了高性能带来的复杂度；二是多台计算机集群为了高性能带来的复杂度，希望对你有所帮助。

这就是今天的全部内容，留一道思考题给你吧。你所在的业务体系中，高性能的系统采用的是哪种方式？目前是否有改进和提升的空间？

欢迎你把答案写到留言区，和我一起讨论。相信经过深度思考的回答，也会让你对知识的理解更加深刻。（编辑乱入：精彩的留言有机会获得丰厚福利哦！）

## 精选留言(182)

- 今日心得 1 WHAT 对高性能的理解? 性能是软件的一个重要质量属性。衡量软件性能包括了响应时间、TPS、服务器资源利用率等客观指标，也可以是用户的主观感受（从程序员、业务用户、终端用户/客户不同的视角，可能会得出不同的结论）。 在说性能的时候，有一个概念与之紧密相关—伸缩性，这是两个有区别的概念。性能更多的是衡量软件系统处理一个请求或执行一个任务需要耗费的时间长短；而伸缩性则更加关注软件系统在不影响用户体验的前提下，能够随着请求数量或执行任务数量的增加（减少）而相应地拥有相适应的处理能力。 但是，什么是“高”性能？这可能是一个动态概念，与当前的技术发展状况与业务所处的阶段紧密相关。比如，现在在行业/企业内部认为的高性能，站在5年后来看，未必是高性能。因此，站在架构师、设计师的角度，高性能需要和业务所处的阶段来衡量。高到什么程度才能与当前或可预见的未来业务增长相匹配。一味去追求绝对意义上的高，没有太大的实际意义。因为，伴随性能越来越高，相应的方法和系统复杂度也是越来越高，而这可能会与当前团队的人力、技术、资源等不相匹配。但是什么才合适的高性能了？这可能需要从国、内外的同行业规模相当、比自己强的竞争者、终端用户使用反馈中获取答案并不断迭代发展。 软件系统中高性能带来的复杂度主要体现在两方面，一方面是单台计算机内部为了高性能带来的复杂度；另一方面是多台计算机集群为了高性能带来的复杂度。 2 WHY 为什么需要高性能？ 追求良好的用户体验； 满足业务增长的需要。 3 HOW 如何做好高性能？ 可以从垂直与水平两个维度来考虑。垂直维度主要是针对单台计算机，通过升级软、硬件能力实现性能提升；水平维度则主要针对集群系统，利用合理的任务分配与任务分解实现性能的提升。 垂直维度可包括以下措施： 增大内存减少I/O操作 更换为固态硬盘（SSD）提升I/O访问速度 使用RAID增加I/O吞吐能力 置换服务器获得更多的处理器或分配更多的虚拟核 升级网络接口或增加网络接口 水平维度可包括以下措施： 功能分解：基于功能将系统分解为更小的子系统 多实例副本：同一组件重复部署到多台不同的服务器 数据分割：在每台机器上都只部署一部分数据 垂直维度方案比较适合业务阶段早期和成本可接受的阶段，该方案是提升性能最简单直接的方式，但是受成本与硬件能力天花板的限制。 水平维度方案所带来的好处要在业务发展的后期才能体现出来。起初，该方案会花费更多的硬件成本，另外一方面对技术团队也提出了更高的要求；但是，没有垂直方案的天花板问题。一旦达到一定的业务阶段，水平维度是技术发展的必由之路。因此，作为技术部门，需要提前布局 ，未雨绸缪，不要被业务抛的太远。

  2018-05-05

  **7

  **407

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-16617947524381.jpeg)

  昵称

  大神能否在每篇文章结尾推荐一些相关的书籍，大神领进门，修行还是靠个人

  2018-05-05

  **1

  **399

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-16617947524382.jpeg)![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,w_14.png)

  三军

  面试官: 小伙子，说下进程和线程？ 我:  1， 早期的计算机是没有操作系统的，只有输入，计算，输出。手工输入速度远低于计算机的计算速度。 2， 于是出现了批处理操作系统，通过纸带，磁带等工具预先写入指令，形成一个指令清单（即任务）交给计算机处理。但批处理系统的缺点是只能有一个任务，而且当计算机在进行I/O处理时，CPU是空闲的。 3， 世人发明了进程，一个进程就代表一个任务，多个进程通过分时操作能让用户认为并行操作多任务，进程间的资源是独立单元，但是可以通过介质进行通信。缺点：进程内只进行串行处理，无法很好地分工合作提高处理效率。 4， 于是就有了操作系统调度的最小单元-线程，线程能够使进程内的子任务能够共享进程内的资源，并并行工作，大大提高操作系统的性能。 区别： 线程是任务调度的最小单元，共用进程内的资源。 进程是资源分配的最小单元，与其他进程资源互相独立。

  2018-05-05

  **7

  **187

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-16617947524383.jpeg)

  loveluckystar

  之前我们的系统是all-in的单系统模式，虽然水平扩展了大量机器，但是仍然存在性能问题，比如类似秒杀之类的活动，几乎会在瞬间把整个系统的数据库连接耗尽，导致其他服务发生卡顿甚至不可用；并且全在一个业务系统中，开发部属效率极低，扩展性也存在问题。 于是我们将系统进行了拆分，起初是按照业务拆分成几个核心系统，同时针对不同业务的负载情况进行了合理的水平扩展，整个系统的性能得到了提升，扩展性得到了保证，并且开发部署效率也得到了极大的提高。 但是随着业务的发展，之前的系统拆分不能满足现有业务，同时随着公司很多老员工的离开，之前的架构设计思路没有人清楚，于是就变成了走一步看一步的推进模式，衍生出了各种独立的服务达40个左右，这样系统之间的边界越来越模糊，甚至出现了服务间的循环调用，白白浪费时间。而且一次调用链路过长，发生问题很难定位。 所以我觉得我们的系统就是一个活生生的，没有搞好架构设计的例子，前期是没有设计导致性能瓶颈，后期是过度设计导致系统复杂。

  作者回复: 典型案例，值得好好总结归纳一下

  2018-05-07

  **6

  **92

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-16617947524384.jpeg)![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,w_14.png)

  pavel

  感谢老师回复。我们系统的量，每天学到存储大概有2T，采用mysql和hbase做存储。我们是做网站统计的，类似cnzz。每天接到的pv请求会到十亿次以上。我们使用集群接收，Kafka做消息队列，storm实时消费。统计结果存储在mysql，行为数据等存储在hbase。由于实时性要求以及量大，存储性能实在是一个瓶颈，主从同步滞后也相对严重，现在都已经去掉从库了。针对这种IO场景，而且实时性要求较高，R如何来应对呢？之前有个方案是mysql采取大量的分表分库，总共20台服务器，ssd硬盘，这样是能支持，但是成本还是挺大的，是否有更好的，或者我应该从哪方便去考虑呢？

  作者回复: 1. 压缩 2. 合并：将多个数据合并为一个数据，可以在web端做 3. 采样：统计其实不需要精确值，例如1000000001和1000000002没有区别，可以用采样来推算原始值 你的系统复杂度就是大数据量（规模）和实时性，对结果其实不要求非常精确。

  2018-05-22

  **

  **59

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-16617947524385.jpeg)

  Sean

  架构无处不在，生活中也有很多例子。就比如去快餐厅去吃饭，涉及的任务就有打饭，选菜，付款，找座位。 普通的快餐厅，比如**缘，就是单线程，所有必须排队进行，最原始的系统架构。所以你会发现效率低，通常会拍队列，体验就不好。 而去**王吃饭，进去就有一个引导员(负载均衡)，提前帮你分配座位，发点餐单，而且有多个引导员同时工作(负载均衡集群)，而且各种菜系可以同时进行(并行)。另外一些需要等待的菜，会让你边吃边等(异步)。所以看上去人好多，很少有在排队的现象。可见，这位老板也是位不错的架构师。

  作者回复: 666

  2018-10-16

  **

  **58

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-16617947524386.jpeg)![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,w_14.png)

  gevin

  我这边很多项目都是面向传统行业国企的，他们成熟的传统方案都和IT无关，先现在要向IT靠拢。通常用户那边的业务量、并发量小，企业不差钱，所以一般都是通过硬件层面的垂直扩展来提高性能的。对我们的用户而言，一方面喜欢性能强悍的硬件设备，另一方面，当我们给他们写软件开发的报告时，什么样的技术方案火，就要在报告里体现出什么样的技术（比如现在给用户的方案都要和向微服务靠拢），面子上的工作要做足，也很有意思~

  作者回复: 这就是你们项目的复杂度：如何以更低成本优雅的装逼😂

  2018-05-21

  **7

  **50

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-16617947524387.jpeg)

  探索无止境

  意犹未尽，期待后文！希望可以不受篇幅的限制，针对实战案例做更多的分析！

  2018-05-05

  **

  **40

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-16617947524388.jpeg)

  Sadieʕ·͡ˑ·ཻʔ

  这个小程序可以改进一下吗，把语音的进度条提供出来。中断后不想从头听起

  2018-05-17

  **

  **30

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-16617947524389.jpeg)

  小喵喵

  李老师，当一个系统分为很多子系统时，每个子系统都有独立的数据库，如何保证数据的一致性呢？比如我有一个业务需要在A库插入一跳数据，在B库也要插入了一跳数据，然后在C库修改一条数据。假设中间那个库操作失败了，如何做到这个数据的一致性呢？

  作者回复: BASE原理，最终一致性，后面会讲

  2018-05-06

  **2

  **23

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475243910.jpeg)

  清泉

  说说我的理解，不管是任务分配还是任务分解，都是通过分摊单台机器的流量来提高整个系统的处理性能。 对于任务分解，我认为不但没有性能上的收益，反而有性能上的损耗，本来可以在一个进程内部完成的交互，分解后却需要进行服务器间的网络交互。（分解前后业务逻辑不变的情况下）  不知道我这么理解对不对，但是与楼主说的任务分解一定程度上可以提高性能有些矛盾，求楼主指点迷津😊

  作者回复: 有性能损耗，但性能收益更多，举个简单例子，A功能和B功能在同一系统，A功能慢查询导致整个系统性能低，B功能性能同样被拉低。 我举例是告诉你说有慢查询，实际上很多系统隐藏的性能问题并不明显就能看出来。

  2018-05-05

  **2

  **14

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475243911.jpeg)![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,w_14.png)

  汪彬英

  我目前是一家中型互联网公司技术部平台组leader。我们，目前的架构其实是更接近第二种。做了微服务拆分。它在一定程度上解决了单系统时期面临的各种问题。但是就像文中说的，我觉得我们的拆分力度没有把握的很好。也导致了近2年开始出现，特别是大促的时候，机器增加比例比请求增加的比例大很多。一个完整的调用流程，调用链非常长。核心原因是当时做微服务拆分的时候，完全是基于数据库做拆分的，比如，所有跟用户信息有关的东西拆分成用户系统，跟你订单有关的东西拆分成订单系统，跟渠道有关的东西拆分成渠道系统等等。这样拆分之后，一个在用户看起来应该很连贯的操作，我们内部却需要调很多系统。想问一下老师，基于这种现状，有没有比较好的建议呢？

  作者回复: 分析核心流程的全链路性能消耗，找到消耗最大的1个或者几个服务进行优化，或者合并一些微服务，降低接口调用次数

  2021-06-15

  **

  **10

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475243912.jpeg)

  Will

  一、所有的高性能都要针对不同的业务场景: （1）单机的高性能主要在于多任务处理，让不同或相同的任务能够同时处理。 （2）集群的高性能主要在于任务（业务模块，组件，资源）的拆分和利用，一是分配，二是分解，大规模分配的前提是要合理的分解系统，合理的分解也是为了更好的聚合任务。 二、其实现在针对网络访问，dns，反向代理，web服务，应用服务，缓存，数据库，分布式文件等都有很多的解决方案，但如何把这些方案和当前你的业务结合起来，并且你的业务如何进行设计，如何拆分功能和组件来满足不同时期的业务性能变化。 三、其实老师今天提供了一个渐进性的方案，也是业务性能变化的应对方法论，先单机，再集群，然后拆分再集群，不管什么样的性能问题都能用这个方法论来解决。具体如何集群相应开源的解决方案很多，但是业务系统如何拆分，拆分的粒度，我觉得老师也应该有相应的方法论，期待... 具体到我们公司，涉及到性能要改的地方很多了，包括静态资源处理，业务消息队列多线程处理，数据库现在是单库，如何进行读写分离。。。

  2018-05-06

  **

  **9

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475243913.jpeg)

  肖一林

  拆分业务就是消除木桶效应。服务之间调用尽量少，能减少系统损耗。

  2018-05-18

  **

  **8

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475243914.jpeg)

  卡莫拉内西

  我们公司做的政府项目，没有高并发的场景，业务大多也是crud，高可用是有的，高扩展的场景较少，需求基本上是产品经理整理好的，一台ng，两台应用服务器，一主两从mysql，nas设备，redis都可以不用，请问这样业务场景的公司是否适合长期呆下去，还是说可以为了架构而架构，公司本身不差钱，给政府做项目几乎也是友情价，老板在乎的可能是数据

  作者回复: 职业选择不是本专栏的内容呢，看你个人追求什么了，有的人追求稳定，有的人追求兴趣，有的人追求回报

  2018-05-06

  **2

  **8

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475243915.jpeg)

  新人小胖

  我们现在的系统是一个消息处理系统，主要的瓶颈在于消息的处理是必须要是顺序的，不能乱序，所以subscribe消息是单线程的，目前需要解决这个问题。

  作者回复: “顺序”有两种场景：1. 按先后顺序分配，2. 处理完前一条才能处理完后一条。 第一种情况按照简单的任务分配就可以实现高性能，第二种如果任务的处理比较复杂的话，可以用任务分解，将任务分解为多个步骤，采用流水线的架构设计达到高性能，如果任务很简单，单台机器做好优化性能也能做到比较高，例如redis就是单进程的

  2018-05-05

  **2

  **8

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475243916.jpeg)

  木木

  讲得很好啊，就是更新太慢，不够看啊

  2018-05-05

  **

  **7

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475243917.jpeg)

  彡工鸟

  举例分析可否适当引入存储层来讲解呢。这才是真正的复杂点吧？

  2018-05-05

  **

  **7

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475243918.jpeg)

  zeus2_18921421203

  目前性能首先必须把单机性能用起来，比如多线程一起执行，写入批量 减少io。单机到极限后用集群，集群必须要有任务调度，还存在互斥锁，复杂度急剧提高，性能再不够要分析性能瓶颈了，是io还是线程切换还是中断？基本单机加集群能搞定大部分，很少要优化线程模型的，用线程池就足够了，还有actor这个大杀器没用呢。

  2018-05-05

  **1

  **6

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244019.jpeg)

  马亮

  单台服务器性能打八折，这个数字怎么来的呢？经验值还是测算值？比较好奇

  作者回复: 经验值，而且很多时候还达不到这个值

  2019-02-26

  **

  **5

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244020.jpeg)

  Colin

  之前拆分过WMS系统，按业务划分，商品信息管理，收货模块，发货模块，仓内操作模块等等，项目更清晰，性能扩展方便，性能更好

  作者回复: 谁用谁知道，一般人我们都不告诉他😂😂

  2018-05-06

  **

  **5

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244021.jpeg)

  但莫

  我做的系统实现高性能的一种方式是缓存。把计算结果缓存起来，下次相同的请求直接从缓存获取结果就可以了。可以使用多级缓存，如本地缓存和集中缓存服务。 我在做系统的时候，应用层的扩展和优化相对持久化层的架构设计来说要容易一些。请问老师如何针对应用层和持久化层来做设计，有什么好的策略可以分享。 谢谢

  2018-05-05

  **

  **5

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244022.jpeg)![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,w_14.png)

  老王

  我在做一个机器学习的程序，目前还是在单机上训练SVM，可以通过划分训练集，利用多台机器并行训练然后再合并的方式提升训练性能。

  2018-05-05

  **1

  **5

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244023.jpeg)![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,w_14.png)

  微思![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/89yyff4c4c2e2b73ce4931bb01a6a943.png)

  李老师，文章写得很棒，受益匪浅！但有一点疑惑的地方，通篇读完似乎没有看到具体的对高性能的定义，到底什么是高性能？高性能可以具体由哪些指标来衡量？是否遗漏了，还是说已经包含在行文里了，需要读者提炼？

  作者回复: 高性能没有绝对标准，有的业务每秒处理1000就是高性能，有的每秒处理10000性能都一般，从业务出发，结合行业经验就可以判断性能要求是否高

  2018-05-13

  **

  **4

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244024.jpeg)

  张玮(大圣)

  \1. 读了所有的评论，其实随着这几年微服务架构思想的就行，很多时候一些架构设计同学都会选择一步到位把系统按照业务做拆分，当然这里有粒度的把控，过粗过细都会导致问题，这里可以理解为任务分配+任务分解思想的运用 2. 性能优化点思路总结起来还是两步走:先单机后集群，如多线程、协程等编程模型的使用，缓存的使用，最终都是为了更快完成一次请求服务 3. 运华兄，点赞，加油，希望突破千万订阅者！

  作者回复: 全中国程序员加起来都没这么多😂

  2018-05-05

  **

  **4

- ![img](data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QN5aHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjI2MTlEODM3NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjI2MTlEODM2NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OTYyRTNCMDNBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OTYyRTNCMDRBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7/7gAOQWRvYmUAZMAAAAAB/9sAhAABAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAgICAgICAgICAgIDAwMDAwMDAwMDAQEBAQEBAQIBAQICAgECAgMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwP/wAARCADuAO4DAREAAhEBAxEB/8QAfAABAAICAwEBAAAAAAAAAAAAAAYHBAgBAwUCCgEBAAAAAAAAAAAAAAAAAAAAABAAAgIBAgIECwQJBQAAAAAAAAECAwQRBSEGMWESF0FRgVITk+MUVJTUIkJiB5EyhBVFhbXFNnFygqJTEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwD9vAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGHmbhg7fD0mbl4+LF69l32wrctPBCMmpTfUk2BG7ue+Wqm4rNsua6XTi5DWvVKyutPyaoDmnnrlq19l506W9NPTYuSk2/xQqnGPlaQElxM7Dzq/S4WVj5VfhlRbC1Rfil2G3GXU9GBlAAAAAAAAAAAAAAAAAAAAAAAAAAAA4bUU5SajGKblJtJJJattvgkkBVHMnP8AJSswtilHSLcLdxcVLV9DWHCWsdF/6ST1+6uiQFW35F+VbK/Jutvum9Z23WSssk/xTm3JgdIADvx8nIxLY34t9uPdD9W2myVc1412otPR6cV0MC1uWufvTTrwd8cITlpCrcYpQhKT4KOXBaQrbf346R8aXFgWmnrxXFPimvCAAAAAAAAAAAAAAAAAAAAAAAAAAFUfmBzHKLexYVjjrGMtxsg+LU12oYia6E4tSn400vOQFTAAAAAAAuDkDmSWRFbHm2OVtUHLb7ZvWU6oLWeK2+LdMV2ofgTX3UBaAAAAAAAAAAAAAAAAAAAAAAAABi52XDAwsvNs4wxce6+S10cvRQlNQX4ptaLrYGr+RfblX3ZN8nO7Itsutk/vWWSc5Pq4sDpAAAAAABlYWXbgZeNmUPS3Guruhx0TcJJ9mWnTGa4NeFMDaDGvrysejJqeteRTVfW/HC2EbI/9ZAdwAAAAAAAAAAAAAAAAAAAAAACJc8WurlncOzwdrxateqeVT2v0wTXlA18AAAAAAAAAbFcnXSu5a2mcnq402U/8cfJuoivJGtASYAAAAAAAAAAAAAAAAAAAAAABFOdqXdyzuSjxlWse7yVZVMp/or1YGvQAAAAAAAADY3lGiWPy3tNclo5Yzv8AF9nJusyYvyxtQEjAAAAAAAAAAAAAAAAAAAAAAAdGVj15eNkYty1qyaLaLF4exbCVctOvSXADWDNxLsDLycLIj2bsa6dM/E3B6KUfHCa0afhTAxQAAAAAAZ224Nu55+LgUp+kyboV6pa9iDetljXm1VpyfUgNnqaoUU1UVLs101wqrj4oVxUILyRQHYAAAAAAAAAAAAAAAAAAAAAAAAVrz5yzPNh++cGtzyaK1HNpgtZX0QX2bopcZW0R4NdLhp5ujCmQAAAAAAXbyLyzPbaXumdW4ZuVX2aKprSWNjS0bck+Mbr9FqumMeHS2gLDAAAAAAAAAAAAAAAAAAAAAAAAAACuOZOQ6c+dmbtDrxcubc7cWX2cbIm+LlW0n7vbLw8OxJ+bxbCpM7bM/bLXVn4l+NPVpekg1CenhrsWtdseuLaAwQAHo7ftO47raqsDEuyZapSlCOlVevhtul2aql/uaAt3lrkWjbJ15u5yry86Gk6qYrXFxpripfaSd90X0NpRi+hNpSAsIAAAAAAAAAAAAAAAAAAAAAAAAAAAAD4sqrug67a4W1y/WhZCM4P/AFjJNMDw7eVuXrm5T2jCTfT6Kr0C49VLrQHNPK/L1ElKvaMJtcU7alfo/Gle7FqB7cK4VQVdcIVwitIwhFQhFeJRikkgPsAAAAAAAAAAAAAAAAAAAAAAAAAY2XmYuBRPKzL68aiv9ay2XZjq+iKXTKcvBFJt+BARGf5g8uRk4q3LsSeinDFkoy60pyhPR9aQHz3h8u+dm/K+0Ad4fLvnZvyvtAHeHy752b8r7QB3h8u+dm/K+0Ad4fLvnZvyvtAHeHy752b8r7QB3h8u+dm/K+0Ad4fLvnZvyvtAMjG575cybY1PKtxnJpRnk0Trq1fglZHtxrXXLRLxgTCMozjGUZKUZJSjKLTjKLWqlFrVNNPgwOQAAAAAAAAAAAAAAAAAAAAUZ+YW43ZG9ywHOSx9vqpUa9fsu7IphkTta8MnCyMepLrYECAAAAAAAAAAAF0/lxuN2Tt+Zg2zlOO320uhyerhTlK1qpPzYWUSa8Xa06NALHAAAAAAAAAAAAAAAAAAAABr3zx/lO6fsX9OxAImAAAAAAAAAAALY/K/+Ofyz+4AWwAAAAAAAAAAAAAAAAAAAADXvnj/ACndP2L+nYgETAAAAAAAAAAAFsflf/HP5Z/cALYAAAAAAAAAAAAAAAAAAAABVvMfJG7bxvOZuONkbdCjI937Eb7cmNq9DiUUS7Ua8S2C1nU2tJPgB4fdrvvxe0+vzPoAHdrvvxe0+vzPoAHdrvvxe0+vzPoAHdrvvxe0+vzPoAHdrvvxe0+vzPoAHdrvvxe0+vzPoAHdrvvxe0+vzPoAHdrvvxe0+vzPoAHdrvvxe0+vzPoAHdrvvxe0+vzPoAJvyby1ncvfvH323Et989z9F7rZdPs+7+9dvt+loo019OtNNfD0ATcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//Z)

  十七

  目前系统按业务做了拆分，确实带来了更大的复杂度，特别是数据库层面上，数据并不能根据业务完全分离

  2018-05-05

  **

  **4

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244025.jpeg)![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,w_14.png)

  escray![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/d57fddfa5b2c2ce3071e92304da8af62.png)

  首先把系统跑起来，然后尽可能的做单机性能优化，在单机成为瓶颈时，考虑集群的任务分配和任务分解。 一般人可能并没有机会去接触类似于淘宝或者微信这样量级的架构，从个人而言，我更关注单机性能优化。 除了传统意义上的单机优化，如果把应用部署阿里云这样的云平台上，单机性能优化是否有不同？

  2018-05-05

  **

  **4

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244026.jpeg)

  TLC

  谈一谈：我们刚开始就是单体架构war，提升性能主要通过应用程如JVM优化，tomcat优化，应用架构优化，硬件提升数据库CPU内存，服务器高性能硬盘等。后来请求上来了，部署了多台集群，同时提供了nginx转发请求，数据库也由单台变为主从架构

  作者回复: 很自然的演进路径

  2020-09-24

  **

  **3

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244027.jpeg)

  吕宗胜ZJU

  性能的复杂度从大方向来说是单机和集群架构的复杂度。但真正要解决性能问题，还是得从业务形态、业务规模来入手；优化的手段也会是多样的，比如从组件的角度出发，从部署结构出发，引入缓存等

  2019-11-02

  **

  **2

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244028.jpeg)

  小法

  高性能需要带来的复杂度： 1.主要有为了高性能单台服务器内部的复杂度；以及为了高性能多台服务器集群带来的复杂度。 2.单机复杂度主要体现为：多线程和多进程。操作系统调度的最小单位是线程，操作系统分配资源的最小单位是进程。进程间通讯的方法有：管道、消息队列、信号量、共享存储。完成一个高性能的软件系统，需要考虑如多进程、多线程、进程间通、多线程并发等，这些技术并不是最新的就是最好的，也不是非此即彼的选择。 3.集群的复杂度主要体现为：任务分配和任务分解。任务分配主要指在不优化拆分任务的前提下，粗暴的增加机器，以提高性能的方法。任务分解主要指在将大任务进一步细分，得到子任务或者叫子系统，进而更进一步优化这些子系统，并将大任务分配到不同的机器上提高性能的方法。集群不是越多越好，机器越多，复杂度越高（任务分配和状态保持的难度和复杂度越来越高），提升效率越低（考虑到网络损耗和机器本身的损耗）

  2019-03-27

  **

  **2

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244029.jpeg)

  晓晨同学

  提高系统高性能的方式，第一种是通过物理手段提高硬件的性能，另外一种是水平的拓展，我理解也分为两种，集群和分布式，集群自不必说，分布式就是将一个复杂的业务进行更细致的拆解

  作者回复: 一种叫对称集群，一种是非对称集群，都是分布式的具体实现，后面会讲

  2019-02-17

  **

  **2

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244130.jpeg)

  Sunny

  1.单机复杂度与多机复杂度； 2.任务分配与任务分解。

  2018-11-26

  **

  **2

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244131.jpeg)

  俯瞰风景.

  任务分配是所有的功能都可以在一台业务服务器上完成，业务模块之间可以在一台服务器上相互调用。 而任务分解是把功能逻辑拆分到不同的业务服务器上了，业务模块之间的相互调用要通过网络。 业务越来越复杂，单台机器处理的性能会越来越低是由于一个进程会占用更多资源么？ 可以这样理解么？ ——任务分解是在业务复杂之后，代码耦合度很高，为了优化代码逻辑，实现更高效的单独处理某一业务需求的模块。

  作者回复: 理解正确

  2018-11-23

  **

  **2

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244132.jpeg)

  贾洵

  高性能，首先要知道什么是高，多少算高？现在的性能指标一定要考虑未来三到五年的业务扩展量。 从性能优化角度纵向增加服务硬件配置，内存，cpu，ssd，raid矩阵，带宽能加的都给加上。第二，软件调优，中间件连接数，分配内存；数据库最大连接数，分配shared-buffers等；第三，单机遇到瓶颈时，通过书中任务分配的方式，通过增加服务器的方式增加集群。集群遇到瓶颈增加任务分配器再集群，形成笛卡尔积的矩阵；第四，程度优化。优化查询sql，使用合理的设计模式，要秉承等待即是浪费的思想，😄；第五，微服务模式，将任务分解成适当数量的小任务或服务。单个优化，横向扩展；第六，再想想数据方面的问题，引入缓存机制。redis什么的；第七，得考虑数据库了，究竟是做到读写分离，还得做到数据分库处理，还是杀敌一千自损八百的分表。分表要考虑的太多了，还垂直还是水平，是否需要数据库的中间件？阿里的异库索引表的处理也很棒。

  2018-11-11

  **1

  **2

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244133.jpeg)

  刘鹏

  高性能会给系统带来复杂度，而架构就是来解决这些复杂度。任务分配会有机器的瓶颈，微服务会有服务数量的瓶颈，每一种解决方式都有一个度，控制好合理使用任务分配+任务分解

  作者回复: 是的，把握度是否准确就是架构师的判断

  2018-09-18

  **

  **2

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244134.jpeg)

  wkplus

  介绍线程的时候，只是提到因为单进程内部也需要并行，所以需要多线程，感觉还不够充分。比如文中餐饮管理进程的例子，排位、点餐需要并行，也可以引入多进程来实现。为什么需要线程，我觉得还是要提及多线程和多进程效率对比，比如线程/进程创建的开销，多线程/进程相互通信的开销等。

  作者回复: 确实如此，但我的本意不是对比线程和进程，而是说明为什么有了进程后还要有线程。 关于多线程和多进城对比，后面架构模式部分会讨论

  2018-05-09

  **

  **2

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244135.jpeg)

  sam

  工作中主要偏重前端开发，对老师讲的这些虽然理解(收获也很大)，但工作经验中并没有实践过，希望老师能推荐一些基础的实例的上手项目供我们这些初级菜鸟练习的机会。

  作者回复: 先讲道和术，再给案例

  2018-05-08

  **

  **2

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244136.jpeg)

  淡彩

  目前的业务系统主要是将用户界面、服务、数据库分层，除数据库外其他两层的服务都走LB用HAProxy。因为业务量不大，所以性能瓶颈暂时还不存在，不过服务层没有做到完全无状态化，有一些坑。本节内容主旨业务划分，节点扩张，后面应该慢慢就走向SOA，microservice了

  作者回复: 本节的拆分是为了性能，不是为了业务可扩展，后面会讲可扩展

  2018-05-05

  **

  **2

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244137.jpeg)

  李志博

  刚做了一个拆分是梳理核心接口和非核心接口，拆成两个项目，保证非核心接口出问题影响不到核心接口

  2018-05-05

  **

  **2

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244025.jpeg)![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,w_14.png)

  escray![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/d57fddfa5b2c2ce3071e92304da8af62.png)

  开辟新领域的技术，增加了选择或组合的可能，给软件系统带来复杂度。 高性能可以带来良好的用户体验（快），满足业务增长的需要（Google、淘宝、微信）。 操作系统似乎已经帮助人们（开发和用户）屏蔽的很多复杂性。 当单机性能无法支撑业务复杂度时，就要采用集群的方式，从任务分配到任务分解，尽可能提高整体性能。 现在比较流行的微服务有点类似于任务分解？

  作者回复: 是的，微服务是宏观上的任务分解

  2020-09-02

  **

  **1

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244138.jpeg)

  拾光漫步

  “任务分配器”也并不一定只能是物理上存在的机器或者一个独立运行的程序，也可以是嵌入在其他程序中的算法，例如 Memcache 的集群架构。 这个就不存在任务分配器的瓶颈了 因为 是由客户端计算的 

  作者回复: 是的，memcache就是你说的这种方式，但是对其他程序有很大侵入性

  2019-11-08

  **

  **1

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244139.jpeg)

  张琦

  我发现不少大神在评论区，越厉害越学习，我要努力了。

  作者回复: 评论区卧虎藏龙

  2019-08-26

  **

  **1

- ![img](data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QN5aHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjI2MTlEODM3NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjI2MTlEODM2NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OTYyRTNCMDNBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OTYyRTNCMDRBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRm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)

  Geek_88604f

  关于高性能大家主要讨论了单机优化和堆机器来达到很高的TPS。我们这里的高性能还有另外一个核心诉求——低时延，每个请求必须在很短的时间内返回结果，否则就会被其它系统忽略（我们的系统是更大系统的一部分，和给我们分配的时间是固定的）。当系统收到请术求后会触发数据库执行存储过程，问题是存储过程会随着业务的发现逐渐增多，有些存储过程之间还相互依赖，这意味着计算时延会越来越高，一段时间后就无反法满足整个系统的要求了，然后就是痛苦的局部计算优化，如此往复。能不能从架构上彻底解决这个问题，李老师？

  作者回复: 1. 不要用存储过程 2. 局部优化

  2019-07-25

  **2

  **1

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244140.jpeg)

  yoummg

  总结一下老师所说的。 单机的高性能，更多的落脚点是机器本身的性能，以及处理具体任务的方式，多进程或多线程，更合理的应用单机的性能； 集群的高性能，即任务的分配和分解。分配是物理层面的，即哪些机器处理用户的请求；分解是业务层面的，即单个请求哪些业务子系统来处理。分配的难点：分配机器的性能，分配算法，与业务系统的连接，失败重试机制等等。分解难点在于业务切分的粒度把握，只能对业务与机器这两块理解恰到好处，才能做较好的切分。 因此集群的高性能的基础是把握好单机器性能。

  2018-07-08

  **

  **1

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244141.jpeg)

  朱伟

  关于微信的架构，是实战经验总结还是自己推算？感觉不太对啊

  作者回复: 微信自己公布的资料，你觉得哪里不对，我们可以探讨一下

  2018-05-17

  **

  **1

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244142.jpeg)

  J

  之前的公司用的是任务分解，现在的公司用的是任务分配，请教一下 ，文中的任务分解无需任务分配器么？比如ng?

  作者回复: 可以用nginx做路由，也可以请求方直接访问具体的子系统

  2018-05-15

  **

  **1

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244243.jpeg)

  DullBird

  \1. 平台利用的是多台设备任务分解即集群的方案， 分为一个任务分解器（服务端）：仅仅实现调度和任务分配（轮询） 前期由平台抽象的任务，即各种采集项目封装为一个任务。 采集机集群，可以处理各种采集任务。 后期采集任务之间互相之间有逻辑和顺序越来越复杂， 然后任务分解器没有逻辑处理模块，导致现在只能尽量将任务封装成一个。 考虑需要在任务分解器集成逻辑模块。

  2018-05-08

  **

  **1

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-16617947524387.jpeg)

  探索无止境

  如何科学估算一个系统会承受的并发量，从而估算我们需要部署的服务器数量，这方面是否可以指点下？感谢！

  2018-05-08

  **

  **1

- ![img](data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QN5aHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjI2MTlEODM3NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjI2MTlEODM2NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OTYyRTNCMDNBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OTYyRTNCMDRBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRm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)

  huangshuihua

  果然大神。这个梳理和总结气到了醍醐灌顶的作用！

  作者回复: 每篇都有人醍醐灌顶，我很开心😃😃

  2018-05-06

  **

  **1

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244244.jpeg)

  itperson

  现在做的系统就是负载均衡加几台机器 文件服务器没有用到 缓存也没有用到什么 更别提集群了 我想了解如何评价系统负载能力 希望得到指教 感觉现在做的很多工作都没法评估实际负载能力

  2018-05-06

  **

  **1

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244245.jpeg)

  smiledou123

  谢谢老师，149ms问题已经明白，不过对于您在文章中提到的一些计算机原理知识我并不是太懂，能请您为像我一样的初级运维推荐一些需要看的计算机书籍吗？

  作者回复: 我看的都是程序员的基础书籍呢，《unix网络编程卷1》《tcp/ip协议卷1》《unix高级编程》《linux系统编程》《高性能mysql》《深入java虚拟机》

  2018-05-06

  **

  **1

- ![img](data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QN5aHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjI2MTlEODM3NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjI2MTlEODM2NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OTYyRTNCMDNBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OTYyRTNCMDRBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRm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)

  闭嘴

  看完大神写的这篇文章，感觉主要是针对互联网的系统的架构，传统的企业级的架构思路难道也是要学习互联网的这种架构方式?

  作者回复: 别急，后面会讲

  2018-05-05

  **

  **1

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244246.jpeg)

  约书亚

  任务分解提升性能的第一个因素有些牵强，除非是这一组任务对资源的依赖特性上差异很大时，才可以通过资源依赖的特性进行针对的优化，但这就属于第二个因素的范围了，否则，通过拆分能达到的效果，在一台机器上也能通过良好的编码达到

  作者回复: 这个因素是普遍存在的，简单的系统确实更加容易做到高性能。

  2018-05-05

  **

  **1

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244247.jpeg)

  笑地

  目前做到了除数据层的其他各层各节点无状态且能任意扩展，下一步重点是将数据层按合适的粒度拆分多个块。我们系统的是现代ERP，关于数据层的拆分不知道大家有没有很好的办法或者合适的工具？

  2018-05-05

  **

  **1

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244248.jpeg)

  杨恒

  业务需求越来越复杂，系统复杂度也对应提高，通过划分多个服务，如微服务的方式来解决复杂度的问题，其实增加了整体的复杂度，但是这些较小的服务让每项功能变动容易测试，容易改动，容易扩展，同时，还可以依赖框架的解决一些问题。这就是我们不断演进的过程。

  作者回复: 正解

  2022-07-25

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244249.jpeg)

  永不放弃![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/2012c563b22c76a7f1f97c22c3ddf830.png)

  学习架构的分解. 

  2022-07-22

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/132.png)

  建锋

  此前公司的系统是单体架构，线上部署集群，通过nginx进行负载。后来支撑不住的主要有两点：1.拓展困难，代码越来越臃肿，内部的复杂度越来越高，维护不懂，2.是性能问题，有些模块会拖垮整个服务的性能。之后我们对服务进行划分拆解，按照业务能力进行划分，确实清晰了不少。不过微服务这块的运维，问题排查，团队管理这块还是很有挑战的

  作者回复: 微服务部分会讲解微服务的坑

  2022-05-22

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244250.jpeg)

  林肯

  总结： 1、单机高性能：多进程多线程； 2、多台机器迸发处理，调度器是关键；达到一定量级，调度器也是瓶颈，这时候可通过DNS轮询等方式不同用户分配到不同调度器； 3、任务分解能带来性能的提升

  2022-04-26

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244251.jpeg)

  Bryce

  “实际上的性能一般按照 8 折”，这个有什么依据么

  作者回复: 依据就是实际的线上统计数据得出来的经验值

  2022-02-08

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244252.jpeg)

  易飞

  集群时，采用任务分解的方式提升性能；具体到每个子业务时，会用多线程提升性能

  2022-02-02

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244253.jpeg)![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,w_14.png)

  谁都会变

  面试的时候被问到微服务的优势？我其中说了一个提高并发，他说不是，只要集群就可以了。今天看的作者的文章，说可以针对个别子系统做机器扩展，那这样来说微服务确实可以提高并发呀

  作者回复: 是可以的，不要以为面试官就都是对的

  2022-01-30

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244254.jpeg)

  刘恩德

  采用的还是单机系统, 另外加负载均衡 改进和提升的空间 1. 静态资源上 CDN 2.多缓存

  2022-01-19

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244255.jpeg)

  Drake敏

  我们之前是防火墙到负载均衡到ecs服务器

  作者回复: 防火墙做这个也是可以的

  2021-09-09

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244256.jpeg)![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,w_14.png)

  蝴蝶![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/89yyff4c4c2e2b73ce4931bb01a6a943.png)

  目前项目解决复杂度的方案是拆分模块和使用集群+负戴均衡

  2021-08-18

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244257.jpeg)

  达叔灬

  我司之前采用的是 单系统的架构 性能低下 拓展能力低 后面重构后采用分布式集群的方式将系统分为多个模块，系统的性能和拓展性得到了保障，但是个别模块还是过大同一模块中功能点过多 一旦出现问题容易引起线上系统多模块无法访问的现象。 微服务重构的时候也考虑但是综合各方面因素还是选着分布式集群 只要业务不出现爆发试增加基本够用

  作者回复: 微服务拆分关键在于拆分粒度，粒度不对的话也会带来很多问题，后面的课程会讲

  2021-08-10

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244258.jpeg)

  Ted

  我们现在只是暴力的通过加服务器 的方式，也就是第一种，提升性能

  作者回复: 加服务器到一定数量后会有瓶颈

  2021-08-09

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244359.jpeg)

  danny_lklk

  目前来看还是先进行业务划分上考虑得多

  2021-07-18

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244360.jpeg)

  小鬼爱风雪

  现在我们的系统一般都采用第二种，微服务也越来越流行，各个系统之间耦合性降低，随之会带来一些数据同步上的问题，所以在横向业务切分时，边界就显得很重要了。而各个服务之间的相互调用和网络延时对于追求50ms相应的系统就会显得尤为重要，这样会额外增加一些缓存策略的设置，整体上而言，业务的切分会带来更大的优势，版本升级和迭代会更迅速。

  作者回复: 很好的案例👍👍

  2021-06-06

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244361.jpeg)

  登山看云海

  通常来说性能是和时间密切相关的，它指的是处理一个请求或任务的耗时长短。那架构中的性能是指什么呢？从水平扩展的角度看提升的是系统整体的处理能力，对于其中个体的任务处理效率并没有改变。希望作者能给予解答

  作者回复: 架构中的性能就是整个系统的处理能力，一个是响应时间，一个是吞吐量

  2021-03-29

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244362.jpeg)

  小胖

  简单详细的讲解

  2021-03-16

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244363.jpeg)

  半夏

  一开始我们是用一台kylin支撑OLAP业务的，负责任务构建和查询 后面查询出现瓶颈，分别加了1台负责查询、1台负责构建服务器，并用nginx分别做了构建和查询的反向代理 好景不长，过了半年这种架构经常出现构建失败，查询延时较高， 后来改成查询独立，构建独立好多了

  作者回复: 很好的案例，太复杂的系统本身性能和可靠性就可能有问题，而且还不容易看出来。

  2021-03-10

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244364.jpeg)

  李兴振

  惭愧  目前主要做Windows桌面客户端程序开发，可能受业务限制，很少了解高性能相关的处理，希望能通过这个课程的的引导，更深入的学习。

  作者回复: 是的，客户端、桌面、前端主要是性能优化，谈不上架构上的高性能设计。

  2021-02-27

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244365.jpeg)

  业余爱好者

  我觉得，水平拆分（任务分配)的主要发展动力是系统的吞吐（性能的其中一个衡量指标）。而垂直拆分（任务分解)的主要动力主要是解藕，可拓展性，对性能的提升可以说是一个意外的副作用。

  作者回复: 垂直拆分的作用有多个，性能也是其中之一，不能说是副作用。

  2021-02-20

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244366.jpeg)![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,w_14.png)

  DFighting

  大佬讲解的很精辟，忍不住想自自己总结一下： 1、高性能的复杂点有两个，单机内部和集群之间 2、单机内部的演变是简单计算->批处理(进程)->批处理+分时执行(线程)->多核并发的(批处理+分时执行) 3、集群间的复杂度在两部分，节点的任务调度和复杂任务的适当分解。这部分没有太多的实践，期待老师后面的内容

  作者回复: 后面的高性能计算、高性能存储会深入讲解。

  2021-02-17

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244367.jpeg)

  谢小路

  你们怎么知道这么多技术名词，历史典故。我看一万遍也还是模糊的。

  作者回复: 那可能是你没真正使用过，只是停留在听说或者看过这个层面。

  2020-12-31

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244368.jpeg)

  老艮额

  和最高赞的兄弟一样，最好有书籍或者好的链接，英文更佳，我们是不是有点太贪心了

  作者回复: 有特别放送内容含书籍推荐

  2020-11-09

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244369.jpeg)![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,w_14.png)

  龙猫

  1、对于业务本身可以通过缓存、sql索引、多线程提升性能 2、对于外部而言可以通过多节点、集群部署提高性能

  2020-10-04

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244370.jpeg)

  黄伟洪

  说得很清楚，尤其是关于系统拆分的度。

  2020-10-02

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244371.jpeg)![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,w_14.png)

  piboye

  物理架构既要考虑性能，也要考虑发布变更的频率和相关度。

  2020-08-24

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244371.jpeg)![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,w_14.png)

  piboye

  性能影响最大在存储，io次数和随机都写。业务上就是缓存，批处理，减少内存分配，减少系统调用，异步处理

  2020-08-24

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/132-166179475244372.png)![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,w_14.png)

  Geek_d7baca

  任务分配，任务分解

  2020-07-23

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244473.jpeg)

  慎独明强

  我们系统为了提高高性能，首先是通过拆分业务为不同的服务，服务为集群部署。服务之间有通过mq异步处理来提高性能但是也提高了系统复杂度，消息可靠性和幂等，顺序性。  也有通过redis来提高性能，也会带来数据库与redis数据双写一致性问题。   Mysql读写分离，也带来了当数据库执行大sql，并发高时，会带来主从延时的问题。 为了提高性能，在数据库层面对表结构设计，减少复杂的关联查询。

  2020-07-20

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244474.jpeg)

  天道酬勤

  任务分解可以有效地提升系统的性能，但是并不是任务分解的越细越好，它有一个度，如果分的太细，反应时间反而会增加，所以任务分解要看你的业务逻辑是怎样的，微服务的来源应该也是基于此

  2020-07-02

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244475.jpeg)

  wesley

  目前采用读写分离、缓存等来提高性能。

  2020-06-15

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244476.jpeg)

  美国的华莱士

  跟商业模式一样,层级越多,成本越高,类似于架构里面子系统越多时间和空间成本越高,其实不难发现架构跟业务用到的思维其实是相通的.

  2020-05-26

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244477.jpeg)

  H

  很想问一下作者关于qps的理解： 其实，关于qps是指一天的评论值，还是指某一刻的最大值。比如：我负责的项目是700K/小时，qps是直接等于700000除以3600吗？还是qps等于全天的访问量，再除以86400？ 网上很多文章都参差不齐的，很难明白qps的真正含义。往作者指导，感谢

  作者回复: QPS=Query per second 另外，我们说系统的TPS和QPS，可以是指峰值，也可以是指均值

  2020-05-10

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/132-166179475244478.png)

  荣码人生

  在集群复杂度中有任务分配和任务分解两种。 任务分配可以是计算系统、存储系统、缓存系统，这里我最近使用的fastdfs，它就是存储系统通过任务分配的方式来实现的，storage正常启动后，会向tracker发出已启动的信号，然后当客户端向tracker发出存储文件请求，然后tracker将它分配给某个可用stoge，storge进行图片存储任务，并反馈给tracker， tracker再通过客户端已完成保存动作。 任务分解其实目前最热门的一个应用就是微服务，它将一个庞大应用系统按需分解成多个微服务，然后共同协作完成具体任务。 综上所述，集群复杂度的任务分配和任务分解，其实就是在构建分布式系统。

  2020-04-07

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/132-166179475244479.png)

  Ahaochan

  如何做到高性能？总得来说就是拆分任务。 性能损耗=单任务耗时 变为 性能损耗=max(多个任务耗时)+多个任务间通信耗时。 从单机角度理解，就是单进程拆分为多进程多线程。 从集群角度理解，就是单体应用拆分为微服务。 但是，任务不是拆的越多越好，一个女人十月生下一个孩子，十个女人一个月能生下一个孩子吗？

  2020-03-23

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244480.jpeg)

  谭方敏

  我们现在因为业务还还没有到百万级的量，采用了折中办法，公共模块采用单机，优化到极限，减少业务量，比如管理类服务器，只负责管理各个服务器连接配置啥的，以及数据库服务器，目前也是单机的情况，而在直接处理用户业务的模块采用多机，比如网关负责用户交接，核心业务服务器负责第三方业务服务器查询等，这虽然不算真正意义上的纯集群架构，但是却出奇的好用，管理类服务器有时候还能起到不同服务器间路由转发的效果。

  作者回复: 合适的才是最好的

  2020-02-27

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244481.jpeg)![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,w_14.png)

  feihui

  我觉得系统拆分更多的是从职责以及管理上来考虑，在复杂系统中，工程上的问题会比性能上的问题要明显得多

  2020-01-19

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244482.jpeg)

  徐大恺

  系统拆分的粒度是架构师追求系统性能极限以及平衡系统复杂度的关键

  2020-01-07

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244483.jpeg)

   臣馟飞扬

  单机模式：用户手工输入->批处理任务->进程分时处理->进程内部多线程处理->多进程 集群模式：任务分配(多台机器均能处理完整的业务，也即集群概念)->任务分解(将完整业务分解为多个模块在不同机器上分别处理，也即分布式概念)

  2019-12-07

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244484.jpeg)

  Vickey Cheung

  老师，目前的针对任务分解，有什么好的框架推荐吗

  作者回复: 框架没有，架构目前就是用微服务

  2019-10-16

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244485.jpeg)

  钱

   课前思考及问题 1：复杂度来源——高性能？ 单机任务的执行，一般会经过硬盘——内存——三级缓存——二级缓存——一级缓存——CPU，然后再一级一级的回过去。为啥这么麻烦？我觉得主要是因为两个原因，一是更人性化，让人操作起来更爽，二是这些器件的内部结构决定了他们之间存在速度差，而且这个速度差相对而言是一个天文数字。为了提高CPU的使用率，单机任务的执行就复杂了起来，一是链条更长，二是需要并发处理多个任务。 另外单机的性能总是有限的，当不能再通过提示硬件的性能来达到提高单机性能的目标时，只能通过增加机器的方式来提高性能，此时机器与机器之间的协作就需要通过编程的方式来实现，在单机中这些事情主要是OS来实现的，现在复杂度外溢到集群之中，定会加剧程序的复杂度。 课后思考及问题 1：读完老师的讲解，感觉非常精彩，原本觉得这是一件很自然的事情，发现老师更是拿出了足够的依据来支撑这个事情，确实再自然不过啦😄 目前我们的系统，缓存、本地缓存、消息队列、es这些能够提升性能的技术都在使用机器数也不少，扛量基本没问题(TPS≈200)，如果还有优化空间的话，估计需要从计算逻辑、日志打印上着手啦！ 不知老师后面有没有定位性能瓶颈的讲解？

  2019-08-24

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244486.jpeg)

  舒偌一

  针对性能讲，任务分配、任务分解是为了隔离影响性能的业务，采用办法（比如集群）提高这部分的性能。

  2019-08-20

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244487.jpeg)

  fomy

  3、复杂度来源之一：高性能 3.1 单机高性能复杂度 进程是资源分配的最小单位，与其他进程资源独立。线程是任务调度最小单位，共用进程内的资源。 如果要完成高性能的软件系统，需要考虑如多进程、多线程、进程间通信、多线程并发等技术点。在做架构设计时需要花费大量经历来结合业务进行分析、判断、选择、组合，这个过程同样很复杂。 3.2 多台计算机集群复杂度 3.2.1 单台任务分配 任务分配器选择：硬件网络设备（F5、交换机）、软件网络设备（LVS）、负载均衡软件（Nginx、HAProxy）、自己开发系统等。 任务分配器和业务服务器之间连接和交互。 任务分配器算法。 3.2.2 多台任务分配器 任务分配器算法：不同用户分配不同的任务分配器。DNS轮询、智能DNS、CDN、GSLB设备等。 任务服务器和业务服务器之间连接和交互从1对多变为多对多网状结构。 3.3 业务复杂度 是否需要拆分（简单系统更容易做到高性能）。 系统拆分粒度大小的衡量。太多造成系统之间的频繁调用。

  2019-08-09

  **

  **

- ![img](data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QN5aHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjI2MTlEODM3NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjI2MTlEODM2NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OTYyRTNCMDNBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OTYyRTNCMDRBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRm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)

  Geek_88604f

  ​        云化架构下单机形态除了普通物理机外还有专用机（如GPU,TPU等）、虚拟机（分为原生式和宿主式）、容器等等。每种形态适用的场景和范围都有差异；集群的话有虚拟机集群，容器集群和serviceless。这里面有涉及到调度框架的选型（万一将一个任务调度到一个本来就比较忙的节点上，就会拖慢整体的节奏）serviceless的话用着方便但是缺乏控制，一旦发现是serviceless的性能瓶颈，要优化的话就得看别人的脸色。        这样看来，云虽然承诺像用水用电那样方便，但实则不然，而是有很多选择，我们年龄多即是少的困境。        除了参考权威的资料外，最靠谱的做法是需要架构师先设计出原型，在不同的资源类型上得到基线值，再根据基线并结合经验在指定规模集群下的能力，没有数据就没有说服力。

  2019-07-19

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/132-166179475244588.jpeg)

  浩

  看起来像个数学题，总有一个点，能够达到性能的最佳，随着机器的增加或者系统的拆分，系统性能达到最佳，过了最佳点，继续增加机器数量或者子系统数量，数量会降低

  2019-05-12

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244589.jpeg)![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,w_14.png)

  到道可道![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/89yyff4c4c2e2b73ce4931bb01a6a943.png)

  今天的关键字：1.任务分配；2.任务分解

  2019-04-08

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244590.jpeg)

  小小杨

  由于部门在高性能的技术积累比较少，直接选用开源的框架，如vertx,屏蔽了并发和NIO的细节。但在一些场景下框架局限性很大，可能用不好是一方面，框架本身对场景支持不好。     发展到一定阶段并发和数据量越来越大，单机吞吐量不能满足需求，集群提上了日程，框架本身也有集群方案，但是直接用出现了很多问题。      其实架构设计才是解决实际问题的手段，框架只是一种实现手段，不能从本质上解决问题。

  作者回复: 框架要用好，不是拿来就能解决问题

  2019-03-28

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244591.jpeg)

  凌

  4-复杂度来源之高性能 高性能的复杂度来源主要有两种： 提高单机性能带来的复杂度。 多台计算机组成集群带来的复杂度 单机性能提高带来的复杂度 最早的计算机是没有操作系统的，计算机等待用户输入指定，然后执行，这种方式很慢，计算资源大量闲置。于是人们就把程序写在纸上给计算机读取，也就是批处理系统，但是批处理系统在IO时，CPU也是闲置的。为进一步提升性能，有了进程的概念，一个进程对应一个任务的执行，每个进程都有自己独立的内存空间，进程间互不相关，由操作系统来调度。CPU采用时间片机制，虽然本质上是串行执行进程，但是在用户角度来看，是多进程并行执行的。再后来，同一个进程间的多个子任务也有并发运行的需求，例如对于餐厅管理系统这个进程来说：排队、买单、点菜等动作需要并行执行，彼此间不能相互等待。为了解决这个问题，有了线程，线程是进程内部的子任务，线程间共享同一进程的数据。有了多线程之后，计算机调度的最小单位就是线程，计算机资源分配的最小单位就是进程。 单CPU下，无论是多进程还是多线程，本质上都是串行执行，多核CPU的诞生，做到真正意义上的多任务并行。操作系统发展到现在，用多进程、多线程只有取舍之分，没有绝对的好坏，比如：Nginx既有多线程也有单线程，JBoss是多线程，Redis是单进程。虽然性能都高，但是内部实现的差异巨大。 多台计算机集群提高性能带来的复杂度 对于抢红包这种业务量极大的业务，单机不可能支撑，就需要使用集群的方式来达到高性能。同时会带来两个问题： 任务分配 任务分解 任务分配   单台服务器到集群服务器的转变也带来一些问题： 1.需要增加任务分配器，比如F5,LVS,Nginx 2.任务分配器需要和业务服务器之间进行连接建立、连接检测、连接中断处理等 3.任务分配算法是轮询、权重、业务机负载？ 4.集群中的节点数量大了之后，任务分配器会不会成为瓶颈 任务分解 通过任务分解，把原来大一统但复杂的业务，拆分成小而简单但需要多个系统配合的业务系统 现在微服务大行其道，主要有几个方面的因素： 1.简单的系统更容易做到高性能 系统的功能复杂时，很难找到对应的性能瓶颈点，因为需要考虑和验证的点太多。其次，就算找到瓶颈点A对其优化，但无意中却降低了瓶颈点B的性能。 系统的功能越简单，影响的点越少，如果把A/B拆分成两个服务，那么优化A点性能的时候就可以不考虑对B产生的影响。 2.可以针对单个任务进行扩展 当各个业务逻辑分解到不同的子系统后，整个系统的性能瓶颈更加容易发现，而且发现后只要针对有瓶颈的子系统进行性能优化或提升，不需要改动整个系统，风险会小很多 那么，服务越细越好吗？ 虽然通过拆分业务逻辑到不同的子系统中，可以更容易的做到高性能和可扩展。但是对于每一个系统来说，业务本身的处理能力都有瓶颈。如果拆分过系，不同服务间的网络调用次数和时间都更大，也可能造成系统的不稳定。

  2019-03-14

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244592.jpeg)

  蓝山不苦

  很多公司的架构都是从简单到复杂的，不管是淘宝、美团等公司，所以做架构设计要首先结合自己的业务场景和业务需求，不管的去迭代和演进，在每个发展阶段遇到的问题也不一样，因此没有一成不变的架构，只有不断变化的适合自己的架构

  2019-02-28

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244593.jpeg)

  行者

  目前我们系统中，高性能的系统2种方式都有采用，一方面是提升代码执行效率；另一面是通过集群来提升集群QPS。 老师对系统的复杂度论述非常精彩，学习了。

  作者回复: 加油😊

  2019-02-27

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244594.jpeg)

  朱汉棠

  我们用的是集群方式，当初的架构师设计的时候就考虑到每个业务组件都支持配置链接不同服务器

  2019-02-20

  **

  **

- ![img](data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QN5aHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjI2MTlEODM3NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjI2MTlEODM2NTgzMTExRTk5NDY4Qjk3QUFCNDFBN0QzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OTYyRTNCMDNBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OTYyRTNCMDRBREI4MTFFOEFFNTJDODlGREQ1OTUzMDMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRm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)

  Jackey

  我认为影响一个系统的性能瓶颈有很多，当业务处于高速发展时期时，可以临时采取水平拆分这种简单粗暴的方式进行，但是对于系统长远建设考虑，可先对程序进行垂直拆分，在进行水平拆分，结合业务需求把每个指标的MAX TPS 总结出来，瓶颈明确即可。

  2019-02-13

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244595.jpeg)

  凌寒

  老师好，《复杂度来源：高性能》这一节，讲解的高性能都是从单机系统、服务拆分后系统集群的复杂度；针对高性能的架构设计而言，是否应该增加一些加入缓存系统后数据一致性、数据量增加到一定规模后的性能优化方式引入的复杂度，这样可以和高并发复杂度进行一些区分，也可以引发更多的思考。

  作者回复: 后面有专门讲缓存的

  2019-01-28

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244596.jpeg)![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,w_14.png)

  Geek_fb3db2

  我准备设计一个数据接入平台 主要是完成数据存储和分发 以及查询 请问设计要注意哪些方面和怎么架构。谢谢

  作者回复: 请参考专栏内容自己尝试一下，你说出你的想法我才能帮你审核，我没法直接给你答案

  2019-01-12

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244597.jpeg)

  silence

  为了降低业务复杂度，必须每个岗位的都对自己所属的部门岗位有清晰的定位和认知，明白自己所属业务的瓶颈，然后在不影响其他业务的情况下，使用最适合的方式提高性能，才可以从整体上提升性能，解决复杂度的高性能问题！

  2018-12-17

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244596.jpeg)![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,w_14.png)

  Geek_fb3db2

  堆机器不不能让性能一直上升 ，总会有一个点会让性能下降，这就是边际收益递减原理，而后我们需要从自身应用的角度优化架构，我们目前采用的是单体系统 +集群部署方式

  2018-12-05

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244598.jpeg)

  任重道远

  留言区里出人才，总结很到位！

  2018-11-30

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244599.jpeg)

  Jahng

  系统拆分成子系统也就是很多公司现在做的微服务，系统可以有针对性优化，或者一个业务崩了不影响其他业务，但是相应的运维成本也会变大，对运维工程师要求变高了，还有数据一致性等问题

  2018-11-29

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244131.jpeg)

  俯瞰风景.

  请问，为什么业务越来越复杂,单台机器处理的性能会越来越低呢？具体原因是什么

  作者回复: 代码腐烂，烂代码的影响越来越大，逻辑也越来越复杂

  2018-11-23

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752445100.png)

  oatlmy

  运华老师的课，每一篇我都会把留言刷完。文章很精彩 留言也很棒！

  2018-10-30

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752445101.jpeg)

  AmosWooo

  Java大后端对高性能的见解很赞。以下引用其原文:"什么是“高”性能？这可能是一个动态概念，与当前的技术发展状况与业务所处的阶段紧密相关。比如，现在在行业/企业内部认为的高性能，站在5年后来看，未必是高性能。因此，站在架构师、设计师的角度，高性能需要和业务所处的阶段来衡量。高到什么程度才能与当前或可预见的未来业务增长相匹配。一味去追求绝对意义上的高，没有太大的实际意义。因为，伴随性能越来越高，相应的方法和系统复杂度也是越来越高，而这可能会与当前团队的人力、技术、资源等不相匹配。但是什么才合适的高性能了？这可能需要从国、内外的同行业规模相当、比自己强的竞争者、终端用户使用反馈中获取答案并不断迭代发展。" 自己从业这几年，涉及过传统行业安全类产品，存储类产品，以及当前火热的云产品，一直在思考高性能这个问题: 嫌弃过安全类产品并发量低，只关注安全性稳定性; 对存储产品的并发量以及备份恢复效率表示失望，直到云服务出现，感觉前所未有的兴奋... 到现在深刻体会到架构三原则的核心地位。 非常感谢李老师!

  作者回复: 英雄所见略同😄😄

  2018-10-29

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752445102.jpeg)

  Mr.Lee

  还有一个问题就是任务分配可以和任务分解结合一起来用吧？

  作者回复: 可以的

  2018-10-23

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752445102.jpeg)

  Mr.Lee

  我们是增值税的系统，也是一团糟。系统本身就一堆bug，还要跟税控，会计档案好几个系统之间进行交互，问题就更多了。再加上系统也是有点卡，经常出问题，节点时不时的还会挂掉，头大。目前项目在重构，运用了微服务。话说微服务不就是从任务分解的角度来提升系统性能的吗？

  作者回复: 微服务目的不是为了提升性能，而是为了解决耦合带来的可扩展性问题，微服务做的不好，性能会更低😄

  2018-10-23

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752445103.jpeg)

  allen.huang

  谢谢李老师的好文，我就是对于服务拆分度的把控有点疑惑，经过此文章，算是明白了

  作者回复: 后面有专门讲微服务呢😄

  2018-09-25

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752445104.jpeg)

  Spring

  以下是我从性能提高历程方面对本文的总结:         单机阶段:一开始是手动输入，但cpu处理速度比人工快，就将输入记录在媒介上，然后批量输入。此时cpu还是单个任务串行处理，于是就出现了多进程的概念，多个任务并行执行。但是任务内部还是串行执行，因此就采用多线程，同时执行任务内的不同模块。        多台计算机:由于单机的性能达到瓶颈，因此就采用多台计算机处理任务，采用任务分配器进行分配。当单个任务分配器性能达到上限时，就采用多台任务分配器。随着业务的增多，系统越来越复杂，性能也越来越差，于是就将任务细化，但是粒度并不是越细越好，因为网络通信需要耗费一定的时间，就想缓存无底洞那样，所以要把握好粒度。

  作者回复: 挺好的习惯👍👍👍

  2018-09-19

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752446105.jpeg)

  文竹

  目前所在业务中，高性能的系统采用简单集群方式，一般都是2台机器组成的集群。任务分配器主要使用SLB。不确定SLB是否是任务分配集群。由于业务不复杂，目前还没有对任务进行拆解。 优化的空间在于单台机器的性能，并没有对进程，线程，高并发有深入地思考。

  作者回复: SLB是典型的任务分配方式

  2018-08-14

  **2

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752446106.jpeg)

  @XP

  作为一个安卓开发，算是涨见识了，以前完全不能理解的东西，居然也能听明白了

  作者回复: 可以和后端好好的PK一下了😄😄

  2018-08-09

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752446107.jpeg)

  枪法

  老师讲的挺好的，有二个疑问： 1、协程和纤程没有讲，golang还是升的比较快的； 2、系统不卡的情况下，分模块后的总体处理时间会更长。不卡的时候为方便业务扩展或业务域清晰，按业务拆分。如果服务卡或不可用的时候兼顾业务针对性能瓶颈分拆。

  作者回复: 1. 协程和纤程目前不算普遍和成熟，自己有兴趣可以研究一下 2. 拆分可以很多方式

  2018-07-23

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752446108.jpeg)

  走神儿

  我现在设计的业务系统是根据业务讲系统分为order，shop，system，WeChat等子系统，这几个系统部署在一台虚拟机上，然后扩展为两台做集群，且每个子系统都有自己的数据库。在最初设计的时候它们之间没有相互调用，只由前端和app端进行调用。但是随着业务复杂度的增加，相互调用不可避免，这样是不是到了架构演进的一个节点，比如要保证跨系统的事务、调用的熔断、API的提供者路由等，也就是说到了上服务治理的节点呢？

  作者回复: 可以开始做准备了，因为后续的关系会你越来越密切，交互越来越多

  2018-07-19

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/132-1661794752446109.jpeg)

  乘风

  1.模块分离，职责分离 2.根据模块的特性采用不同的机器，集群 3.加缓存，将延迟保证在可接受的范围 4.对于用户无感知的接口，采用mq，并行结果直接返回，后台串行或并行计算 5.主从+分表

  2018-07-17

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752446110.jpeg)

  Carlos

  我所在业务系统高性能采用的是任务分解加分布式集群的方式。我们所开发的系统基本是给运营商网络工程师使用的，系统最关键的复杂度在于高性能，虽然也做了安全性，高可用的架构设计，但是这不是系统主要瓶颈点所在，大多数时候仅仅是为了投标或者交付前期给客户讲讲系统设计的有多牛逼，后期很少用得到。       据我了解系统的用户主要分为两类，一类是运行商高层，CTO，CTO什么的，这些人会关注系统小时，天，周，月几个粒度的关键KPI报告，了解网络运行情况；另一类为网优人员，这些可能需要每天，或者每周，通过系统报表关联分析，定位分析已知网络问题，并给出优化解决方案。从用户特点可知，系统偶尔宕机，不会对这些客户工作造成大的影响，只要保证做好客户安抚，在尽可能短的时间恢复系统，并将丢失实际补齐即可，所以高可用计算不是系统架构设计的关键复杂度所在。安全性架构也不是关键复杂度所在，因为性能管理系统中包含的敏感数据不多，也不是黑客的主要攻击点，但对于特定几个国家，根据国家安全要求，安全性是首要要求。可扩展性架构我理解不论在哪个阶段都是应该考虑的，方便后期新功能加入和考虑系统容量变大时，无缝切换到其他架构，这一块我们当前系统仅在系统接入侧做了可扩展设计，但是系统内部就相当凌乱不堪了。最关键还是如何保障数据尽可能高的实时性。        我们的系统从大的方向上分为前端和后端。前端的功能主要是报表，Dashboard，告警等可视化模块，我们通常都把这些叫Web，被部署在web容器中，例如jboss，并在仅有的一台web服务器运行，这不是系统能关键性能瓶颈所在；后端功能主要包括数据采集解析和汇总计算，这两个模块是目前系统关键性能瓶颈点所在，并分别采用了分布式的架构设计。数据采集解析按照分布式设计分别被部署在多台服务器上，这些服务器被命名为EAM服务器，包含一台Master和多台Slave,Master机器主要负责任务生成和下发，不具备任务分配功能，任务该在哪台机器上运行，其实是认为划分好的，不用通过负载来自动分配，Slave负责执行实际的采集解析工作。数据汇总计算类似采集解析也被部署在多台服务器上，这些服务器被命名为APP服务器，包含一台Master和多台Slave,Master负责任务决策和任务分配，Slave负责任务执行。数据汇总计算子系统使用了Hadoop大数据生态圈技术，汇总计算本身使用Storm流式处理机制，不同任务被分配到不用worker中来执行，执行完数据存入Hbase，不同类型任务之间通过Kafka消息进行驱动。另外还有汇总计算过程中使用到的模型数据被缓存到Redis中，方便获取。         写到这里系统结构已经非常清晰，根据老师讲解，我来谈谈对这个架构的评价以及存在的问题。这个系统对复杂度判断正确，高性能架构方案也很优秀，但是即使这样在现场使用中还是被各种性能问题所困扰。我理解问题在于公司没有一套标准的编码规范，和代码审查机制，开发人员对编程语言特性，设计模式，内存管理，业务流程理解不够透彻，仅以完成功能开发为目的。导致一线客户在使用过程出现KPI计算不准确，为空等情况，开发人员定位后是由于代码不满足某些特性场景导致，然后又由另外不熟悉业务的开发人员修改代码，导致代码本身攀枝末节，错综复杂，这也是系统内部功能不具备可扩展性的原因。再写一个典型性能问题的发生场景，以某个汇总计算任务为例，第一步收到Kafka消息，第二步根据Kafka消息里的条件字段到oracle中查询Hbase文件key，第三步使用文件key到Hbase读取指定文件，文件中包含网元，时间，指标三部分。第四部，使用for循环读取文件每一样，每个单元格进行求和或平均。最后把汇总结果生成文件存入Hbase,并把Key存入Oracle。这样当客户现网网元数量增加，开启指标增加，for循环次数也跟着增加，性能问题就产生了。或者下层网管系统数据延迟，上个周期，或者上几个周期数据没来，在某一个时刻统一上来了，导致系统在某段时间负荷就会加大，接下来几个周期数据实时性都没发得到比较好的保障。

  作者回复: 架构是系统质量的基础，但好的架构不能保证系统质量，和编码也有很大关系

  2018-07-11

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752446111.jpeg)![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,w_14.png)

  javaworker

  任务分解：类似微信摇一摇等，后面还是会把摇一摇用任务分配的方式通过某种路由规则分配到某台业务服务器的，总觉得任务分解举例是不是hadoope 的map reduce更贴切一些？

  作者回复: map reduce更加难理解😊

  2018-07-05

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752446111.jpeg)![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,w_14.png)

  javaworker

  任务分解：类似微信摇一摇等，后面还是会把摇一摇用任务分配的方式通过某种路由规则分配到某台业务服务器的，总觉得任务分解举例是不是hadoope 的map reduce更贴切一些？

  作者回复: map-reduce是把大任务分解为多个相同的小任务，任务分解是将原来集成在一个系统中的多个不同任务分开为独立的任务

  2018-07-05

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752446110.jpeg)

  Carlos

  李老师，我有个疑惑，实际架构设计中如何做技术选型？比如数据库有Oracle，SQL Server等，是怎么知道Oracle具备哪些特性，而SQL Server不具备，怎么做两个数据库性能对比测试等？

  2018-06-28

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752446112.jpeg)

  张国胜

  两种方式都在使用。先是使用了任务分配，在阿里云上采购一个负载均衡，负载均衡的后段是四台业务处理服务器，然后对业务做了任务分解，在每一台业务处理服务器上面都部署了多个分级后的任务模块。以达到满足当前性能的要求。当前我们的性能处理大概是500次每秒的请求。

  作者回复: 如果单纯为了性能，四台服务器的规模，任务分解可能有点过度设计，如果是为了稳定性等那就没问题

  2018-06-28

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752446113.jpeg)

  水月洞天

  我们目前的系统，高性能提现在静态资源获取的性能和业务投标的高性能。前者我们才用了资源压缩节省空间的方式和分布式内容分发cdn。后者考虑到瞬时高并发问题，采用了内存缓存。由于当前用户在7000左右，还没有扩展为多服务器，接下来这是我们改进的方向。考虑到实现首先我们会考虑业务拆分。

  作者回复: 我感觉不用为了性能扩展，为了可靠性扩展可以考虑一下

  2018-06-10

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752446114.jpeg)

  火山飘雪

  做传统银行系统的，现在做的系统感觉很不合理，一是所有的东西都堆在一个系统中，经常出现上传下载图片的小功能出站问题，导致整个系统很慢;二这个系统和其它系统见存在循环调用的情况，比A系统先调用B系统，B系统再反调A系统业务才算完成。

  作者回复: 赶紧拆分，按照任务分解的方式，拆分成几个子系统

  2018-06-04

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752446115.png)

  代码狂徒

  您好，针对文章中任务分配到任务分解的地方不太明白，任务分解的时候将下层业务系统进行了分解降低了复杂度，但上层任务分配器是如何降低复杂度的呢？流量依然是通过上层分流的吗？这样不是更复杂的网状结构吗？

  作者回复: 任务分配器没有降低复杂度，而是为了高性能引入了复杂度

  2018-06-04

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752446116.jpeg)

  Tony

  醍醐灌顶，受益匪浅！ 我反复咀嚼了3遍！

  2018-05-28

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752446117.jpeg)

  Joker

  Redis单进程还是做了取舍，毕竟支持的数据格式比mc复杂，如果多进程务必增加数据一致性的复杂度，实现起来就不那么容易了，但是单进程对于多核机器无法达到耗死的状态！

  作者回复: 所以我们只能一台机器部署很多redis

  2018-05-24

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-16617947524384.jpeg)![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,w_14.png)

  pavel

  我们的业务系统，简单的按业务分为用户模块，后台管理模块，公众号模块。其中，用户模块细分为用户信息管理，用户账号管理，报表查看。之所以这么分，第一是为了职责分离，开发效率提升。第二是将报表等重IO查询的分离出来，以后好做扩展。目前存在的问题是数据层的分离。我们有大量数据需要实时写入和查询，这块如何优化呢？老师能否指导下。

  作者回复: 首先，你要量化“大量”到底是多少，有的人认为一天1G就很大了，有的人认为1天1T才算大量 其次，实时写入和查询有很多方案，mysql，es，hbase都可以，关键是要符合你的场景，例如：写入后还能修改么？是什么样的查询？实时要求有多高？……等等，需要你根据业务场景分析选择

  2018-05-22

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752446118.jpeg)

  孙振超

  除了前面讲了些性能的问题，后面更多的是关于系统容量问题，性能应该是说这一次请求的耗时，高性能意味着耗时的变短，而关于这一部分涉及的不多，通过添加更多的服务器 、业务拆分等方式在提升系统容量的同时请求的耗时其实是变长了。

  2018-05-20

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752446119.jpeg)

  kilroy_c

  个人感觉任务拆分是一门艺术，很多公司都是为了拆分而拆分，边界划分不合理，随着项目推进模块之间开始交融或者重复调用

  作者回复: 架构设计很多地方都是艺术😃

  2018-05-19

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752446120.jpeg)

  交叉路口

  redis 单进程单线程？😂只知道redis 操作原子性

  作者回复: redis的原子性就是因为是单进程

  2018-05-19

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752446121.jpeg)

  missa

  目前使用的任务拆分的方式，在每个拆分出来的任务中会有任务分配这种。

  2018-05-18

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752446122.jpeg)![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,w_14.png)

  Yangjing![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/d57fddfa5b2c2ce3071e92304da8af62.png)

  拆分主要是为了维护 扩展，降低系统复杂度。这个拆分粒度应该怎么去考虑呢？ 有没有指标或者判断的标准？

  作者回复: 后面会讲

  2018-05-16

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752446123.jpeg)

  志新

  总结： 高性能带来的是业务复杂性的提升 业务复杂提升，可将业务进行拆分达到简单的目的 拆分不可过细，带来的影响是各个系统之间调研过多导致性能下降。

  2018-05-15

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752447124.jpeg)

  Sruby

  估值核算系统，性能瓶颈在估值核算部分。原来的是单体应用，现在把估值核算相关任务与中台应用拆分开了。估值核算中的很多任务调度使用xxl-job做分布式任务调度，充分利用现有的6台机器性能。

  2018-05-15

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752447125.jpeg)

  日光倾城

  你所在的业务体系中，高性能的系统采用的是哪种方式？目前是否有改进和提升的空间？ 业务模块拆分，各模块按业务量大小决定单机/集群部署，各模块之间通过dubbo调度。目前也是感觉模块分得太细，调用复杂

  2018-05-12

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752447126.jpeg)

  summer

  提问：任务分解可带来高性能这点论证有些牵强。任务分解可以便于发现性能瓶颈,便于修改性能瓶颈。“便于发现”，“便于修改”都不是提高性能本身吧？

  作者回复: 简单的系统更容易做到高性能

  2018-05-11

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752447127.jpeg)

  anchor

  一般的企业服务做到服务集群部署，数据库读写分离，已经能支撑一定业务量了，再后面分库分表，服务拆分都难有这业务量，而且做这些人力等资源不小

  作者回复: 大部分情况做到这个已经够了

  2018-05-09

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752447128.jpeg)

  快乐的小傻子

  疑问1:代码结构相同，应用代码common相同的两个业务，是放在一起好呢？还是分开来处理好呢？

  2018-05-09

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752447129.jpeg)

  小飞哥 ‍超級會員

  我是搞电商系统的，经历了从一个系统拆分出十个子系统。在老系统中一两个方法就分成一个系统，为了是业务相互不影响和对人员的深入，对业务理解和系统稳定而拆分。系统与系统的相互调用没发生改变，在每个系统的业务处理上得到扩展！，

  2018-05-09

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752447130.jpeg)

  Kevin

  老师可以讲一些典型电商的架构不，比如秒杀等等

  作者回复: 这类案例互联网一搜一大把，我是希望通过我的架构方法论，能让大家真正理解这些案例，从而能够让自己也能设计出类似架构，而不是简单照搬其它架构

  2018-05-08

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244135.jpeg)

  sam

  总结一下所得，性能复杂度主要体现在单台计算机和多台计算机集群两方面。单机复杂度主要考虑多进程、多线程、进程间通信、多线程并发等技术点。集群主要考虑任务分配和任务分解，并且要把握好粒度，逼近性能极限。

  2018-05-08

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752447131.jpeg)

  ZYCHD(子玉)

  我们的系统是公司内部的业务系统，系统出现性能瓶颈大多只是在某个时间段出现，一年也就出现过几次。需要您说的这种架构吗？您介绍的架构很好，不过假如我们系统也这样做就显得资源浪费了。

  作者回复: 首先看是否满足业务需求，不要过度设计

  2018-05-08

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752447132.jpeg)

  孙晓明

  一、体会：软件系统为了高性能可能会带来复杂度的增加，需在高性能与复杂度直接进行权衡，综合考虑成本、运维、风险等问题，避免为了追求高性能导致系统复杂度太高。 二、我接触过的系统中，在高性能方面：1、数据库采用集群设计，也有的时候使用读写分离；2、缓存服务器单独部署；3、应用服务器分层开发和部署，并使用集群；4、负载均衡采用过F5、Weblogic等。

  2018-05-08

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752447133.jpeg)![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,w_14.png)

  sonald

  100个子系统耗时就149ms吗？取决于互联方式和调用模式吧。如果一个子系统并发的从其他99个子系统请求，就少于149了吧。您这里单指子系统串联的情况吗？

  2018-05-08

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752447134.jpeg)

  HARDMAN

  感谢老师回复。目前似乎系统不支持直接回复之前的问题解答，所以只能重新提问了。听您讲解之后感觉一些宏观的原理是明白了，但是如果要自己短时间搭建一个高性能的系统似乎还有不小的距离，下一步该怎么学习？能短时间突破吗？

  2018-05-08

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752447134.jpeg)

  HARDMAN

  请问老师，对于一个电商网站，单台服务器的并发用户数能达到一万吗？十万？单台服务器的并发用户数，连接数计算的方法或者依据是什么？

  作者回复: 不能简单参考一个数字，和业务复杂度有关，而且并发用户数和并发请求数不完全等同，基本上上万是很难的，因为mc和redis这种功能简单的中间件，并发请求数也就每秒3万左右

  2018-05-07

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752447135.jpeg)

  王磊

  我们的系统采用了一个基于netty的NIO框架VertX来用少量的线程服务更多的请求，提高线程利用率; 使用Redis作为缓存服务器和预加载的方式，提高响应时间，减少数据库的访问;使用分布式锁控制相同请求只有一个落库查询;优化数据库，提高数据库查询性能。

  作者回复: VertX是异步编程框架吧？我觉得有点杀鸡用牛刀的感觉😂

  2018-05-07

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752447136.jpeg)

  唐昴星

  举一个最简单的例子：Nginx 可以用多进程也可以用多线程，JBoss 采用的是多线程；Redis 采用的是单进程，Memcache 采用的是多线程 我的意思是说，在这个语言环境下，强调redis采用的是单线程的模式是不是好一些

  作者回复: 嗯，没问题，能理解就可以了

  2018-05-07

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752447136.jpeg)

  唐昴星

  redis是单线程吧

  作者回复: 单进程

  2018-05-07

  **2

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752447137.jpeg)

  曲大伟

  总体方法论不错，期待能深入到实战，对提高性能的相关方法和工具做个介绍。

  作者回复: 后面有详细的章节介绍

  2018-05-07

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752447138.jpeg)

  Geek_b04b12

  全球三个数据中心，都是单机，数据要保持一致，后期根据用户的请求扩展服务器，区域不同定位到不同数据中心(就近原则:智能DNS，CDn)等，会考虑使用好可用，前期有没有比较好的方案，让三个数据库一致保持一致？并能够进行监控处理？

  2018-05-06

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752447139.jpeg)

  带刺的温柔

  分析出系统的复杂度可以通过调度、拆分来提高性能，在一定的约束框架内比如说内存 CPU io 网络等通过各种方法比如说算法 数据结构等降低系统的复杂度简化系统来达到提高性能。不明白的是高性能有没有标准

  作者回复: 满足业务需求就是高性能第一标准

  2018-05-06

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752447140.jpeg)

  碧海蓝天

  我们业务是新项目，现在是单机单块，但系统内部仿微服务做的模块化设计，与微服务的区别是模块之间是进程内接口调用而不是IPC。现在也做到了前后端分离，服务层无状态。后面的性能提升思路是单机做到极致，然后拆成微服务，再多实例。

  2018-05-06

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752447141.jpeg)![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,w_14.png)

  聂明星

  本人架构初学者，对负载均衡单点问题和性能瓶颈问题想了解一下具体要怎么处理，对于单点问题我能想到的就是利用keepalived来达到负载均衡器高可用的目的，对于负载均衡性能瓶颈只能想到用DNS来分流，不知道我的方案是否可行，由于公司对于架构方面不是很重视只能自己在网上搜集资料，在这想了解一下大公司针对这类问题是怎么处理的是否有一套标准的处理方案和流程。

  作者回复: 最后的几篇就是讲互联网大公司的标准技术栈

  2018-05-06

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752448142.jpeg)

  xhrg

  作者本文讲的是架构复杂度的原因之一   ，性能。文中讲了性能问题的来源和两个解决办法，1，任务分配。2，任务分解。 1，任务分配主要是集群，通过多台主机处理业务。这里的任务分配可以理解为，所有的业务在一台主机，把这样的主机复制多台。2，任务分解，任务分解指的是业务拆分，业务拆分可以更好的找到系统瓶颈，可以更有利于代码优化。 以上，就是我学到的，谢谢作者，谢谢。

  2018-05-06

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752448143.jpeg)

  小叶子

  我不是开发者，问题比较初级，感谢支持！ 1.为了实现高性能需要进行任务分解（不同应用服务器，文件服务器，数据库） 2.为了实现各个服务器的独立弹性扩展，可用性，应用服务器不能保存数据，这个我理解不太好。 用户通过反向代理把请求输入，应用服务器一般都做哪些工作，帮忙举几个例子

  2018-05-06

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-166179475244245.jpeg)

  smiledou123

  假设这些系统采用 IP 网络连接，理想情况下一次请求和响应在网络上耗费为 1ms，业务处理本身耗时为 50ms。我们也假设系统拆分对单个业务请求性能没有影响，那么系统拆分为 2 个子系统的时候，处理一次用户访问耗时为 51ms；而系统拆分为 100 个子系统的时候，处理一次用户访问耗时竟然达到了 149ms。这是怎么计算的？为何是149ms？我看不懂

  作者回复: 100个子系统中间有99条网络连接

  2018-05-05

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752448144.jpeg)![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,w_14.png)

  赵龙

  老师，我们公司目前给各家医院的某个科室做系统，每家医院除了公共需求外都存在一些个性化的需求，目前我们是开了很多分支，每家医院针对一个版本分支进行开发。新合作一家医院确定需求后找一个相似的版本分支再开出一个版本分支进行开发，能从架构设计上弄成一个产品级的系统吗，通过不同配置给各家医院进行使用，如果这样做，前期整体规划会花大量时间吧

  作者回复: 后面可扩展性章节会涉及

  2018-05-05

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752448145.jpeg)

  Dylan

  高性能分为两方面：快-单任务处理速度要快；多-系统单位时间内处理的任务数量要多。快可以通过优化程序，提高硬件，更改操作系统参数等方式来提升；多除了上面的方面还可以通过增加机器，将任务分解到不同机器上处理来提高。任务如何分解，系统如何交互以及复杂度的主要方面都是需要架构师来做分析与权衡的。

  2018-05-05

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752448146.jpeg)

  OnE

  单个机器为了高性能，所以出现了进程、线程，那现在出现的协程是如何提高性能的呢？

  作者回复: 协程可以简单理解为用户态的线程，协程切换是用户态的任务切换，性能消耗比线程切换更低

  2018-05-05

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752448147.jpeg)

  松涛

  假如有以下业务场景： X系统为企业系统，根据业务拆分出以下两个系统。 A系统为人事系统 B系统为绩效系统（考勤，项目，积分等等）  B系统的人事数据以及考勤等部分数据都是来自于拆分后的A系统，这些时候是不是不太合理呢？拆出来后系统的耦合度还是挺好的，但是根据业务情况，好像也没有错。不知华哥你怎么看？

  作者回复: 考勤系统依赖人事系统是正确的，但别直连数据库，用接口进行访问

  2018-05-05

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752448148.jpeg)

  天使

  如何挖掘单机性能极限？如何挖掘分布式系统性能极限？这个会讲到吗？或者老师能推荐若干性能测试的好书吗？:D 

  作者回复: 具体某个领域技术细节不会涉及，这里面每个领域都足够写一本书了。 性能测试我做过，但并不专业，还请你看看能否找到专业人员请教一下。

  2018-05-05

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752448149.jpeg)

  亚伦碎语

  按业务拆分，也就是微服务吧，从方法调用变为服务间的调用，怎么处理错误等情况也是复杂度提升的一个表现

  作者回复: 都是拆分，但拆分的维度和粒度不同

  2018-05-05

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752448149.jpeg)

  亚伦碎语

  按业务拆分，也就是微服务吧，从方法调用变为服务间的调用，怎么处理错误等情况也是复杂度提升的一个表现

  2018-05-05

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752448150.jpeg)

  zt_soft

  大神，传统软件开发的我主要面对是业务的复杂度，不知道这算架构师的工作么，还是那叫业务架构师😓

  作者回复: 肯定算，业务复杂度也不简单，后面会讲到

  2018-05-05

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752448151.jpeg)

  Regular

  计算机一次只能执行一个任务，如果某个任务需要从 I/O 设备（例如磁带）读取大量的数据，在 I/O 操作的过程中，CPU 其实是空闲的？

  2018-05-05

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752448152.jpeg)

  李艳超_Harry

  拆分粒度是一个问题。拆分时候有些功能放到a可以，放b、c、d也可以。这些拆分还涉及到团队和人员安排

  2018-05-05

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752448153.jpeg)

  hello

  目前我们主要业务系统是主要通过堆机器的方式来提升服务处理性能，现在想通过进一步拆分服务的方式来解决一些问题。文中只是定性分析了拆分的准则，能不能分享些可实操量化的拆分经验？文中所提的拆分，是不是就是微服务化？

  作者回复: 后面大量章节会讲高性能高可用怎么做

  2018-05-05

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752448154.jpeg)

  feifei

  以nginx做负载中心，集群化业务服务

  2018-05-05

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752448155.jpeg)![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,w_14.png)

  张志攀

  曾经接触过两类系统，一类是读多写少的，这类系统高性能通过系统服务化拆份和多级分布式缓存来抗住高QPS另外一类是交易型统，我们做法是服务化拆份和分库分表来抗住高并发写的，数据一致性采用最终一致性。谢谢！！

  2018-05-05

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752448156.jpeg)

  rubin

  学习了，目前接触的大多是ngnix下挂接口服务和后台服务，mysql做个主从，再加个redis，基本就满足了当前业务。没有接触过根据业务结点作分层，不知道如何提高这方面的能力

  2018-05-05

  **1

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752448157.jpeg)

  成功

  这课讲的很深入而且落地，在这个互联网+，大数据的技术背景下，集群模式的多机复杂度越来越主流。我感觉两个点尤为重要，1)任务分配器(流控，HAproxy，nginx)的选型和设计(多对多)。2)就是任务的分解，如何最优的平衡业务级应用服务批和网络通信的关系，期待下一讲

  2018-05-05

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752448158.jpeg)![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,w_14.png)

  万里晴空

  我们系统对性能要求很高，但是从以前的架构和业务设计，导致从程序上无法提升，现在处理方式就是多节点和增加物理机提升。只能临时解决，目前因为这个需要重构系统，听你讲解可以将系统内拆分出适当的几个子系统。业务是根据时间段来放开学生和老师填不同维度的数据，在某个阶段，每天的活跃量在10w以上（后期会很多），而这些数据有可能需求变更或新增维度，目前新架构设计出来的是用业务模型和布局来灵活可配置。从实现上研发前期可能会投入更多的时间是人工配置了，更别说权限和菜单的控制了。想换一种方式来解决这种问题，希望可以给一个灵感

  2018-05-05

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752448159.jpeg)

  Mike Wang

  任务分解和分配都有用到，任务分配用到dns，nginx，haproxy，还有注册发现类的一些组件；任务分解按交易流程划分为多个服务使用grpc进行调用，主要有账户服务、交易服务，订单服务、推送服务等

  2018-05-05

  **

  **

- ![img](04%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%9D%A5%E6%BA%90%EF%BC%9A%E9%AB%98%E6%80%A7%E8%83%BD.resource/resize,m_fill,h_34,w_34-1661794752448160.jpeg)

  蓝皮

  任务拆分并非越细越好，但是要怎么分析出当前系统拆多细是最好的呢？

  2018-05-05

  **

  **
