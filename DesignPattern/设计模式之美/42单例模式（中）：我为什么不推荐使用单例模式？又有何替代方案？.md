# 42å•ä¾‹æ¨¡å¼ï¼ˆä¸­ï¼‰ï¼šæˆ‘ä¸ºä»€ä¹ˆä¸æŽ¨èä½¿ç”¨å•ä¾‹æ¨¡å¼ï¼Ÿåˆæœ‰ä½•æ›¿ä»£æ–¹æ¡ˆï¼Ÿ

ä¸Šä¸€èŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ä¸¤ä¸ªå®žæˆ˜æ¡ˆä¾‹ï¼Œè®²è§£äº†å•ä¾‹æ¨¡å¼çš„ä¸€äº›åº”ç”¨åœºæ™¯ï¼Œæ¯”å¦‚ï¼Œé¿å…èµ„æºè®¿é—®å†²çªã€è¡¨ç¤ºä¸šåŠ¡æ¦‚å¿µä¸Šçš„å…¨å±€å”¯ä¸€ç±»ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å­¦ä¹ äº† Java è¯­è¨€ä¸­ï¼Œå•ä¾‹æ¨¡å¼çš„å‡ ç§å®žçŽ°æ–¹æ³•ã€‚å¦‚æžœä½ ç†Ÿæ‚‰çš„æ˜¯å…¶ä»–ç¼–ç¨‹è¯­è¨€ï¼Œä¸çŸ¥é“ä½ è¯¾åŽæœ‰æ²¡æœ‰è‡ªå·±åŽ»å¯¹ç…§ç€å®žçŽ°ä¸€ä¸‹å‘¢ï¼Ÿ

å°½ç®¡å•ä¾‹æ˜¯ä¸€ä¸ªå¾ˆå¸¸ç”¨çš„è®¾è®¡æ¨¡å¼ï¼Œåœ¨å®žé™…çš„å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿç¡®å®žç»å¸¸ç”¨åˆ°å®ƒï¼Œä½†æ˜¯ï¼Œæœ‰äº›äººè®¤ä¸ºå•ä¾‹æ˜¯ä¸€ç§åæ¨¡å¼ï¼ˆanti-pattern)ï¼Œå¹¶ä¸æŽ¨èä½¿ç”¨ã€‚æ‰€ä»¥ï¼Œä»Šå¤©ï¼Œæˆ‘å°±é’ˆå¯¹è¿™ä¸ªè¯´æ³•è¯¦ç»†åœ°è®²è®²è¿™å‡ ä¸ªé—®é¢˜ï¼šå•ä¾‹è¿™ç§è®¾è®¡æ¨¡å¼å­˜åœ¨å“ªäº›é—®é¢˜ï¼Ÿä¸ºä»€ä¹ˆä¼šè¢«ç§°ä¸ºåæ¨¡å¼ï¼Ÿå¦‚æžœä¸ç”¨å•ä¾‹ï¼Œè¯¥å¦‚ä½•è¡¨ç¤ºå…¨å±€å”¯ä¸€ç±»ï¼Ÿæœ‰ä½•æ›¿ä»£çš„è§£å†³æ–¹æ¡ˆï¼Ÿ

è¯ä¸å¤šè¯´ï¼Œè®©æˆ‘ä»¬å¸¦ç€è¿™äº›é—®é¢˜ï¼Œæ­£å¼å¼€å§‹ä»Šå¤©çš„å­¦ä¹ å§ï¼

# å•ä¾‹å­˜åœ¨å“ªäº›é—®é¢˜?

å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åœ¨é¡¹ç›®ä¸­ä½¿ç”¨å•ä¾‹ï¼Œéƒ½æ˜¯ç”¨å®ƒæ¥è¡¨ç¤ºä¸€äº›å…¨å±€å”¯ä¸€ç±»ï¼Œæ¯”å¦‚é…ç½®ä¿¡æ¯ ç±»ã€è¿žæŽ¥æ± ç±»ã€ID ç”Ÿæˆå™¨ç±»ã€‚å•ä¾‹æ¨¡å¼ä¹¦å†™ç®€æ´ã€ä½¿ç”¨æ–¹ä¾¿ï¼Œåœ¨ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä¸éœ€è¦åˆ›å»ºå¯¹è±¡ï¼Œç›´æŽ¥é€šè¿‡ç±»ä¼¼ IdGenerator.getInstance().getId() è¿™æ ·çš„æ–¹æ³•æ¥è°ƒç”¨å°±å¯ä»¥äº†ã€‚ä½†æ˜¯ï¼Œè¿™ç§ä½¿ç”¨æ–¹æ³•æœ‰ç‚¹ç±»ä¼¼ç¡¬ç¼–ç ï¼ˆhard codeï¼‰ï¼Œä¼šå¸¦æ¥è¯¸å¤šé—®é¢˜ã€‚æŽ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±å…·ä½“çœ‹çœ‹åˆ°åº•æœ‰å“ªäº›é—®é¢˜ã€‚

## å•ä¾‹å¯¹ OOP ç‰¹æ€§çš„æ”¯æŒä¸å‹å¥½

æˆ‘ä»¬çŸ¥é“ï¼ŒOOP çš„å››å¤§ç‰¹æ€§æ˜¯å°è£…ã€æŠ½è±¡ã€ç»§æ‰¿ã€å¤šæ€ã€‚å•ä¾‹è¿™ç§è®¾è®¡æ¨¡å¼å¯¹äºŽå…¶ä¸­çš„æŠ½è±¡ã€ç»§æ‰¿ã€å¤šæ€éƒ½æ”¯æŒå¾—ä¸å¥½ã€‚ä¸ºä»€ä¹ˆè¿™ä¹ˆè¯´å‘¢ï¼Ÿæˆ‘ä»¬è¿˜æ˜¯é€šè¿‡ IdGenerator è¿™ä¸ªä¾‹å­æ¥è®²è§£ã€‚

```java
public class Order {
    public void create(...) {
        //...
        long id = IdGenerator.getInstance().getId();
        //...
    }
} 

public class User {
    public void create(...) {
        // ...
        long id = IdGenerator.getInstance().getId();
        //...
    }
}
```

IdGenerator çš„ä½¿ç”¨æ–¹å¼è¿èƒŒäº†åŸºäºŽæŽ¥å£è€Œéžå®žçŽ°çš„è®¾è®¡åŽŸåˆ™ï¼Œä¹Ÿå°±è¿èƒŒäº†å¹¿ä¹‰ä¸Šç†è§£çš„OOP çš„æŠ½è±¡ç‰¹æ€§ã€‚å¦‚æžœæœªæ¥æŸä¸€å¤©ï¼Œæˆ‘ä»¬å¸Œæœ›é’ˆå¯¹ä¸åŒçš„ä¸šåŠ¡é‡‡ç”¨ä¸åŒçš„ ID ç”Ÿæˆç®—æ³•ã€‚æ¯”å¦‚ï¼Œè®¢å• ID å’Œç”¨æˆ· ID é‡‡ç”¨ä¸åŒçš„ ID ç”Ÿæˆå™¨æ¥ç”Ÿæˆã€‚ä¸ºäº†åº”å¯¹è¿™ä¸ªéœ€æ±‚å˜åŒ–ï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹æ‰€æœ‰ç”¨åˆ° IdGenerator ç±»çš„åœ°æ–¹ï¼Œè¿™æ ·ä»£ç çš„æ”¹åŠ¨å°±ä¼šæ¯”è¾ƒå¤§ã€‚

```java
public class Order {
    public void create(...) {
        //...
        long id = IdGenerator.getInstance().getId();
        // éœ€è¦å°†ä¸Šé¢ä¸€è¡Œä»£ç ï¼Œæ›¿æ¢ä¸ºä¸‹é¢ä¸€è¡Œä»£ç 
        long id = OrderIdGenerator.getIntance().getId();
        //...
    }
} 

public class User {
    public void create(...) {
        // ...
        long id = IdGenerator.getInstance().getId();
        // éœ€è¦å°†ä¸Šé¢ä¸€è¡Œä»£ç ï¼Œæ›¿æ¢ä¸ºä¸‹é¢ä¸€è¡Œä»£ç 
        long id = UserIdGenerator.getIntance().getId();
    }
}
```

é™¤æ­¤ä¹‹å¤–ï¼Œå•ä¾‹å¯¹ç»§æ‰¿ã€å¤šæ€ç‰¹æ€§çš„æ”¯æŒä¹Ÿä¸å‹å¥½ã€‚è¿™é‡Œæˆ‘ä¹‹æ‰€ä»¥ä¼šç”¨â€œä¸å‹å¥½â€è¿™ä¸ªè¯ï¼Œ è€Œéžâ€œå®Œå…¨ä¸æ”¯æŒâ€ï¼Œæ˜¯å› ä¸ºä»Žç†è®ºä¸Šæ¥è®²ï¼Œå•ä¾‹ç±»ä¹Ÿå¯ä»¥è¢«ç»§æ‰¿ã€ä¹Ÿå¯ä»¥å®žçŽ°å¤šæ€ï¼Œåªæ˜¯å®žçŽ°èµ·æ¥ä¼šéžå¸¸å¥‡æ€ªï¼Œä¼šå¯¼è‡´ä»£ç çš„å¯è¯»æ€§å˜å·®ã€‚ä¸æ˜Žç™½è®¾è®¡æ„å›¾çš„äººï¼Œçœ‹åˆ°è¿™æ ·çš„è®¾è®¡ï¼Œ ä¼šè§‰å¾—èŽ«åå…¶å¦™ã€‚æ‰€ä»¥ï¼Œä¸€æ—¦ä½ é€‰æ‹©å°†æŸä¸ªç±»è®¾è®¡æˆåˆ°å•ä¾‹ç±»ï¼Œä¹Ÿå°±æ„å‘³ç€æ”¾å¼ƒäº†ç»§æ‰¿å’Œå¤šæ€è¿™ä¸¤ä¸ªå¼ºæœ‰åŠ›çš„é¢å‘å¯¹è±¡ç‰¹æ€§ï¼Œä¹Ÿå°±ç›¸å½“äºŽæŸå¤±äº†å¯ä»¥åº”å¯¹æœªæ¥éœ€æ±‚å˜åŒ–çš„æ‰©å±•æ€§ã€‚

## å•ä¾‹ä¼šéšè—ç±»ä¹‹é—´çš„ä¾èµ–å…³ç³»

æˆ‘ä»¬çŸ¥é“ï¼Œä»£ç çš„å¯è¯»æ€§éžå¸¸é‡è¦ã€‚åœ¨é˜…è¯»ä»£ç çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¸Œæœ›ä¸€çœ¼å°±èƒ½çœ‹å‡ºç±»ä¸Žç±»ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œæžæ¸…æ¥šè¿™ä¸ªç±»ä¾èµ–äº†å“ªäº›å¤–éƒ¨ç±»ã€‚

é€šè¿‡æž„é€ å‡½æ•°ã€å‚æ•°ä¼ é€’ç­‰æ–¹å¼å£°æ˜Žçš„ç±»ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œæˆ‘ä»¬é€šè¿‡æŸ¥çœ‹å‡½æ•°çš„å®šä¹‰ï¼Œå°±èƒ½å¾ˆå®¹æ˜“è¯†åˆ«å‡ºæ¥ã€‚ä½†æ˜¯ï¼Œå•ä¾‹ç±»ä¸éœ€è¦æ˜¾ç¤ºåˆ›å»ºã€ä¸éœ€è¦ä¾èµ–å‚æ•°ä¼ é€’ï¼Œåœ¨å‡½æ•°ä¸­ç›´æŽ¥è°ƒç”¨å°±å¯ä»¥äº†ã€‚å¦‚æžœä»£ç æ¯”è¾ƒå¤æ‚ï¼Œè¿™ç§è°ƒç”¨å…³ç³»å°±ä¼šéžå¸¸éšè”½ã€‚åœ¨é˜…è¯»ä»£ç çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±éœ€è¦ä»”ç»†æŸ¥çœ‹æ¯ä¸ªå‡½æ•°çš„ä»£ç å®žçŽ°ï¼Œæ‰èƒ½çŸ¥é“è¿™ä¸ªç±»åˆ°åº•ä¾èµ–äº†å“ªäº›å•ä¾‹ç±»ã€‚

## å•ä¾‹å¯¹ä»£ç çš„æ‰©å±•æ€§ä¸å‹å¥½

æˆ‘ä»¬çŸ¥é“ï¼Œå•ä¾‹ç±»åªèƒ½æœ‰ä¸€ä¸ªå¯¹è±¡å®žä¾‹ã€‚å¦‚æžœæœªæ¥æŸä¸€å¤©ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ä»£ç ä¸­åˆ›å»ºä¸¤ä¸ªå®žä¾‹æˆ–å¤šä¸ªå®žä¾‹ï¼Œé‚£å°±è¦å¯¹ä»£ç æœ‰æ¯”è¾ƒå¤§çš„æ”¹åŠ¨ã€‚ä½ å¯èƒ½ä¼šè¯´ï¼Œä¼šæœ‰è¿™æ ·çš„éœ€æ±‚å—ï¼Ÿæ—¢ç„¶å•ä¾‹ç±»å¤§éƒ¨åˆ†æƒ…å†µä¸‹éƒ½ç”¨æ¥è¡¨ç¤ºå…¨å±€ç±»ï¼Œæ€Žä¹ˆä¼šéœ€è¦ä¸¤ä¸ªæˆ–è€…å¤šä¸ªå®žä¾‹å‘¢ï¼Ÿ

å®žé™…ä¸Šï¼Œè¿™æ ·çš„éœ€æ±‚å¹¶ä¸å°‘è§ã€‚æˆ‘ä»¬æ‹¿æ•°æ®åº“è¿žæŽ¥æ± æ¥ä¸¾ä¾‹è§£é‡Šä¸€ä¸‹ã€‚

åœ¨ç³»ç»Ÿè®¾è®¡åˆæœŸï¼Œæˆ‘ä»¬è§‰å¾—ç³»ç»Ÿä¸­åªåº”è¯¥æœ‰ä¸€ä¸ªæ•°æ®åº“è¿žæŽ¥æ± ï¼Œè¿™æ ·èƒ½æ–¹ä¾¿æˆ‘ä»¬æŽ§åˆ¶å¯¹æ•°æ®åº“è¿žæŽ¥èµ„æºçš„æ¶ˆè€—ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬æŠŠæ•°æ®åº“è¿žæŽ¥æ± ç±»è®¾è®¡æˆäº†å•ä¾‹ç±»ã€‚ä½†ä¹‹åŽæˆ‘ä»¬å‘çŽ°ï¼Œç³»ç»Ÿä¸­æœ‰äº› SQL è¯­å¥è¿è¡Œå¾—éžå¸¸æ…¢ã€‚è¿™äº› SQL è¯­å¥åœ¨æ‰§è¡Œçš„æ—¶å€™ï¼Œé•¿æ—¶é—´å ç”¨æ•°æ®åº“è¿žæŽ¥èµ„æºï¼Œå¯¼è‡´å…¶ä»– SQL è¯·æ±‚æ— æ³•å“åº”ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¸Œæœ›å°†æ…¢ SQL ä¸Žå…¶ä»– SQL éš”ç¦»å¼€æ¥æ‰§è¡Œã€‚ä¸ºäº†å®žçŽ°è¿™æ ·çš„ç›®çš„ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç³»ç»Ÿä¸­åˆ›å»ºä¸¤ä¸ªæ•°æ®åº“è¿žæŽ¥æ± ï¼Œæ…¢ SQL ç‹¬äº«ä¸€ä¸ªæ•°æ®åº“è¿žæŽ¥æ± ï¼Œå…¶ä»– SQL ç‹¬äº«å¦å¤–ä¸€ä¸ªæ•°æ®åº“è¿žæŽ¥æ± ï¼Œè¿™æ ·å°±èƒ½é¿å…æ…¢ SQL å½±å“åˆ°å…¶ä»– SQL çš„æ‰§è¡Œã€‚

å¦‚æžœæˆ‘ä»¬å°†æ•°æ®åº“è¿žæŽ¥æ± è®¾è®¡æˆå•ä¾‹ç±»ï¼Œæ˜¾ç„¶å°±æ— æ³•é€‚åº”è¿™æ ·çš„éœ€æ±‚å˜æ›´ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå•ä¾‹ç±»åœ¨æŸäº›æƒ…å†µä¸‹ä¼šå½±å“ä»£ç çš„æ‰©å±•æ€§ã€çµæ´»æ€§ã€‚æ‰€ä»¥ï¼Œæ•°æ®åº“è¿žæŽ¥æ± ã€çº¿ç¨‹æ± è¿™ç±»çš„èµ„æº æ± ï¼Œæœ€å¥½è¿˜æ˜¯ä¸è¦è®¾è®¡æˆå•ä¾‹ç±»ã€‚å®žé™…ä¸Šï¼Œä¸€äº›å¼€æºçš„æ•°æ®åº“è¿žæŽ¥æ± ã€çº¿ç¨‹æ± ä¹Ÿç¡®å®žæ²¡æœ‰è®¾è®¡æˆå•ä¾‹ç±»ã€‚

## å•ä¾‹å¯¹ä»£ç çš„å¯æµ‹è¯•æ€§ä¸å‹å¥½

å•ä¾‹æ¨¡å¼çš„ä½¿ç”¨ä¼šå½±å“åˆ°ä»£ç çš„å¯æµ‹è¯•æ€§ã€‚å¦‚æžœå•ä¾‹ç±»ä¾èµ–æ¯”è¾ƒé‡çš„å¤–éƒ¨èµ„æºï¼Œæ¯”å¦‚ DBï¼Œ æˆ‘ä»¬åœ¨å†™å•å…ƒæµ‹è¯•çš„æ—¶å€™ï¼Œå¸Œæœ›èƒ½é€šè¿‡ mock çš„æ–¹å¼å°†å®ƒæ›¿æ¢æŽ‰ã€‚è€Œå•ä¾‹ç±»è¿™ç§ç¡¬ç¼–ç å¼çš„ä½¿ç”¨æ–¹å¼ï¼Œå¯¼è‡´æ— æ³•å®žçŽ° mock æ›¿æ¢ã€‚

é™¤æ­¤ä¹‹å¤–ï¼Œå¦‚æžœå•ä¾‹ç±»æŒæœ‰æˆå‘˜å˜é‡ï¼ˆæ¯”å¦‚ IdGenerator ä¸­çš„ id æˆå‘˜å˜é‡ï¼‰ï¼Œé‚£å®ƒå®žé™…ä¸Šç›¸å½“äºŽä¸€ç§å…¨å±€å˜é‡ï¼Œè¢«æ‰€æœ‰çš„ä»£ç å…±äº«ã€‚å¦‚æžœè¿™ä¸ªå…¨å±€å˜é‡æ˜¯ä¸€ä¸ªå¯å˜å…¨å±€å˜é‡ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒçš„æˆå‘˜å˜é‡æ˜¯å¯ä»¥è¢«ä¿®æ”¹çš„ï¼Œé‚£æˆ‘ä»¬åœ¨ç¼–å†™å•å…ƒæµ‹è¯•çš„æ—¶å€™ï¼Œè¿˜éœ€è¦æ³¨æ„ä¸åŒæµ‹è¯•ç”¨ä¾‹ä¹‹é—´ï¼Œä¿®æ”¹äº†å•ä¾‹ç±»ä¸­çš„åŒä¸€ä¸ªæˆå‘˜å˜é‡çš„å€¼ï¼Œä»Žè€Œå¯¼è‡´æµ‹è¯•ç»“æžœäº’ç›¸å½±å“çš„é—®é¢˜ã€‚å…³äºŽè¿™ä¸€ç‚¹ï¼Œä½ å¯ä»¥å›žè¿‡å¤´åŽ»çœ‹ä¸‹ç¬¬ 29 è®²ä¸­çš„â€œå…¶ä»–å¸¸è§çš„ Anti-Patternsï¼šå…¨å±€å˜é‡â€é‚£éƒ¨åˆ†çš„ä»£ç ç¤ºä¾‹å’Œè®²è§£ã€‚

## å•ä¾‹ä¸æ”¯æŒæœ‰å‚æ•°çš„æž„é€ å‡½æ•°

å•ä¾‹ä¸æ”¯æŒæœ‰å‚æ•°çš„æž„é€ å‡½æ•°ï¼Œæ¯”å¦‚æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªè¿žæŽ¥æ± çš„å•ä¾‹å¯¹è±¡ï¼Œæˆ‘ä»¬æ²¡æ³•é€šè¿‡å‚æ•°æ¥æŒ‡å®šè¿žæŽ¥æ± çš„å¤§å°ã€‚é’ˆå¯¹è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹éƒ½æœ‰å“ªäº›è§£å†³æ–¹æ¡ˆã€‚

ç¬¬ä¸€ç§è§£å†³æ€è·¯æ˜¯ï¼šåˆ›å»ºå®Œå®žä¾‹ä¹‹åŽï¼Œå†è°ƒç”¨ init() å‡½æ•°ä¼ é€’å‚æ•°ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨è¿™ä¸ªå•ä¾‹ç±»çš„æ—¶å€™ï¼Œè¦å…ˆè°ƒç”¨ init() æ–¹æ³•ï¼Œç„¶åŽæ‰èƒ½è°ƒç”¨ getInstance() æ–¹æ³•ï¼Œå¦åˆ™ä»£ç ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚å…·ä½“çš„ä»£ç å®žçŽ°å¦‚ä¸‹æ‰€ç¤ºï¼š

ç¬¬äºŒç§è§£å†³æ€è·¯æ˜¯ï¼šå°†å‚æ•°æ”¾åˆ° getIntance() æ–¹æ³•ä¸­ã€‚å…·ä½“çš„ä»£ç å®žçŽ°å¦‚ä¸‹æ‰€ç¤ºï¼š

```java
public class Singleton {
    private static Singleton instance = null;
    private final int paramA;
    private final int paramB;
    private Singleton(int paramA, int paramB) {
        this.paramA = paramA;
        this.paramB = paramB;
    } 
    public static Singleton getInstance() {
        if (instance == null) {
            throw new RuntimeException("Run init() first.");
        }
        return instance;
    } 
    public synchronized static Singleton init(int paramA, int paramB) {
        if (instance != null){
            throw new RuntimeException("Singleton has been created!");
        }
        instance = new Singleton(paramA, paramB);
        return instance;
    }
} 
Singleton.init(10, 50); // å…ˆinitï¼Œå†ä½¿ç”¨
Singleton singleton = Singleton.getInstance();
```

ç¬¬äºŒç§è§£å†³æ€è·¯æ˜¯ï¼šå°†å‚æ•°æ”¾åˆ° getIntance() æ–¹æ³•ä¸­ã€‚å…·ä½“çš„ä»£ç å®žçŽ°å¦‚ä¸‹æ‰€ç¤ºï¼š  

```java
public class Singleton {
    private static Singleton instance = null;
    private final int paramA;
    private final int paramB;
    private Singleton(int paramA, int paramB) {
        this.paramA = paramA;
        this.paramB = paramB;
    } 
    public synchronized static Singleton getInstance(int paramA, int paramB) {
        if (instance == null) {
            instance = new Singleton(paramA, paramB);
        }
        return instance;
    }
} 
Singleton singleton = Singleton.getInstance(10, 50);
```

ä¸çŸ¥é“ä½ æœ‰æ²¡æœ‰å‘çŽ°ï¼Œä¸Šé¢çš„ä»£ç å®žçŽ°ç¨å¾®æœ‰ç‚¹é—®é¢˜ã€‚å¦‚æžœæˆ‘ä»¬å¦‚ä¸‹ä¸¤æ¬¡æ‰§è¡Œ getInstance() æ–¹æ³•ï¼Œé‚£èŽ·å–åˆ°çš„ singleton1 å’Œ signleton2 çš„ paramA å’Œ paramB éƒ½æ˜¯10 å’Œ 50ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç¬¬äºŒæ¬¡çš„å‚æ•°ï¼ˆ20ï¼Œ30ï¼‰æ²¡æœ‰èµ·ä½œç”¨ï¼Œè€Œæž„å»ºçš„è¿‡ç¨‹ä¹Ÿæ²¡æœ‰ç»™ä¸Žæç¤ºï¼Œè¿™æ ·å°±ä¼šè¯¯å¯¼ç”¨æˆ·ã€‚è¿™ä¸ªé—®é¢˜å¦‚ä½•è§£å†³å‘¢ï¼Ÿç•™ç»™ä½ è‡ªå·±æ€è€ƒï¼Œä½ å¯ä»¥åœ¨ç•™è¨€åŒºè¯´è¯´ä½ çš„è§£å†³æ€è·¯ã€‚

```java
Singleton singleton1 = Singleton.getInstance(10, 50);
Singleton singleton2 = Singleton.getInstance(20, 30);
```

ç¬¬ä¸‰ç§è§£å†³æ€è·¯æ˜¯ï¼šå°†å‚æ•°æ”¾åˆ°å¦å¤–ä¸€ä¸ªå…¨å±€å˜é‡ä¸­ã€‚å…·ä½“çš„ä»£ç å®žçŽ°å¦‚ä¸‹ã€‚Config æ˜¯ä¸€ä¸ªå­˜å‚¨äº† paramA å’Œ paramB å€¼çš„å…¨å±€å˜é‡ã€‚é‡Œé¢çš„å€¼æ—¢å¯ä»¥åƒä¸‹é¢çš„ä»£ç é‚£æ ·é€šè¿‡é™æ€å¸¸é‡æ¥å®šä¹‰ï¼Œä¹Ÿå¯ä»¥ä»Žé…ç½®æ–‡ä»¶ä¸­åŠ è½½å¾—åˆ°ã€‚å®žé™…ä¸Šï¼Œè¿™ç§æ–¹å¼æ˜¯æœ€å€¼å¾—æŽ¨èçš„ã€‚

```java
public class Config {
    public static final int PARAM_A = 123;
    public static fianl int PARAM_B = 245;
} 

public class Singleton {
    private static Singleton instance = null;
    private final int paramA;
    private final int paramB;
    private Singleton() {
        this.paramA = Config.PARAM_A;
        this.paramB = Config.PARAM_B;
    } 

    public synchronized static Singleton getInstance() {
        if (instance == null) {
            instance = new Singleton();
        }
        return instance;
    }
}       
```

# æœ‰ä½•æ›¿ä»£è§£å†³æ–¹æ¡ˆï¼Ÿ

åˆšåˆšæˆ‘ä»¬æåˆ°äº†å•ä¾‹çš„å¾ˆå¤šé—®é¢˜ï¼Œä½ å¯èƒ½ä¼šè¯´ï¼Œå³ä¾¿å•ä¾‹æœ‰è¿™ä¹ˆå¤šé—®é¢˜ï¼Œä½†æˆ‘ä¸ç”¨ä¸è¡Œå•Šã€‚æˆ‘ä¸šåŠ¡ä¸Šæœ‰è¡¨ç¤ºå…¨å±€å”¯ä¸€ç±»çš„éœ€æ±‚ï¼Œå¦‚æžœä¸ç”¨å•ä¾‹ï¼Œæˆ‘æ€Žä¹ˆæ‰èƒ½ä¿è¯è¿™ä¸ªç±»çš„å¯¹è±¡å…¨å±€å”¯ä¸€å‘¢ï¼Ÿ

ä¸ºäº†ä¿è¯å…¨å±€å”¯ä¸€ï¼Œé™¤äº†ä½¿ç”¨å•ä¾‹ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç”¨é™æ€æ–¹æ³•æ¥å®žçŽ°ã€‚è¿™ä¹Ÿæ˜¯é¡¹ç›®å¼€å‘ä¸­ç»å¸¸ç”¨åˆ°çš„ä¸€ç§å®žçŽ°æ€è·¯ã€‚æ¯”å¦‚ï¼Œä¸Šä¸€èŠ‚è¯¾ä¸­è®²çš„ ID å”¯ä¸€é€’å¢žç”Ÿæˆå™¨çš„ä¾‹å­ï¼Œç”¨é™æ€æ–¹æ³•å®žçŽ°ä¸€ä¸‹ï¼Œå°±æ˜¯ä¸‹é¢è¿™ä¸ªæ ·å­ï¼š

```java
// é™æ€æ–¹æ³•å®žçŽ°æ–¹å¼
public class IdGenerator {
    private static AtomicLong id = new AtomicLong(0);
    public static long getId() {
        return id.incrementAndGet();
    }
}
// ä½¿ç”¨ä¸¾ä¾‹
long id = IdGenerator.getId();
```

ä¸è¿‡ï¼Œé™æ€æ–¹æ³•è¿™ç§å®žçŽ°æ€è·¯ï¼Œå¹¶ä¸èƒ½è§£å†³æˆ‘ä»¬ä¹‹å‰æåˆ°çš„é—®é¢˜ã€‚å®žé™…ä¸Šï¼Œå®ƒæ¯”å•ä¾‹æ›´åŠ ä¸çµæ´»ï¼Œæ¯”å¦‚ï¼Œå®ƒæ— æ³•æ”¯æŒå»¶è¿ŸåŠ è½½ã€‚æˆ‘ä»¬å†æ¥çœ‹çœ‹æœ‰æ²¡æœ‰å…¶ä»–åŠžæ³•ã€‚å®žé™…ä¸Šï¼Œå•ä¾‹é™¤äº†æˆ‘ä»¬ä¹‹å‰è®²åˆ°çš„ä½¿ç”¨æ–¹æ³•ä¹‹å¤–ï¼Œè¿˜æœ‰å¦å¤–ä¸€ä¸ªç§ä½¿ç”¨æ–¹æ³•ã€‚å…·ä½“çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š

```java
// 1. è€çš„ä½¿ç”¨æ–¹å¼
public demofunction() {
    //...
    long id = IdGenerator.getInstance().getId();
    //...
} 

// 2. æ–°çš„ä½¿ç”¨æ–¹å¼ï¼šä¾èµ–æ³¨å…¥
public demofunction(IdGenerator idGenerator) {
    long id = idGenerator.getId();
}

// å¤–éƒ¨è°ƒç”¨demofunction()çš„æ—¶å€™ï¼Œä¼ å…¥idGenerator
IdGenerator idGenerator = IdGenerator.getInsance();
demofunction(idGenerator);
```

åŸºäºŽæ–°çš„ä½¿ç”¨æ–¹å¼ï¼Œæˆ‘ä»¬å°†å•ä¾‹ç”Ÿæˆçš„å¯¹è±¡ï¼Œä½œä¸ºå‚æ•°ä¼ é€’ç»™å‡½æ•°ï¼ˆä¹Ÿå¯ä»¥é€šè¿‡æž„é€ å‡½æ•°ä¼ é€’ç»™ç±»çš„æˆå‘˜å˜é‡ï¼‰ï¼Œå¯ä»¥è§£å†³å•ä¾‹éšè—ç±»ä¹‹é—´ä¾èµ–å…³ç³»çš„é—®é¢˜ã€‚ä¸è¿‡ï¼Œå¯¹äºŽå•ä¾‹å­˜åœ¨çš„å…¶ä»–é—®é¢˜ï¼Œæ¯”å¦‚å¯¹ OOP ç‰¹æ€§ã€æ‰©å±•æ€§ã€å¯æµ‹æ€§ä¸å‹å¥½ç­‰é—®é¢˜ï¼Œè¿˜æ˜¯æ— æ³•è§£å†³ã€‚

æ‰€ä»¥ï¼Œå¦‚æžœè¦å®Œå…¨è§£å†³è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬å¯èƒ½è¦ä»Žæ ¹ä¸Šï¼Œå¯»æ‰¾å…¶ä»–æ–¹å¼æ¥å®žçŽ°å…¨å±€å”¯ä¸€ç±»ã€‚å®žé™…ä¸Šï¼Œç±»å¯¹è±¡çš„å…¨å±€å”¯ä¸€æ€§å¯ä»¥é€šè¿‡å¤šç§ä¸åŒçš„æ–¹å¼æ¥ä¿è¯ã€‚æˆ‘ä»¬æ—¢å¯ä»¥é€šè¿‡å•ä¾‹æ¨¡å¼æ¥å¼ºåˆ¶ä¿è¯ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å·¥åŽ‚æ¨¡å¼ã€IOC å®¹å™¨ï¼ˆæ¯”å¦‚ Spring IOC å®¹å™¨ï¼‰æ¥ä¿è¯ï¼Œè¿˜å¯ä»¥é€šè¿‡ç¨‹åºå‘˜è‡ªå·±æ¥ä¿è¯ï¼ˆè‡ªå·±åœ¨ç¼–å†™ä»£ç çš„æ—¶å€™è‡ªå·±ä¿è¯ä¸è¦åˆ›å»ºä¸¤ä¸ªç±»å¯¹è±¡ï¼‰ã€‚è¿™å°±ç±»ä¼¼ Java ä¸­å†…å­˜å¯¹è±¡çš„é‡Šæ”¾ç”± JVM æ¥è´Ÿè´£ï¼Œè€Œ C++ ä¸­ç”±ç¨‹åºå‘˜è‡ªå·±è´Ÿè´£ï¼Œé“ç†æ˜¯ä¸€æ ·çš„ã€‚

å¯¹äºŽæ›¿ä»£æ–¹æ¡ˆå·¥åŽ‚æ¨¡å¼ã€IOC å®¹å™¨çš„è¯¦ç»†è®²è§£ï¼Œæˆ‘ä»¬æ”¾åˆ°åŽé¢çš„ç« èŠ‚ä¸­è®²è§£ã€‚

# é‡ç‚¹å›žé¡¾

å¥½äº†ï¼Œä»Šå¤©çš„å†…å®¹åˆ°æ­¤å°±è®²å®Œäº†ã€‚æˆ‘ä»¬æ¥ä¸€å—æ€»ç»“å›žé¡¾ä¸€ä¸‹ï¼Œä½ éœ€è¦æŽŒæ¡çš„é‡ç‚¹å†…å®¹ã€‚

### å•ä¾‹å­˜åœ¨å“ªäº›é—®é¢˜ï¼Ÿ

å•ä¾‹å¯¹ OOP ç‰¹æ€§çš„æ”¯æŒä¸å‹å¥½å•ä¾‹ä¼šéšè—ç±»ä¹‹é—´çš„ä¾èµ–å…³ç³» å•ä¾‹å¯¹ä»£ç çš„æ‰©å±•æ€§ä¸å‹å¥½

å•ä¾‹å¯¹ä»£ç çš„å¯æµ‹è¯•æ€§ä¸å‹å¥½å•ä¾‹ä¸æ”¯æŒæœ‰å‚æ•°çš„æž„é€ å‡½æ•°

### å•ä¾‹æœ‰ä»€ä¹ˆæ›¿ä»£è§£å†³æ–¹æ¡ˆï¼Ÿ

ä¸ºäº†ä¿è¯å…¨å±€å”¯ä¸€ï¼Œé™¤äº†ä½¿ç”¨å•ä¾‹ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç”¨é™æ€æ–¹æ³•æ¥å®žçŽ°ã€‚ä¸è¿‡ï¼Œé™æ€æ–¹æ³•è¿™ç§å®žçŽ°æ€è·¯ï¼Œå¹¶ä¸èƒ½è§£å†³æˆ‘ä»¬ä¹‹å‰æåˆ°çš„é—®é¢˜ã€‚å¦‚æžœè¦å®Œå…¨è§£å†³è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬å¯èƒ½è¦ä»Žæ ¹ä¸Šï¼Œ å¯»æ‰¾å…¶ä»–æ–¹å¼æ¥å®žçŽ°å…¨å±€å”¯ä¸€ç±»äº†ã€‚æ¯”å¦‚ï¼Œé€šè¿‡å·¥åŽ‚æ¨¡å¼ã€IOC å®¹å™¨ï¼ˆæ¯”å¦‚ Spring IOC å®¹å™¨ï¼‰æ¥ä¿è¯ï¼Œç”±è¿‡ç¨‹åºå‘˜è‡ªå·±æ¥ä¿è¯ï¼ˆè‡ªå·±åœ¨ç¼–å†™ä»£ç çš„æ—¶å€™è‡ªå·±ä¿è¯ä¸è¦åˆ›å»ºä¸¤ä¸ªç±»å¯¹è±¡ï¼‰ã€‚

æœ‰äººæŠŠå•ä¾‹å½“ä½œåæ¨¡å¼ï¼Œä¸»å¼ æœç»åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ã€‚æˆ‘ä¸ªäººè§‰å¾—è¿™æœ‰ç‚¹æžç«¯ã€‚æ¨¡å¼æ²¡æœ‰å¯¹é”™ï¼Œ å…³é”®çœ‹ä½ æ€Žä¹ˆç”¨ã€‚å¦‚æžœå•ä¾‹ç±»å¹¶æ²¡æœ‰åŽç»­æ‰©å±•çš„éœ€æ±‚ï¼Œå¹¶ä¸”ä¸ä¾èµ–å¤–éƒ¨ç³»ç»Ÿï¼Œé‚£è®¾è®¡æˆå•ä¾‹ç±»å°±æ²¡æœ‰å¤ªå¤§é—®é¢˜ã€‚å¯¹äºŽä¸€äº›å…¨å±€çš„ç±»ï¼Œæˆ‘ä»¬åœ¨å…¶ä»–åœ°æ–¹ new çš„è¯ï¼Œè¿˜è¦åœ¨ç±»ä¹‹é—´ä¼ æ¥ä¼ åŽ»ï¼Œä¸å¦‚ç›´æŽ¥åšæˆå•ä¾‹ç±»ï¼Œä½¿ç”¨èµ·æ¥ç®€æ´æ–¹ä¾¿ã€‚

# è¯¾å ‚è®¨è®º

1. å¦‚æžœé¡¹ç›®ä¸­å·²ç»ç”¨äº†å¾ˆå¤šå•ä¾‹æ¨¡å¼ï¼Œæ¯”å¦‚ä¸‹é¢è¿™æ®µä»£ç ï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•åœ¨å°½é‡å‡å°‘ä»£ç æ”¹åŠ¨çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡é‡æž„ä»£ç æ¥æé«˜ä»£ç çš„å¯æµ‹è¯•æ€§å‘¢ï¼Ÿ

   ```java
   public class Demo {
       private UserRepo userRepo; // é€šè¿‡æž„é€ å“ˆå‡½æ•°æˆ–IOCå®¹å™¨ä¾èµ–æ³¨å…¥
       public boolean validateCachedUser(long userId) {
           User cachedUser = CacheManager.getInstance().getUser(userId);
           User actualUser = userRepo.getUser(userId);
           // çœç•¥æ ¸å¿ƒé€»è¾‘ï¼šå¯¹æ¯”cachedUserå’ŒactualUser...
       }
   }
   ```

2. åœ¨å•ä¾‹æ”¯æŒå‚æ•°ä¼ é€’çš„ç¬¬äºŒç§è§£å†³æ–¹æ¡ˆä¸­ï¼Œå¦‚æžœæˆ‘ä»¬ä¸¤æ¬¡æ‰§è¡Œ getInstance(paramA, paramB) æ–¹æ³•ï¼Œç¬¬äºŒæ¬¡ä¼ é€’è¿›åŽ»çš„å‚æ•°æ˜¯ä¸ç”Ÿæ•ˆçš„ï¼Œè€Œæž„å»ºçš„è¿‡ç¨‹ä¹Ÿæ²¡æœ‰ç»™ä¸Žæç¤ºï¼Œè¿™æ ·å°±ä¼šè¯¯å¯¼ç”¨æˆ·ã€‚è¿™ä¸ªé—®é¢˜å¦‚ä½•è§£å†³å‘¢ï¼Ÿ

   ```java
   Singleton singleton1 = Singleton.getInstance(10, 50);
   Singleton singleton2 = Singleton.getInstance(20, 30);
   ```

æ¬¢è¿Žç•™è¨€å’Œæˆ‘åˆ†äº«ä½ çš„æ€è€ƒå’Œè§è§£ã€‚å¦‚æžœæœ‰æ”¶èŽ·ï¼Œä¹Ÿæ¬¢è¿Žä½ æŠŠæ–‡ç« åˆ†äº«ç»™ä½ çš„æœ‹å‹ã€‚

## ç²¾é€‰ç•™è¨€ (18)

è¯¾å ‚è®¨è®ºï¼Œ

1.  æŠŠä»£ç â€œUser cachedUser = CacheManager.getInstance().getUser(userId);â€å•ç‹¬æå–å‡ºæ¥åšæˆä¸€ä¸ªå•ç‹¬çš„å‡½æ•°ï¼Œè¿™æ ·è¿™ä¸ªå‡½æ•°å°±å¯ä»¥è¿›è¡Œmockäº†ï¼Œè¿›è€Œæ–¹ä¾¿æµ‹è¯•validate CachedUserã€‚

2.  å¯ä»¥åˆ¤æ–­ä¼ è¿›æ¥çš„å‚æ•°å’Œå·²ç»å­˜åœ¨çš„instanceé‡Œé¢çš„ä¸¤ä¸ªæˆå‘˜å˜é‡çš„å€¼ï¼Œå¦‚æžœå…¨éƒ¨ç›¸â€¦

> å±•å¼€î˜ƒ

![](media/image14.png)![](media/image15.png)7 12

> ![](media/image16.png)**webmin**
>
> 2020-02-07
>
> 1\. å¦‚æžœé¡¹ç›®ä¸­å·²ç»ç”¨äº†å¾ˆå¤šå•ä¾‹æ¨¡å¼ï¼Œæ¯”å¦‚ä¸‹é¢è¿™æ®µä»£ç ï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•åœ¨å°½é‡å‡å°‘ä»£ç æ”¹åŠ¨çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡é‡æž„ä»£ç æ¥æé«˜ä»£ç çš„å¯æµ‹è¯•æ€§å‘¢ï¼Ÿ
>
> CacheManager.getInstance(long userId)ä¸­å¢žåŠ Mockå¼€å…³ï¼Œå¦‚ï¼š private User mockUser;
>
> public CacheManager.setMockObj(User mockUser)â€¦
>
> å±•å¼€î˜ƒ
>
> ![](media/image17.png)![](media/image18.png)1 4
>
> ![](media/image19.png)**é»„æž—æ™´**
>
> 2020-02-07
>
> æ‰“å¡
>
> å±•å¼€î˜ƒ
>
> ![](media/image20.png)![](media/image18.png)4
>
> ![](media/image21.png)**Jeff.Smile**
>
> 2020-02-07
>
> æ¨¡å¼æ²¡æœ‰å¯¹é”™ï¼Œå…³é”®çœ‹ä½ æ€Žä¹ˆç”¨ã€‚è¿™å¥è¯è¯´çš„å¾ˆå¯¹ï¼Œæ‰€ä»¥å…¶å®žæ‰€è°“å•ä¾‹æ¨¡å¼çš„ç¼ºç‚¹è¿™ç§è¯´æ³•è¿˜æ˜¯æœ‰ç‚¹ç‰µå¼ºï¼

![](media/image22.png)![](media/image23.png)3

> ![](media/image24.png)**Eden Ma**
>
> 2020-02-07
>
> 2ã€instanceä¸ä¸ºç©ºæŠ›å‡ºå¼‚å¸¸

![](media/image22.png)![](media/image23.png)2

> ![](media/image25.png)**Uncle.Wang**
>
> 2020-02-09
>
> æˆ‘é‡åˆ°çš„é—®é¢˜æ˜¯ï¼šåœ¨clientç«¯å¼€å‘çš„æ—¶å€™ï¼Œå·¥ç¨‹ä¸­æœ‰å¤§é‡å•ä¾‹ï¼Œè¿™äº›å•ä¾‹ä¸­ä¿å­˜ç€æ•°æ®ï¼Œè€Œè¿™äº›æ•°æ®å¯èƒ½æ˜¯å’Œç”¨æˆ·è´¦æˆ·ç›¸å…³è”çš„ï¼Œä¸€æ—¦åˆ‡æ¢è´¦å·ï¼Œé¢ä¸´resetè¿™äº›å•ä¾‹çš„é—®é¢˜ï¼Œå¾€å¾€å­˜åœ¨é—æ¼ã€‚å¦‚æžœå¤§é‡å­˜åœ¨è¿™ç§å•ä¾‹ï¼Œä¼šå¾ˆéš¾ç»´æŠ¤ã€‚
>
> å±•å¼€î˜ƒ

![](media/image26.png)![](media/image18.png)

> ![](media/image27.png)**Kenå¼ äº‘å¿ **
>
> 2020-02-09
>
> 1.ä¸‹é¢è¿™æ®µä»£ç ï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•åœ¨å°½é‡å‡å°‘ä»£ç æ”¹åŠ¨çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡é‡æž„ä»£ç æ¥æé«˜ä»£ç çš„å¯æµ‹è¯•æ€§å‘¢ï¼Ÿ
>
> å°†å•ä¾‹ç±»ä¸­æ–°å¢žä¸€ä¸ªç”¨äºŽèŽ·å–æµ‹è¯•instanceçš„å‡½æ•°,å‘½ågetTestInstance(User testUser), è¯¥å‡½æ•°ä¸­æŠŠéœ€è¦çš„æµ‹è¯•ç”¨ä¾‹é€šè¿‡å‚æ•°ä¼ å…¥instanceå½“ä¸­,å½“è¦åšæµ‹è¯•æ—¶å°±å¯ä»¥é€šè¿‡getTestIn stanceå‡½æ•°æ¥èŽ·å–å®žä¾‹å¾—åˆ°éœ€è¦çš„æµ‹è¯•æ•°æ®.â€¦
>
> å±•å¼€î˜ƒ
>
> ![](media/image26.png) ![](media/image28.png)
>
> ![](media/image29.png)**å®ˆæ‹™**
>
> 2020-02-09
>
> è¯¾å ‚è®¨è®º â€¦
>
> å±•å¼€î˜ƒ

![](media/image30.png)![](media/image28.png)

> ![](media/image31.png)**mghio**
>
> 2020-02-09
>
> ä¼˜ç§€ï¼Œå•ä¾‹æ¨¡å¼ç«Ÿç„¶è¿˜æœ‰è¿™ä¹ˆå¤šé—®é¢˜ä»¥å‰åªæ˜¯ç”¨ï¼Œä»Žæ¥æ²¡æœ‰è€ƒè™‘è¿‡è¿™æ–¹é¢

![](media/image32.png)![](media/image23.png)

> ![](media/image33.png)**test**
>
> 2020-02-08
>
> 1.æŠŠå•ä¾‹éƒ¨åˆ†æŠ½å‡ºæ¥ï¼›
>
> 2.ä¸ºç©ºæˆ–è€…ä¸€è‡´çš„æ—¶å€™è¿”å›žå¯ç”¨instanceï¼Œä¸ä¸€è‡´åˆ™æŠ›é”™ã€‚
>
> å±•å¼€î˜ƒ

![](media/image32.png)![](media/image23.png)

> ![](media/image34.png)**å¹³é£Žé€ é›¨**
>
> 2020-02-08
>
> é—®é¢˜2ä½¿ç”¨ä¸åŒå‚æ•°æž„é€ ä¸åŒå•ä¾‹ï¼Œæ˜¯è¿™ä¸ªéœ€æ±‚å—ï¼Ÿå¦‚æžœæ˜¯é‚£ä¹ˆç»´æŠ¤ç±»å°±ä¸èƒ½åªæœ‰ä¸€ä¸ªinst anceçš„æˆå‘˜å˜é‡ï¼Œåº”è¯¥è€ƒè™‘æœ‰ç±»ä¼¼cachedMapçš„æ–¹å¼ï¼Œinstanceè¦å®žçŽ°equalså’ŒhashCo deæ–¹æ³•ï¼Œé’ˆå¯¹ä¸åŒå…¥å‚ä½œä¸ºä¸åŒçš„keyï¼Œçº¿ç¨‹å®‰å…¨çš„åŽ»è®¿é—®cachedMapè¿›è¡Œå­˜å–ã€‚
>
> å±•å¼€î˜ƒ

![](media/image32.png)![](media/image23.png)

> ![](media/image35.png)**å¤±ç«çš„å¤å¤©**
>
> 2020-02-08
>
> ç›´æŽ¥æ›´æ–°å±žæ€§æ€•æ˜¯ä¼šæœ‰ä¸€ä¸ªå®‰å…¨é—®é¢˜å§ï¼Œä¸€ä¸ªé•¿çº¿ç¨‹å¦‚æžœä¸€ç›´åœ¨ä½¿ç”¨å¯¹è±¡ï¼Œä¸€ä¸ªå…¶ä»–çº¿ç¨‹è¿›æ¥åŽï¼ŒæŠŠè¿™ä¸ªå•ä¾‹å¯¹è±¡çš„å±žæ€§ç›´æŽ¥ä¿®æ”¹äº†ã€‚é•¿çº¿ç¨‹æŽ¥ä¸‹æ¥å¦‚æžœä½¿ç”¨åˆ°å•ä¾‹å¯¹è±¡ï¼Œå±žæ€§å°±å…¨å˜äº†ã€‚çº¿ç¨‹å®‰å…¨æ€§å¤ªå·®äº†ã€‚

![](media/image30.png)![](media/image28.png)

> ![](media/image36.png)**å¿†æ°´å¯’**
>
> ![](media/image37.png) 2020-02-07
>
> ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œä¸ºäº†å¢žåŠ å¯æµ‹è¯•æ€§ï¼Œä¹Ÿå°±æ˜¯å°½é‡å¯ä»¥æµ‹è¯•ä¸­é—´ç»“æžœã€‚æˆ‘è§‰å¾—å¯ä»¥å°†cacheUse ré‚£ä¸€è¡Œä»£ç å’Œä¸‹ä¸€è¡Œä»£ç åˆ†åˆ«æŠ½å–å‡ºæ¥å°è£…ðŸ“¦ã€‚
>
> ç¬¬äºŒä¸ªé—®é¢˜ï¼Œå¯ä»¥å°†å‚æ•°ä¿å­˜åœ¨é™æ€ç±»ä¸­ï¼Œæœ¬èº«è¿™ä¸ªç±»æ–°å¢žä¸€ä¸ªinitå‡½æ•°ï¼Œåœ¨new å¯¹è±¡åŽè¿›è¡Œè°ƒç”¨initã€‚è¿™æ ·ç”¨æˆ·å¯ä»¥ä¸éœ€è¦åŠ è½½å‚æ•°ã€‚å½“ç„¶äº†ï¼Œå¦‚æžœä¸€å®šè¦åœ¨getInstanceæ—¶ä¼ å…¥å‚æ•°ï¼Œé‚£ä¹ˆä¹Ÿå¯ä»¥æ ¡éªŒå‚æ•°æ˜¯å¦å’Œä¸Šä¸€æ¬¡ä¼ å…¥çš„å‚æ•°æ˜¯å¦ä¸€è‡´ã€‚
>
> å±•å¼€î˜ƒ

![](media/image38.png)![](media/image39.png)

> ![](media/image40.png)**å¾€äº‹éšé£Žï¼Œé¡ºå…¶è‡ªç„¶**
>
> 2020-02-07
>
> ç¬¬ä¸€ä¸ªé—®é¢˜å¯ä»¥å…ˆæŠ½å–ä¸€ä¸ªå‡½æ•°ï¼Œç„¶åŽmock ç¬¬äºŒä¸ªé—®é¢˜ï¼Œå¯ä»¥æ¯”è¾ƒä¼ å…¥çš„å‚æ•°å¯¹æ¯”ï¼Œç›¸åŒæ‰è¿›è¡Œæ–°å»ºå¯¹åº”å¯¹è±¡
>
> å±•å¼€î˜ƒ

![](media/image41.png)![](media/image42.png)

> ![](media/image43.png)**å¥½åƒä¸è´µ**
>
> 2020-02-07
>
> å…³äºŽå•ä¾‹æ¨¡å¼çš„æ›¿æ¢æ–¹æ¡ˆã€‚ç±»å®žçŽ°æ—¶normalClassç”¨æ™®é€šå†™æ³•ï¼Œæž„é€ å‡½æ•°ä¹Ÿæ˜¯publicçš„ã€‚åœ¨ç±»å¤–é¢ï¼Œå…¨å±€å®šä¹‰static normalClass obj;è¿™æ ·ç›´æŽ¥è°ƒç”¨objçš„æ–¹æ³•æ˜¯ä¸æ˜¯ä¹Ÿæ˜¯å…¨å±€å”¯ä¸€
>
> äº†ï¼Œè‡³å°‘åŒä¸€è¿›ç¨‹å†…æ˜¯ä¸€æ ·çš„ï¼Œä¹Ÿç®—æ˜¯ä¸€ç§å•ä¾‹çš„æ›¿ä»£æ–¹æ¡ˆï¼Ÿ
>
> å±•å¼€î˜ƒ

![](media/image41.png)![](media/image42.png)

> ![](media/image44.png)**è¾£ä¹ˆå¤§**
>
> 2020-02-07
>
> æ€è€ƒé¢˜1ï¼š
>
> æå‡ºä¸€ä¸ªæ–¹æ³•ï¼špublic Uer getCahcedUser(userId){}ï¼Œç„¶åŽmock getCahcedUseræ–¹æ³•ã€‚
>
> æµ‹è¯•ï¼š
>
> public boolean validateCachedUesr(userid){â€¦
>
> å±•å¼€î˜ƒ

![](media/image45.png)![](media/image39.png)1

> ![](media/image46.png)**Yang**
>
> 2020-02-07
>
> 1.é€šè¿‡å‚æ•°çš„æ–¹å¼å°†å•ä¾‹ç±»ä¼ é€’è¿›å‡½æ•°ã€‚
>
> 2.å¦‚æžœå•ä¾‹å¯¹è±¡å­˜åœ¨ï¼Œå°±å¯¹æ¯”ä¸¤ä¸ªæˆå‘˜å˜é‡ï¼Œä¸ä¸€è‡´å°±æŠ›å‡ºå¼‚å¸¸æç¤ºè°ƒç”¨æ–¹ï¼Œä¸€è‡´å°±ç›´æŽ¥è¿”å›žå•ä¾‹å¯¹è±¡ã€‚
>
> å±•å¼€î˜ƒ
>
> ![](media/image47.png)
>
> ![](media/image49.png)**çŸ³ç»´åº·**
>
> 2020-02-07
>
> public class Singleton {
>
> private static Singleton instance = null; private final int paramA;
>
> private final int paramB;â€¦
>
> å±•å¼€î˜ƒ
>
> ![](media/image50.png)![](media/image48.png)1
