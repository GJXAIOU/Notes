# 66è¿­ä»£å™¨æ¨¡å¼ï¼ˆä¸­ï¼‰ï¼šéåŽ†é›†åˆçš„åŒæ—¶ï¼Œä¸ºä»€ä¹ˆä¸èƒ½å¢žåˆ é›†åˆå…ƒç´ ï¼Ÿ

> 2020-04-03 çŽ‹äº‰
>
> è®¾è®¡æ¨¡å¼ä¹‹ç¾Ž è¿›å…¥è¯¾ç¨‹ î™¯

![](media/image3.png)

> ä¸Šä¸€èŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ç»™ ArrayListã€LinkedList å®¹å™¨å®žçŽ°è¿­ä»£å™¨ï¼Œå­¦ä¹ äº†è¿­ä»£å™¨æ¨¡å¼çš„åŽŸ
>
> ![](media/image9.png)ç†ã€å®žçŽ°å’Œè®¾è®¡æ„å›¾ã€‚è¿­ä»£å™¨æ¨¡å¼ä¸»è¦ä½œç”¨æ˜¯è§£è€¦å®¹å™¨ä»£ç å’ŒéåŽ†ä»£ç ï¼Œè¿™ä¹Ÿå°è¯äº†æˆ‘ä»¬å‰é¢å¤šæ¬¡è®²è¿‡çš„åº”ç”¨è®¾è®¡æ¨¡å¼çš„ä¸»è¦ç›®çš„æ˜¯è§£è€¦ã€‚
>
> ä¸Šä¸€èŠ‚è¯¾ä¸­è®²è§£çš„å†…å®¹éƒ½æ¯”è¾ƒåŸºç¡€ï¼Œä»Šå¤©ï¼Œæˆ‘ä»¬æ¥æ·±æŒ–ä¸€ä¸‹ï¼Œå¦‚æžœåœ¨ä½¿ç”¨è¿­ä»£å™¨éåŽ†é›†åˆî˜¿çš„åŒæ—¶å¢žåŠ ã€åˆ é™¤é›†åˆä¸­çš„å…ƒç´ ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼Ÿåº”è¯¥å¦‚ä½•åº”å¯¹ï¼Ÿå¦‚ä½•åœ¨éåŽ†çš„åŒæ—¶å®‰å…¨åœ°åˆ é™¤é›†åˆå…ƒç´ ï¼Ÿ
>
> è¯ä¸å¤šè¯´ï¼Œè®©æˆ‘ä»¬æ­£å¼å¼€å§‹ä»Šå¤©çš„å†…å®¹å§ï¼

# åœ¨éåŽ†çš„åŒæ—¶å¢žåˆ é›†åˆå…ƒç´ ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ

> åœ¨é€šè¿‡è¿­ä»£å™¨æ¥éåŽ†é›†åˆå…ƒç´ çš„åŒæ—¶ï¼Œå¢žåŠ æˆ–è€…åˆ é™¤é›†åˆä¸­çš„å…ƒç´ ï¼Œæœ‰å¯èƒ½ä¼šå¯¼è‡´æŸä¸ªå…ƒç´ è¢«é‡å¤éåŽ†æˆ–éåŽ†ä¸åˆ°ã€‚ä¸è¿‡ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰æƒ…å†µä¸‹éƒ½ä¼šéåŽ†å‡ºé”™ï¼Œæœ‰çš„æ—¶å€™ä¹Ÿå¯ä»¥æ­£å¸¸é åŽ†ï¼Œæ‰€ä»¥ï¼Œè¿™ç§è¡Œä¸ºç§°ä¸º**ç»“æžœä¸å¯é¢„æœŸè¡Œä¸º**æˆ–è€…**æœªå†³è¡Œä¸º**ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿è¡Œç»“æžœåˆ°åº•æ˜¯å¯¹è¿˜æ˜¯é”™ï¼Œè¦è§†æƒ…å†µè€Œå®šã€‚
>
> æ€Žä¹ˆç†è§£å‘¢ï¼Ÿæˆ‘ä»¬é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥è§£é‡Šä¸€ä¸‹ã€‚æˆ‘ä»¬è¿˜æ˜¯å»¶ç»­ä¸Šä¸€èŠ‚è¯¾å®žçŽ°çš„ ArrayList è¿­ä»£å™¨çš„ä¾‹å­ã€‚ä¸ºäº†æ–¹ä¾¿ä½ æŸ¥çœ‹ï¼Œæˆ‘æŠŠç›¸å…³çš„ä»£ç éƒ½é‡æ–°æ‹·è´åˆ°è¿™é‡Œäº†ã€‚

î˜“ å¤åˆ¶ä»£ç 

1.  public interface Iterator&lt;E&gt; {

2.  boolean hasNext();

3.  void next();

4.  E currentItem();

> 5 }
>
> 6
>
> 7 public class ArrayIterator&lt;E&gt; implements Iterator&lt;E&gt; {

[TABLE]

> æˆ‘ä»¬çŸ¥é“ï¼ŒArrayList åº•å±‚å¯¹åº”çš„æ˜¯æ•°ç»„è¿™ç§æ•°æ®ç»“æž„ï¼Œåœ¨æ‰§è¡Œå®Œç¬¬ 55 è¡Œä»£ç çš„æ—¶å€™ï¼Œæ•°ç»„ä¸­å­˜å‚¨çš„æ˜¯ aã€bã€cã€d å››ä¸ªå…ƒç´ ï¼Œè¿­ä»£å™¨çš„æ¸¸æ ‡ cursor æŒ‡å‘å…ƒç´  aã€‚å½“æ‰§è¡Œå®Œç¬¬ 56 è¡Œä»£ç çš„æ—¶å€™ï¼Œæ¸¸æ ‡æŒ‡å‘å…ƒç´  bï¼Œåˆ°è¿™é‡Œéƒ½æ²¡æœ‰é—®é¢˜ã€‚
>
> ä¸ºäº†ä¿æŒæ•°ç»„å­˜å‚¨æ•°æ®çš„è¿žç»­æ€§ï¼Œæ•°ç»„çš„åˆ é™¤æ“ä½œä¼šæ¶‰åŠå…ƒç´ çš„æ¬ç§»ï¼ˆè¯¦ç»†çš„è®²è§£ä½ å¯ä»¥åŽ»çœ‹æˆ‘çš„å¦ä¸€ä¸ªä¸“æ ã€Šæ•°æ®ç»“æž„ä¸Žç®—æ³•ä¹‹ç¾Žã€‹ï¼‰ã€‚å½“æ‰§è¡Œåˆ°ç¬¬ 57 è¡Œä»£ç çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä»Žæ•°ç»„ä¸­å°†å…ƒç´  a åˆ é™¤æŽ‰ï¼Œbã€cã€d ä¸‰ä¸ªå…ƒç´ ä¼šä¾æ¬¡å¾€å‰æ¬ç§»ä¸€ä½ï¼Œè¿™å°±ä¼šå¯¼è‡´æ¸¸æ ‡æœ¬æ¥æŒ‡å‘å…ƒç´  bï¼ŒçŽ°åœ¨å˜æˆäº†æŒ‡å‘å…ƒç´  cã€‚åŽŸæœ¬åœ¨æ‰§è¡Œå®Œç¬¬ 56 è¡Œä»£ç ä¹‹åŽï¼Œæˆ‘ä»¬è¿˜å¯ä»¥éåŽ†åˆ° bã€cã€d ä¸‰ä¸ªå…ƒç´ ï¼Œä½†åœ¨æ‰§è¡Œå®Œç¬¬ 57 è¡Œä»£ç ä¹‹åŽï¼Œæˆ‘ä»¬åªèƒ½éåŽ†åˆ° cã€d ä¸¤ä¸ªå…ƒç´ ï¼Œb éåŽ†ä¸åˆ°äº†ã€‚
>
> å¯¹äºŽä¸Šé¢çš„æè¿°ï¼Œæˆ‘ç”»äº†ä¸€å¼ å›¾ï¼Œä½ å¯ä»¥å¯¹ç…§ç€ç†è§£ã€‚
>
> ![](media/image10.png)
>
> ä¸è¿‡ï¼Œå¦‚æžœç¬¬ 57 è¡Œä»£ç åˆ é™¤çš„ä¸æ˜¯æ¸¸æ ‡å‰é¢çš„å…ƒç´ ï¼ˆå…ƒç´  aï¼‰ä»¥åŠæ¸¸æ ‡æ‰€åœ¨ä½ç½®çš„å…ƒç´ 
>
> ï¼ˆå…ƒç´  bï¼‰ï¼Œè€Œæ˜¯æ¸¸æ ‡åŽé¢çš„å…ƒç´ ï¼ˆå…ƒç´  c å’Œ dï¼‰ï¼Œè¿™æ ·å°±ä¸ä¼šå­˜åœ¨ä»»ä½•é—®é¢˜äº†ï¼Œä¸ä¼šå­˜åœ¨æŸä¸ªå…ƒç´ éåŽ†ä¸åˆ°çš„æƒ…å†µäº†ã€‚
>
> æ‰€ä»¥ï¼Œæˆ‘ä»¬å‰é¢è¯´ï¼Œåœ¨éåŽ†çš„è¿‡ç¨‹ä¸­åˆ é™¤é›†åˆå…ƒç´ ï¼Œç»“æžœæ˜¯ä¸å¯é¢„æœŸçš„ï¼Œæœ‰æ—¶å€™æ²¡é—®é¢˜ï¼ˆåˆ é™¤å…ƒç´  c æˆ– dï¼‰ï¼Œæœ‰æ—¶å€™å°±æœ‰é—®é¢˜ï¼ˆåˆ é™¤å…ƒç´  a æˆ– bï¼‰ï¼Œè¿™ä¸ªè¦è§†æƒ…å†µè€Œå®šï¼ˆåˆ°åº•åˆ é™¤çš„æ˜¯å“ªä¸ªä½ç½®çš„å…ƒç´ ï¼‰ï¼Œå°±æ˜¯è¿™ä¸ªæ„æ€ã€‚
>
> åœ¨éåŽ†çš„è¿‡ç¨‹ä¸­åˆ é™¤é›†åˆå…ƒç´ ï¼Œæœ‰å¯èƒ½ä¼šå¯¼è‡´æŸä¸ªå…ƒç´ éåŽ†ä¸åˆ°ï¼Œé‚£åœ¨éåŽ†çš„è¿‡ç¨‹ä¸­æ·»åŠ é›†åˆå…ƒç´ ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µå‘¢ï¼Ÿè¿˜æ˜¯ç»“åˆåˆšåˆšé‚£ä¸ªä¾‹å­æ¥è®²è§£ï¼Œæˆ‘ä»¬å°†ä¸Šé¢çš„ä»£ç ç¨å¾®æ”¹é€ ä¸€ä¸‹ï¼ŒæŠŠåˆ é™¤å…ƒç´ æ”¹ä¸ºæ·»åŠ å…ƒç´ ã€‚å…·ä½“çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š

[TABLE]

> åœ¨æ‰§è¡Œå®Œç¬¬ 10 è¡Œä»£ç ä¹‹åŽï¼Œæ•°ç»„ä¸­åŒ…å« aã€bã€cã€d å››ä¸ªå…ƒç´ ï¼Œæ¸¸æ ‡æŒ‡å‘ b è¿™ä¸ªå…ƒç´ ï¼Œå·²ç»è·³è¿‡äº†å…ƒç´  aã€‚åœ¨æ‰§è¡Œå®Œç¬¬ 11 è¡Œä»£ç ä¹‹åŽï¼Œæˆ‘ä»¬å°† x æ’å…¥åˆ°ä¸‹æ ‡ä¸º 0 çš„ä½ç½®ï¼Œaã€bã€cã€d å››ä¸ªå…ƒç´ ä¾æ¬¡å¾€åŽç§»åŠ¨ä¸€ä½ã€‚è¿™ä¸ªæ—¶å€™ï¼Œæ¸¸æ ‡åˆé‡æ–°æŒ‡å‘äº†å…ƒç´  aã€‚å…ƒç´  a è¢«æ¸¸æ ‡é‡å¤æŒ‡å‘ä¸¤æ¬¡ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå…ƒç´  a å­˜åœ¨è¢«é‡å¤éåŽ†çš„æƒ…å†µã€‚
>
> è·Ÿåˆ é™¤æƒ…å†µç±»ä¼¼ï¼Œå¦‚æžœæˆ‘ä»¬åœ¨æ¸¸æ ‡çš„åŽé¢æ·»åŠ å…ƒç´ ï¼Œå°±ä¸ä¼šå­˜åœ¨ä»»ä½•é—®é¢˜ã€‚æ‰€ä»¥ï¼Œåœ¨éåŽ†çš„åŒæ—¶æ·»åŠ é›†åˆå…ƒç´ ä¹Ÿæ˜¯ä¸€ç§ä¸å¯é¢„æœŸè¡Œä¸ºã€‚
>
> åŒæ ·ï¼Œå¯¹äºŽä¸Šé¢çš„æ·»åŠ å…ƒç´ çš„æƒ…å†µï¼Œæˆ‘ä»¬ä¹Ÿç”»äº†ä¸€å¼ å›¾ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼Œä½ å¯ä»¥å¯¹ç…§ç€ç†è§£ã€‚
>
> ![](media/image11.png)

# å¦‚ä½•åº”å¯¹éåŽ†æ—¶æ”¹å˜é›†åˆå¯¼è‡´çš„æœªå†³è¡Œä¸ºï¼Ÿ

> å½“é€šè¿‡è¿­ä»£å™¨æ¥éåŽ†é›†åˆçš„æ—¶å€™ï¼Œå¢žåŠ ã€åˆ é™¤é›†åˆå…ƒç´ ä¼šå¯¼è‡´ä¸å¯é¢„æœŸçš„éåŽ†ç»“æžœã€‚å®žé™… ä¸Šï¼Œâ€œä¸å¯é¢„æœŸâ€æ¯”ç›´æŽ¥å‡ºé”™æ›´åŠ å¯æ€•ï¼Œæœ‰çš„æ—¶å€™è¿è¡Œæ­£ç¡®ï¼Œæœ‰çš„æ—¶å€™è¿è¡Œé”™è¯¯ï¼Œä¸€äº›éšè—å¾ˆæ·±ã€å¾ˆéš¾ debug çš„ bug å°±æ˜¯è¿™ä¹ˆäº§ç”Ÿçš„ã€‚é‚£æˆ‘ä»¬å¦‚ä½•æ‰èƒ½é¿å…å‡ºçŽ°è¿™ç§ä¸å¯é¢„æœŸçš„è¿è¡Œç»“æžœå‘¢ï¼Ÿ
>
> æœ‰ä¸¤ç§æ¯”è¾ƒå¹²è„†åˆ©ç´¢çš„è§£å†³æ–¹æ¡ˆï¼šä¸€ç§æ˜¯éåŽ†çš„æ—¶å€™ä¸å…è®¸å¢žåˆ å…ƒç´ ï¼Œå¦ä¸€ç§æ˜¯å¢žåˆ å…ƒç´ ä¹‹åŽè®©éåŽ†æŠ¥é”™ã€‚
>
> å®žé™…ä¸Šï¼Œç¬¬ä¸€ç§è§£å†³æ–¹æ¡ˆæ¯”è¾ƒéš¾å®žçŽ°ï¼Œæˆ‘ä»¬è¦ç¡®å®šéåŽ†å¼€å§‹å’Œç»“æŸçš„æ—¶é—´ç‚¹ã€‚éåŽ†å¼€å§‹çš„æ—¶é—´èŠ‚ç‚¹æˆ‘ä»¬å¾ˆå®¹æ˜“èŽ·å¾—ã€‚æˆ‘ä»¬å¯ä»¥æŠŠåˆ›å»ºè¿­ä»£å™¨çš„æ—¶é—´ç‚¹ä½œä¸ºéåŽ†å¼€å§‹çš„æ—¶é—´ç‚¹ã€‚ä½†æ˜¯ï¼ŒéåŽ†ç»“æŸçš„æ—¶é—´ç‚¹è¯¥å¦‚ä½•æ¥ç¡®å®šå‘¢ï¼Ÿ
>
> ä½ å¯èƒ½ä¼šè¯´ï¼ŒéåŽ†åˆ°æœ€åŽä¸€ä¸ªå…ƒç´ çš„æ—¶å€™å°±ç®—ç»“æŸå‘—ã€‚ä½†æ˜¯ï¼Œåœ¨å®žé™…çš„è½¯ä»¶å¼€å‘ä¸­ï¼Œæ¯æ¬¡ä½¿ç”¨è¿­ä»£å™¨æ¥éåŽ†å…ƒç´ ï¼Œå¹¶ä¸ä¸€å®šéžè¦æŠŠæ‰€æœ‰å…ƒç´ éƒ½éåŽ†ä¸€éã€‚å¦‚ä¸‹æ‰€ç¤ºï¼Œæˆ‘ä»¬æ‰¾åˆ°ä¸€ä¸ªå€¼ä¸º b çš„å…ƒç´ å°±æå‰ç»“æŸäº†éåŽ†ã€‚

[TABLE]

> ä½ å¯èƒ½è¿˜ä¼šè¯´ï¼Œé‚£æˆ‘ä»¬å¯ä»¥åœ¨è¿­ä»£å™¨ç±»ä¸­å®šä¹‰ä¸€ä¸ªæ–°çš„æŽ¥å£ finishIteration()ï¼Œä¸»åŠ¨å‘ŠçŸ¥å®¹å™¨è¿­ä»£å™¨ä½¿ç”¨å®Œäº†ï¼Œä½ å¯ä»¥å¢žåˆ å…ƒç´ äº†ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚ä½†æ˜¯ï¼Œè¿™å°±è¦æ±‚ç¨‹åºå‘˜åœ¨ä½¿ç”¨å®Œè¿­ä»£å™¨ä¹‹åŽè¦ä¸»åŠ¨è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œä¹Ÿå¢žåŠ äº†å¼€å‘æˆæœ¬ï¼Œè¿˜å¾ˆå®¹æ˜“æ¼æŽ‰ã€‚

[TABLE]

> å®žé™…ä¸Šï¼Œç¬¬äºŒç§è§£å†³æ–¹æ³•æ›´åŠ åˆç†ã€‚Java è¯­è¨€å°±æ˜¯é‡‡ç”¨çš„è¿™ç§è§£å†³æ–¹æ¡ˆï¼Œå¢žåˆ å…ƒç´ ä¹‹åŽï¼Œ è®©éåŽ†æŠ¥é”™ã€‚æŽ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å…·ä½“æ¥çœ‹ä¸€ä¸‹å¦‚ä½•å®žçŽ°ã€‚
>
> æ€Žä¹ˆç¡®å®šåœ¨éåŽ†æ—¶å€™ï¼Œé›†åˆæœ‰æ²¡æœ‰å¢žåˆ å…ƒç´ å‘¢ï¼Ÿæˆ‘ä»¬åœ¨ ArrayList ä¸­å®šä¹‰ä¸€ä¸ªæˆå‘˜å˜é‡modCountï¼Œè®°å½•é›†åˆè¢«ä¿®æ”¹çš„æ¬¡æ•°ï¼Œé›†åˆæ¯è°ƒç”¨ä¸€æ¬¡å¢žåŠ æˆ–åˆ é™¤å…ƒç´ çš„å‡½æ•°ï¼Œå°±ä¼šç»™modCount åŠ  1ã€‚å½“é€šè¿‡è°ƒç”¨é›†åˆä¸Šçš„ iterator() å‡½æ•°æ¥åˆ›å»ºè¿­ä»£å™¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬æŠŠmodCount å€¼ä¼ é€’ç»™è¿­ä»£å™¨çš„ expectedModCount æˆå‘˜å˜é‡ï¼Œä¹‹åŽæ¯æ¬¡è°ƒç”¨è¿­ä»£å™¨ä¸Šçš„hasNext()ã€next()ã€currentItem() å‡½æ•°ï¼Œæˆ‘ä»¬éƒ½ä¼šæ£€æŸ¥é›†åˆä¸Šçš„ modCount æ˜¯å¦ç­‰äºŽexpectedModCountï¼Œä¹Ÿå°±æ˜¯çœ‹ï¼Œåœ¨åˆ›å»ºå®Œè¿­ä»£å™¨ä¹‹åŽï¼ŒmodCount æ˜¯å¦æ”¹å˜è¿‡ã€‚
>
> å¦‚æžœä¸¤ä¸ªå€¼ä¸ç›¸åŒï¼Œé‚£å°±è¯´æ˜Žé›†åˆå­˜å‚¨çš„å…ƒç´ å·²ç»æ”¹å˜äº†ï¼Œè¦ä¹ˆå¢žåŠ äº†å…ƒç´ ï¼Œè¦ä¹ˆåˆ é™¤äº†å…ƒç´ ï¼Œä¹‹å‰åˆ›å»ºçš„è¿­ä»£å™¨å·²ç»ä¸èƒ½æ­£ç¡®è¿è¡Œäº†ï¼Œå†ç»§ç»­ä½¿ç”¨å°±ä¼šäº§ç”Ÿä¸å¯é¢„æœŸçš„ç»“æžœï¼Œæ‰€ä»¥æˆ‘ä»¬é€‰æ‹© fail-fast è§£å†³æ–¹å¼ï¼ŒæŠ›å‡ºè¿è¡Œæ—¶å¼‚å¸¸ï¼Œç»“æŸæŽ‰ç¨‹åºï¼Œè®©ç¨‹åºå‘˜å°½å¿«ä¿®å¤è¿™ä¸ªå› ä¸ºä¸æ­£ç¡®ä½¿ç”¨è¿­ä»£å™¨è€Œäº§ç”Ÿçš„ bugã€‚
>
> ä¸Šé¢çš„æè¿°ç¿»è¯‘æˆä»£ç å°±æ˜¯ä¸‹é¢è¿™æ ·å­ã€‚ä½ å¯ä»¥ç»“åˆç€ä»£ç ä¸€èµ·ç†è§£æˆ‘åˆšæ‰çš„è®²è§£ã€‚

[TABLE]

# å¦‚ä½•åœ¨éåŽ†çš„åŒæ—¶å®‰å…¨åœ°åˆ é™¤é›†åˆå…ƒç´ ï¼Ÿ

> åƒ Java è¯­è¨€ï¼Œè¿­ä»£å™¨ç±»ä¸­é™¤äº†å‰é¢æåˆ°çš„å‡ ä¸ªæœ€åŸºæœ¬çš„æ–¹æ³•ä¹‹å¤–ï¼Œè¿˜å®šä¹‰äº†ä¸€ä¸ªremove() æ–¹æ³•ï¼Œèƒ½å¤Ÿåœ¨éåŽ†é›†åˆçš„åŒæ—¶ï¼Œå®‰å…¨åœ°åˆ é™¤é›†åˆä¸­çš„å…ƒç´ ã€‚ä¸è¿‡ï¼Œéœ€è¦è¯´æ˜Žçš„
>
> æ˜¯ï¼Œå®ƒå¹¶æ²¡æœ‰æä¾›æ·»åŠ å…ƒç´ çš„æ–¹æ³•ã€‚æ¯•ç«Ÿè¿­ä»£å™¨çš„ä¸»è¦ä½œç”¨æ˜¯éåŽ†ï¼Œæ·»åŠ å…ƒç´ æ”¾åˆ°è¿­ä»£å™¨é‡Œæœ¬èº«å°±ä¸åˆé€‚ã€‚
>
> æˆ‘ä¸ªäººè§‰å¾—ï¼ŒJava è¿­ä»£å™¨ä¸­æä¾›çš„ remove() æ–¹æ³•è¿˜æ˜¯æ¯”è¾ƒé¸¡è‚‹çš„ï¼Œä½œç”¨æœ‰é™ã€‚å®ƒåªèƒ½åˆ é™¤æ¸¸æ ‡æŒ‡å‘çš„å‰ä¸€ä¸ªå…ƒç´ ï¼Œè€Œä¸”ä¸€ä¸ª next() å‡½æ•°ä¹‹åŽï¼Œåªèƒ½è·Ÿç€æœ€å¤šä¸€ä¸ª remove() æ“ä½œï¼Œå¤šæ¬¡è°ƒç”¨ remove() æ“ä½œä¼šæŠ¥é”™ã€‚æˆ‘è¿˜æ˜¯é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥è§£é‡Šä¸€ä¸‹ã€‚

[TABLE]

> çŽ°åœ¨ï¼Œæˆ‘ä»¬ä¸€å—æ¥çœ‹ä¸‹ï¼Œä¸ºä»€ä¹ˆé€šè¿‡è¿­ä»£å™¨å°±èƒ½å®‰å…¨çš„åˆ é™¤é›†åˆä¸­çš„å…ƒç´ å‘¢ï¼Ÿæºç ä¹‹ä¸‹æ— ç§˜å¯†ã€‚æˆ‘ä»¬æ¥çœ‹ä¸‹ remove() å‡½æ•°æ˜¯å¦‚ä½•å®žçŽ°çš„ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚ç¨å¾®æé†’ä¸€ä¸‹ï¼Œåœ¨ Java å®žçŽ°ä¸­ï¼Œè¿­ä»£å™¨ç±»æ˜¯å®¹å™¨ç±»çš„å†…éƒ¨ç±»ï¼Œå¹¶ä¸” next() å‡½æ•°ä¸ä»…å°†æ¸¸æ ‡åŽç§»ä¸€ä½ï¼Œè¿˜ä¼šè¿”å›žå½“å‰ çš„å…ƒç´ ã€‚

[TABLE]

[TABLE]

> åœ¨ä¸Šé¢çš„ä»£ç å®žçŽ°ä¸­ï¼Œè¿­ä»£å™¨ç±»æ–°å¢žäº†ä¸€ä¸ª lastRet æˆå‘˜å˜é‡ï¼Œç”¨æ¥è®°å½•æ¸¸æ ‡æŒ‡å‘çš„å‰ä¸€ä¸ªå…ƒç´ ã€‚é€šè¿‡è¿­ä»£å™¨åŽ»åˆ é™¤è¿™ä¸ªå…ƒç´ çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥æ›´æ–°è¿­ä»£å™¨ä¸­çš„æ¸¸æ ‡å’Œ lastRet å€¼ï¼Œæ¥ä¿è¯ä¸ä¼šå› ä¸ºåˆ é™¤å…ƒç´ è€Œå¯¼è‡´æŸä¸ªå…ƒç´ éåŽ†ä¸åˆ°ã€‚å¦‚æžœé€šè¿‡å®¹å™¨æ¥åˆ é™¤å…ƒç´ ï¼Œå¹¶ä¸”å¸Œæœ›æ›´æ–°è¿­ä»£å™¨ä¸­çš„æ¸¸æ ‡å€¼æ¥ä¿è¯éåŽ†ä¸å‡ºé”™ï¼Œæˆ‘ä»¬å°±è¦ç»´æŠ¤è¿™ä¸ªå®¹å™¨éƒ½åˆ›å»ºäº†å“ªäº›è¿­ä»£å™¨ï¼Œæ¯ä¸ªè¿­ä»£å™¨æ˜¯å¦è¿˜åœ¨ä½¿ç”¨ç­‰ä¿¡æ¯ï¼Œä»£ç å®žçŽ°å°±å˜å¾—æ¯”è¾ƒå¤æ‚äº†ã€‚

# é‡ç‚¹å›žé¡¾

> å¥½äº†ï¼Œä»Šå¤©çš„å†…å®¹åˆ°æ­¤å°±è®²å®Œäº†ã€‚æˆ‘ä»¬ä¸€å—æ¥æ€»ç»“å›žé¡¾ä¸€ä¸‹ï¼Œä½ éœ€è¦é‡ç‚¹æŽŒæ¡çš„å†…å®¹ã€‚
>
> åœ¨é€šè¿‡è¿­ä»£å™¨æ¥éåŽ†é›†åˆå…ƒç´ çš„åŒæ—¶ï¼Œå¢žåŠ æˆ–è€…åˆ é™¤é›†åˆä¸­çš„å…ƒç´ ï¼Œæœ‰å¯èƒ½ä¼šå¯¼è‡´æŸä¸ªå…ƒç´ è¢«é‡å¤éåŽ†æˆ–éåŽ†ä¸åˆ°ã€‚ä¸è¿‡ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰æƒ…å†µä¸‹éƒ½ä¼šéåŽ†å‡ºé”™ï¼Œæœ‰çš„æ—¶å€™ä¹Ÿå¯ä»¥æ­£å¸¸é åŽ†ï¼Œæ‰€ä»¥ï¼Œè¿™ç§è¡Œä¸ºç§°ä¸ºç»“æžœä¸å¯é¢„æœŸè¡Œä¸ºæˆ–è€…æœªå†³è¡Œä¸ºã€‚å®žé™…ä¸Šï¼Œâ€œä¸å¯é¢„æœŸâ€æ¯”ç›´æŽ¥å‡ºé”™æ›´åŠ å¯æ€•ï¼Œæœ‰çš„æ—¶å€™è¿è¡Œæ­£ç¡®ï¼Œæœ‰çš„æ—¶å€™è¿è¡Œé”™è¯¯ï¼Œä¸€äº›éšè—å¾ˆæ·±ã€å¾ˆéš¾ debug çš„ bug å°±æ˜¯è¿™ä¹ˆäº§ç”Ÿçš„ã€‚
>
> æœ‰ä¸¤ç§æ¯”è¾ƒå¹²è„†åˆ©ç´¢çš„è§£å†³æ–¹æ¡ˆï¼Œæ¥é¿å…å‡ºçŽ°è¿™ç§ä¸å¯é¢„æœŸçš„è¿è¡Œç»“æžœã€‚ä¸€ç§æ˜¯éåŽ†çš„æ—¶å€™ä¸å…è®¸å¢žåˆ å…ƒç´ ï¼Œå¦ä¸€ç§æ˜¯å¢žåˆ å…ƒç´ ä¹‹åŽè®©éåŽ†æŠ¥é”™ã€‚ç¬¬ä¸€ç§è§£å†³æ–¹æ¡ˆæ¯”è¾ƒéš¾å®žçŽ°ï¼Œå› ä¸ºå¾ˆéš¾ç¡®å®šè¿­ä»£å™¨ä½¿ç”¨ç»“æŸçš„æ—¶é—´ç‚¹ã€‚ç¬¬äºŒç§è§£å†³æ–¹æ¡ˆæ›´åŠ åˆç†ã€‚Java è¯­è¨€å°±æ˜¯é‡‡ç”¨çš„è¿™ç§è§£å†³æ–¹æ¡ˆã€‚å¢žåˆ å…ƒç´ ä¹‹åŽï¼Œæˆ‘ä»¬é€‰æ‹© fail-fast è§£å†³æ–¹å¼ï¼Œè®©éåŽ†æ“ä½œç›´æŽ¥æŠ›å‡ºè¿è¡Œæ—¶å¼‚å¸¸ã€‚
>
> åƒ Java è¯­è¨€ï¼Œè¿­ä»£å™¨ç±»ä¸­é™¤äº†å‰é¢æåˆ°çš„å‡ ä¸ªæœ€åŸºæœ¬çš„æ–¹æ³•ä¹‹å¤–ï¼Œè¿˜å®šä¹‰äº†ä¸€ä¸ªremove() æ–¹æ³•ï¼Œèƒ½å¤Ÿåœ¨éåŽ†é›†åˆçš„åŒæ—¶ï¼Œå®‰å…¨åœ°åˆ é™¤é›†åˆä¸­çš„å…ƒç´ ã€‚

# è¯¾å ‚è®¨è®º

> 1\. åŸºäºŽæ–‡ç« ä¸­ç»™å‡ºçš„ Java è¿­ä»£å™¨çš„å®žçŽ°ä»£ç ï¼Œå¦‚æžœä¸€ä¸ªå®¹å™¨å¯¹è±¡åŒæ—¶åˆ›å»ºäº†ä¸¤ä¸ªè¿­ä»£å™¨ï¼Œ ä¸€ä¸ªè¿­ä»£å™¨è°ƒç”¨äº† remove() æ–¹æ³•åˆ é™¤äº†é›†åˆä¸­çš„ä¸€ä¸ªå…ƒç´ ï¼Œé‚£å¦ä¸€ä¸ªè¿­ä»£å™¨æ˜¯å¦è¿˜å¯ ç”¨ï¼Ÿæˆ–è€…ï¼Œæˆ‘æ¢ä¸ªé—®æ³•ï¼Œä¸‹é¢ä»£ç ä¸­çš„ç¬¬ 13 è¡Œçš„è¿è¡Œç»“æžœæ˜¯ä»€ä¹ˆï¼Ÿ

[TABLE]

1.  LinkedList åº•å±‚åŸºäºŽé“¾è¡¨ï¼Œå¦‚æžœåœ¨éåŽ†çš„åŒæ—¶ï¼Œå¢žåŠ åˆ é™¤å…ƒç´ ï¼Œä¼šå‡ºçŽ°å“ªäº›ä¸å¯é¢„æœŸçš„è¡Œä¸ºå‘¢ï¼Ÿ

> æ¬¢è¿Žç•™è¨€å’Œæˆ‘åˆ†äº«ä½ çš„æƒ³æ³•ã€‚å¦‚æžœæœ‰æ”¶èŽ·ï¼Œæ¬¢è¿Žä½ æŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™ä½ çš„æœ‹å‹ã€‚
>
> ![](media/image12.png)
>
> Â© ç‰ˆæƒå½’æžå®¢é‚¦ç§‘æŠ€æ‰€æœ‰ï¼Œæœªç»è®¸å¯ä¸å¾—ä¼ æ’­å”®å–ã€‚ é¡µé¢å·²å¢žåŠ é˜²ç›—è¿½è¸ªï¼Œå¦‚æœ‰ä¾µæƒæžå®¢é‚¦å°†ä¾æ³•è¿½ç©¶å…¶æ³•å¾‹è´£ä»»ã€‚
>
> ä¸Šä¸€ç¯‡ 65 \| è¿­ä»£å™¨æ¨¡å¼ï¼ˆä¸Šï¼‰ï¼šç›¸æ¯”ç›´æŽ¥éåŽ†é›†åˆæ•°æ®ï¼Œä½¿ç”¨è¿­ä»£å™¨æœ‰å“ªäº›ä¼˜åŠ¿ï¼Ÿ
>
> ä¸‹ä¸€ç¯‡ 67 \| è¿­ä»£å™¨æ¨¡å¼ï¼ˆä¸‹ï¼‰ï¼šå¦‚ä½•è®¾è®¡å®žçŽ°ä¸€ä¸ªæ”¯æŒâ€œå¿«ç…§â€åŠŸèƒ½çš„iteratorï¼Ÿ
>
> ![](media/image13.png)**ç²¾é€‰ç•™è¨€ (25)**
>
> ![](media/image15.png)**å°æ™å­**
>
> 2020-04-03
>
> æ€è€ƒé¢˜ï¼š

1.  iterator1 å’Œ iterator2æ˜¯ä¸¤ä¸ªä¸åŒçš„è¿­ä»£å™¨å¯¹è±¡ï¼Œä¿®æ”¹ä¸€ä¸ªä¸ä¼šå½±å“å¦å¤–ä¸€ä¸ªï¼Œæ‰€ä»¥æ‰§è¡Œiterator1.remove()åŽï¼Œå†æ‰§è¡Œiterator2.nextæ—¶ï¼Œä¼šæ‰§è¡ŒcheckForComodification();æ£€æŸ¥ï¼Œå¯æ˜¯æ£€æŸ¥æ¡ä»¶â€œarrayList.modCount != expectedModCountâ€ä¸­arrayListçš„modC ountå·²ç»å˜æˆäº†5ï¼Œè€Œæ­¤æ—¶iterator2çš„expectedModCountè¿˜æ˜¯4ï¼Œæ‰€ä»¥è§¦å‘Concurreâ€¦ å±•å¼€î˜ƒ

![](media/image16.png)![](media/image17.png)18

> ![](media/image18.png)**Liam**
>
> 2020-04-03

1.  ç¬¬äºŒä¸ªè¿­ä»£å™¨ä¼šæŠ¥é”™ï¼ŒmodCountå‘ç”Ÿå˜åŒ–

2.  é“¾è¡¨å¢žåˆ ä¸å½±å“æ¸¸æ ‡ï¼Œä¸ä¼šå‡ºçŽ°æ„å¤–

![](media/image16.png)![](media/image19.png)4

> ![](media/image20.png)**kyle**
>
> 2020-04-03
>
> è¿­ä»£å™¨ä¸­åˆ é™¤å…ƒç´ é‚£ä¸€æ®µï¼Œæ‰§è¡Œå®Œç¬¬57è¡Œ(åˆ é™¤aä»¥åŽ)ï¼Œæ¸¸æ ‡åº”è¯¥æŒ‡å‘cï¼Œå›¾ä¸­æŒ‡å‘däº†

![](media/image21.png)![](media/image22.png)3 4

> ![](media/image23.png)**æŸæ²¹**
>
> 2020-04-05
>
> å…³äºŽé—®é¢˜2 LinkedListçš„æ€è€ƒï¼Œæ—¢ç„¶LinkedListæ˜¯åŸºäºŽé“¾è¡¨å®žçŽ°ï¼Œé‚£åœ¨å‰oråŽæ–°å¢žåˆ é™¤å…ƒç´ éƒ½ä¸ä¼šæ¶‰åŠåˆ°æ•°æ®æ•´ä½“çš„æ¬ç§»ï¼Œä¹Ÿå°±ä¸ä¼šå‡ºçŽ°æ•°æ®é—æ¼æˆ–è€…é‡å¤å¤„ç†çš„æƒ…å†µï¼Œå’‹ä¸€çœ‹åœ¨åŽŸé›†åˆè¿›è¡Œå¢žåˆ æ“ä½œä¸ä¼šå¯¹è¿­ä»£å™¨çš„éåŽ†äº§ç”Ÿå½±å“ï¼Œé‚£ä¸ºä½•LinkedListåœ¨æœ‰è¿­ä»£å™¨å®žä¾‹çš„æƒ…å†µä¸‹ä¸å…è®¸åœ¨åŽŸé›†åˆè¿›è¡Œå¢žåˆ æ“ä½œå‘¢ï¼Ÿæºç ä¸­hasNextæ˜¯é€šè¿‡nextIndex &lt; sizeæ¥åˆ¤æ–­æ˜¯å¦è¿˜æœ‰å…ƒç´ ï¼Œåœ¨æ–°å¢žåˆ é™¤çš„æƒ…å†µä¸‹å¯¹sizeéƒ½æœ‰æ”¹å˜ï¼›ä»Žé›†åˆå‰é¢åˆ é™¤å…ƒç´ ï¼Œsizeå‡å°ï¼Œè¿­ä»£å™¨â€¦
>
> å±•å¼€î˜ƒ

![](media/image24.png)![](media/image25.png)3

> ![](media/image26.png)**Monday**
>
> 2020-04-03
>
> hpublic class Demo {
>
> public static void main(String\[\] args) { List&lt;String&gt; names = new ArrayList&lt;&gt;(); names.add("a");
>
> names.add("b");â€¦
>
> å±•å¼€î˜ƒ
>
> ![](media/image24.png)![](media/image25.png)3
>
> ![](media/image27.png)**ï¼Œ**
>
> 2020-04-03
>
> 1.ConcurrentModificationExceptionæ˜¯åœ¨è°ƒç”¨è¿­ä»£å™¨çš„nextæ–¹æ³•æ—¶äº§ç”Ÿ,å› ä¸ºè¿­ä»£å™¨2å¹¶æ²¡æœ‰ä½¿ç”¨,æ‰€ä»¥ä¸ä¼šæŠ¥é”™,å¦‚æžœåœ¨ç¬¬13è¡Œè°ƒç”¨çš„æ˜¯iterator2.next()åˆ™ä¼šæŠ¥é”™(åŽŸå› :expectedMo dCountåœ¨æ–°å»ºè¿­ä»£å™¨çš„æ—¶å€™åˆå§‹åŒ–,è°ƒç”¨iterator1.remove()åªä¿®æ”¹iterator1çš„expected ModCount,ä¸ä¼šä¿®æ”¹iterator2çš„,æ‰€ä»¥åœ¨è°ƒç”¨iterator2.next()æ—¶ä¼šæŠ¥é”™) 2.ä½¿ç”¨è¿­ä»£å™¨éåŽ†çš„åŒæ—¶,ä½¿ç”¨å®¹å™¨çš„æ–¹æ³•è¿›è¡Œå¢žåˆ æ“ä½œä¹Ÿä¼šè§¦å‘ConcurrentModificatioâ€¦
>
> å±•å¼€î˜ƒ

![](media/image21.png)![](media/image22.png)3 3

> ![](media/image28.png)**å¿†æ°´å¯’**
>
> 2020-04-05
>
> ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œç”±äºŽmodcountä¸ä¸€æ ·äº†ï¼Œæ‰€ä»¥ä¼šå‡ºçŽ°å¼‚å¸¸ã€‚ç¬¬äºŒä¸ªé—®é¢˜ï¼ŒLinkedListå’ŒArrayListè¡Œä¸ºä¸€è‡´ã€‚
>
> å±•å¼€î˜ƒ
>
> ![](media/image29.png)![](media/image30.png)2
>
> ![](media/image31.png)**Kenå¼ äº‘å¿ **
>
> 2020-04-03
>
> 1.åŸºäºŽæ–‡ç« ä¸­ç»™å‡ºçš„ Java è¿­ä»£å™¨çš„å®žçŽ°ä»£ç ï¼Œå¦‚æžœä¸€ä¸ªå®¹å™¨å¯¹è±¡åŒæ—¶åˆ›å»ºäº†ä¸¤ä¸ªè¿­ä»£å™¨ï¼Œ ä¸€ä¸ªè¿­ä»£å™¨è°ƒç”¨äº† remove() æ–¹æ³•åˆ é™¤äº†é›†åˆä¸­çš„ä¸€ä¸ªå…ƒç´ ï¼Œé‚£å¦ä¸€ä¸ªè¿­ä»£å™¨æ˜¯å¦è¿˜å¯
>
> ç”¨ï¼Ÿæˆ–è€…ï¼Œæˆ‘æ¢ä¸ªé—®æ³•ï¼Œä¸‹é¢ä»£ç ä¸­çš„ç¬¬ 13 è¡Œçš„è¿è¡Œç»“æžœæ˜¯ä»€ä¹ˆï¼Ÿ Exception in thread "main" java.util.ConcurrentModificationException
>
> å› ä¸ºiterator2.expectedModCountçš„å€¼ä¸Žnames.modCountçš„å€¼ä¸ç›¸ç­‰,expectedMoâ€¦
>
> å±•å¼€î˜ƒ

![](media/image32.png)![](media/image30.png)2 2

> ![](media/image33.png)**halweg**
>
> 2020-04-03
>
> å°äº‰å“¥åŽé¢æ˜¯ä¸æ˜¯è¿˜æœ‰é—¨ç³»ç»Ÿè®¾è®¡çš„è¯¾ï¼Œè¦æ˜¯å†æœ‰è¿™é—¨è¯¾ï¼Œæˆ‘è§‰å¾—å°±æ­¤ç”Ÿæ— æ†¾äº†ã€‚ç­”åº”æˆ‘ï¼Œä¸€å®šè¦å‡ºï¼Œå¥½ä¸å¥½ï¼Ÿ
>
> å±•å¼€î˜ƒ
>
> ![](media/image34.png)![](media/image35.png)2
>
> ![](media/image36.png)**DexterPoker**
>
> 2020-04-03
>
> è€å¸ˆçš„é¢˜ç›®æ˜¯ä¸æ˜¯iterator1.next(); iterator1.remove(); iterator2.next(); // è¿è¡Œç»“æžœï¼Ÿ å¦‚æžœæ˜¯iterator1ï¼Œèƒ½æ­£å¸¸è¿è¡Œï¼›â€¦
>
> å±•å¼€î˜ƒ
>
> ![](media/image34.png)![](media/image35.png)2
>
> ![](media/image37.png)**Jackie**
>
> 2020-04-03
>
> ç»ˆäºŽæ˜Žç™½æŠ¥ConcurrentModificationExceptionçš„çœŸæ­£åŽŸå› äº†

![](media/image29.png)![](media/image30.png)2

> ![](media/image38.png)**é©¬ä»¥**
>
> 2020-04-03
>
> ä¸ä¼šæŠ¥é”™
>
> å±•å¼€î˜ƒ

![](media/image39.png)1 2

î˜² î˜»

> ![](media/image41.png)**è‰ä¸Šé£žè¶å·**ðŸ™ˆ
>
> 2020-04-06
>
> 1ã€ä¼šæŠ¥é”™ã€‚è™½ç„¶è¿­ä»£å™¨è‡ªèº«çš„æ²¡æœ‰å˜ï¼Œä½†æ˜¯arraylistçš„å˜äº†ï¼Œå¯¼è‡´ä¸ç›¸ç­‰ï¼Œå› æ­¤ä¼šä»ç„¶æŠ¥é”™ã€‚ 1ã€ä¼šå­˜åœ¨æœªè§‰è¡Œä¸ºã€‚ä¾‹å¦‚æ–°å¢žçš„å…ƒç´ åœ¨cursorä¹‹å‰ä¼šéåŽ†ä¸åˆ°æ–°å¢žçš„å…ƒç´ ï¼Œå‡å¦‚æƒ…å†µ2ï¼Œ æ–°å¢žçš„å…ƒç´ æ°å¥½åœ¨å½“å‰cursorä¹‹åŽæ‰€æŒ‡çš„å…ƒç´ ï¼Œä¹ŸéåŽ†ä¸åˆ°æ–°å¢žçš„å…ƒç´ ï¼Œå¦‚æžœä¸è€ƒè™‘æ–°å¢žçš„å…ƒç´ åŽç»­ä¸å†éåŽ†çš„è¯ï¼Œå¢žåŠ å…ƒç´ å°±ä¸å­˜åœ¨æœªè§‰è¡Œä¸ºã€‚åˆ é™¤çš„å…ƒç´ ä¸ºcursoræ‰€æŒ‡çš„å…ƒç´ â€¦
>
> å±•å¼€î˜ƒ

![](media/image42.png)![](media/image43.png)1

> ![](media/image44.png)**ç‰§å**
>
> 2020-04-05
>
> \`åŸºäºŽæ–‡ç« ä¸­ç»™å‡ºçš„ Java è¿­ä»£å™¨çš„å®žçŽ°ä»£ç ï¼Œå¦‚æžœä¸€ä¸ªå®¹å™¨å¯¹è±¡åŒæ—¶åˆ›å»ºäº†ä¸¤ä¸ªè¿­ä»£å™¨ï¼Œ ä¸€ä¸ªè¿­ä»£å™¨è°ƒç”¨äº† remove() æ–¹æ³•åˆ é™¤äº†é›†åˆä¸­çš„ä¸€ä¸ªå…ƒç´ ï¼Œé‚£å¦ä¸€ä¸ªè¿­ä»£å™¨æ˜¯å¦è¿˜å¯ç”¨ï¼Ÿæˆ–è€…ï¼Œæˆ‘æ¢ä¸ªé—®æ³•ï¼Œä¸‹é¢ä»£ç ä¸­çš„ç¬¬ 13 è¡Œçš„è¿è¡Œç»“æžœæ˜¯ä»€ä¹ˆï¼Ÿ\`
>
> åŽè°ƒç”¨removeçš„è¿­ä»£å™¨ä¼šå‡ºé”™ï¼Œå³iterator2.next()ä¼šæŠ›å‡ºConcurrentModificationExce ptionå¼‚å¸¸
>
> å±•å¼€î˜ƒ

![](media/image45.png)![](media/image46.png)1

> ![](media/image44.png)**ç‰§å**
>
> 2020-04-05
>
> \`LinkedList åº•å±‚åŸºäºŽé“¾è¡¨ï¼Œå¦‚æžœåœ¨éåŽ†çš„åŒæ—¶ï¼Œå¢žåŠ åˆ é™¤å…ƒç´ ï¼Œä¼šå‡ºçŽ°å“ªäº›ä¸å¯é¢„æœŸçš„è¡Œä¸ºå‘¢\`

1.  å¢žåŠ å…ƒç´ ï¼šå¦‚æžœåœ¨å½“å‰å…ƒç´ ä¹‹å‰æ·»åŠ æ–°å…ƒç´ ï¼Œé‚£ä¹ˆæ–°å¢žçš„å…ƒç´ ä¸ä¼šè¢«éåŽ†åˆ°ï¼›å¦‚æžœåœ¨å½“å‰å…ƒç´ ä¹‹åŽæ·»åŠ å…ƒç´ åˆ™ä¼šè¢«éåŽ†åˆ°ï¼Œå­˜åœ¨æœªå†³è¡Œä¸ºã€‚

2.  åˆ é™¤å…ƒç´ ï¼šå¦‚æžœåˆ é™¤å½“å‰å…ƒç´ ä¹‹å‰çš„å…ƒç´ ï¼Œé‚£ä¹ˆè¿™ä¸ªè¢«åˆ é™¤çš„å…ƒç´ å…¶å®žä¹‹å‰å·²ç»è¢«éâ€¦

> å±•å¼€î˜ƒ

![](media/image47.png)![](media/image48.png)1

> ![](media/image49.png)**Geek\_54edc1**
>
> 2020-04-04
>
> 1ã€å› ä¸ºmodCountå’ŒexpectModCountä¸ä¸€è‡´ï¼Œiterator2åœ¨éåŽ†æ—¶ä¼šæŠ›å‡ºå¼‚å¸¸ï¼› 2ã€å¦‚æžœæ˜¯å•é“¾è¡¨ï¼Œå¦‚æžœåœ¨æ¸¸æ ‡å¯¹åº”çš„å…ƒç´ ä¹‹å‰å¢žåŠ å…ƒç´ ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ–°å¢žåŠ çš„å…ƒç´ éåŽ†ä¸åˆ°ï¼› å¦‚æžœåˆ é™¤çš„æ°å¥½æ˜¯æ¸¸æ ‡å¯¹åº”çš„å…ƒç´ ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ— æ•ˆæŒ‡é’ˆé”™è¯¯ã€‚
>
> å±•å¼€î˜ƒ

![](media/image50.png)![](media/image51.png)1

> ![](media/image52.png)**æ¯å¤©æ™’ç™½ç‰™**
>
> ![](media/image53.png) 2020-04-03
>
> æ€è€ƒé¢˜1ï¼Œä¼šæŠ¥é”™ï¼Œiterator2ä¸­çš„ expectedModCount æ˜¯æœ€å¼€å§‹çš„ 4ï¼Œè€Œ names ä¸­çš„ m odCount æ˜¯ 5ï¼Œæ‰€ä»¥æŠ¥é”™
>
> å±•å¼€î˜ƒ

![](media/image54.png)![](media/image55.png)1

> ![](media/image56.png)**Kenå¼ äº‘å¿ **
>
> 2020-04-03
>
> 1.åŸºäºŽæ–‡ç« ä¸­ç»™å‡ºçš„ Java è¿­ä»£å™¨çš„å®žçŽ°ä»£ç ï¼Œå¦‚æžœä¸€ä¸ªå®¹å™¨å¯¹è±¡åŒæ—¶åˆ›å»ºäº†ä¸¤ä¸ªè¿­ä»£å™¨ï¼Œ ä¸€ä¸ªè¿­ä»£å™¨è°ƒç”¨äº† remove() æ–¹æ³•åˆ é™¤äº†é›†åˆä¸­çš„ä¸€ä¸ªå…ƒç´ ï¼Œé‚£å¦ä¸€ä¸ªè¿­ä»£å™¨æ˜¯å¦è¿˜å¯
>
> ç”¨ï¼Ÿæˆ–è€…ï¼Œæˆ‘æ¢ä¸ªé—®æ³•ï¼Œä¸‹é¢ä»£ç ä¸­çš„ç¬¬ 13 è¡Œçš„è¿è¡Œç»“æžœæ˜¯ä»€ä¹ˆï¼Ÿ Exception in thread "main" java.util.ConcurrentModificationException
>
> å› ä¸ºiterator2.expectedModCountçš„å€¼ä¸Žnames.modCountçš„å€¼ä¸ç›¸ç­‰,expectedMoâ€¦
>
> å±•å¼€î˜ƒ

![](media/image57.png)![](media/image58.png)1

> ![](media/image59.png)**æŽå°å››**
>
> 2020-04-03
>
> è®¾è®¡æ¨¡å¼\_66:
>
> \# ä½œä¸š
>
> 1\. (ä»£ç æœ‰é”™è¯¯: 13è¡Œåº”è¯¥æ˜¯\`iterator2.next()\`), åœ¨\`checkForComodification\`æ–¹æ³•æŠ›å‡ºå¼‚å¸¸ã€‚å› ä¸º\`iterator1\`removeä¼šå¯¼è‡´\`iterator2\`çš„\`expectedModCount\`ä¸Žé›†åˆçš„\`modCou nt\`å°±ä¸ä¸€è‡´ã€‚â€¦
>
> å±•å¼€î˜ƒ

![](media/image57.png)![](media/image58.png)1

> ![](media/image60.png)**æœ±æ™‹å›**
>
> 2020-04-03
>
> æ— è®ºæ˜¯ArrayListè¿˜æ˜¯LinkedListï¼Œä½¿ç”¨iteratorçš„removeæ–¹æ³•æ¥removeå…ƒç´ åŽå†éåŽ†ï¼Œéƒ½æ˜¯ä¸ä¼šæŠ¥é”™çš„ï¼Œä½¿ç”¨listä¸­çš„removeéƒ½ä¼šæŠ¥é”™ã€‚å› ä¸ºexpectedModCount != modCount ä½†æ˜¯LinkedListåˆ é™¤å…ƒç´ ï¼Œå¹¶ä¸ä¼šç§»åŠ¨åŽé¢çš„å…ƒç´ ï¼Œæ‰€ä»¥ä¸å­˜åœ¨æ–‡ä¸­è¯´çš„éåŽ†ä¸åˆ°çš„é—®é¢˜
>
> å±•å¼€î˜ƒ

![](media/image54.png)![](media/image55.png)1
