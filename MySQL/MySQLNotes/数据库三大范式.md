
# 数据库三大范式

本质上为设计数据库时应该遵循的规范。

示例数据库表：
![image-20200312221607521](%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%89%E5%A4%A7%E8%8C%83%E5%BC%8F.resource/image-20200312221607521.png)

## 第一范式（1NF）
==数据库表中的每一列都是不可分割的原子数据项==
即强调列的原子性
一般设计出来的表都满足第一范式；

**改正**：将系这个列直接划分为两列：系名和系主任；

学号 | 姓名 | 系名 | 系主任 | 课程名称 | 分数 
---|---|---|---|---|---
10010|张三|计算机|张系主任|高等数学|99
10010|张三|计算机   |张系主任|大学英语|95
10010|张三|计算机|张系主任|操作系统|96
10011|李四|法律|李系主任|法理学|95
10011|李四|法律|李系主任|环境保护法|98
10012|王五|法律|李系主任|环境保护法|94
10012|王五|法律|李系主任|法理学|99

**仍然存在的问题**：
- 存在非常严重的数据冗余（重复）：例如姓名、系名、系主任；
- 数据添加存在问题：例如如果添加一个新的系和系主任，因为缺少学生等其他信息，添加数据不合法；
- 数据删除存在问题：例如张三同学毕业了，需要删除数据，则整个系的数据也删除了；



## 第二范式（2NF）

==在第一范式的基础上，非码属性必须完全依赖于码==
就是要在第一范式的基础之上消除非主属性对主码的部分函数依赖；

- 函数依赖： A-->B ，如果通过 A 属性（或者属性组（就是一组属性））的值，可以确定唯一 B 属性的值，则称 B 依赖于 A。
例如：学号 --> 姓名  ；（学号，课程名称）-->分数；后者就是使用该属性组可以唯一确定分数的值。

- 完全函数依赖：A-->B，如果 A 是一个属性组，则 B 的属性值的确定需要依赖于 A 属性组中所有的属性值；
例如：（学号，课程名称）--> 分数

- 部分函数依赖：A-->B，如果 A 是一个属性组，则 B 的属性值的确定只需要依赖于 A 属性组中某一些值即可；
例如：（学号，课程名称）--> 姓名；使用学号即可唯一确定姓名属性的值

- 传递函数依赖：A-->B，B-->C ，如果通过 A 属性（属性组）的值，可以确定唯一 B 属性的值，在通过 B 属性（属性组）的值，可以确定唯一的 C 属性的值，则称 C 传递函数依赖于 A。
例如： 学号  --> 系名，系名 --> 系主任；

- 码：如果在一张表中，一个属性或者属性组被其他所有属性所完全依赖，则称该属性（属性组）为该表的码；
  例如：该表中码为：（学号，课程名称）
  - 主属性：码属性组中的所有属性；该表中的主属性为：学号、课程名称；
  - 非主属性：除了码属性组的属性；该表中的非主属性为：姓名、系名、系主任、分数；

**改正：**
因为表中码为（学号，课程名称），其他属性中只有分数是完全依赖于码，其他都不是完全依赖。首先将表复制一份到旁边，原来表中删除非完全依赖之后剩余部分称为：选课表

**选课表**

学号| 课程名称 | 分数 
---|---|---
10010|高等数学|99
10010|大学英语|95
10010|操作系统|96
10011|法理学|95
10011|环境保护法|98
10012|环境保护法|94
10012|法理学|99

然后之前复制的表中，因为课程名称和分数不在需要，删除之后，表中的主属性为：学号，其他非主属性都完全依赖于该主属性；同时取到属性值完全相同的行；

学生表：

学号 | 姓名 | 系名 | 系主任 
---|---|---|---
10010|张三|计算机|张系主任
10011|李四|法律|李系主任
10012|王五|法律|李系主任


 现在的问题：  
- 数据添加存在问题：例如如果添加一个新的系和系主任，因为缺少学生等其他信息，添加数据不合法；
- 数据删除存在问题：例如张三同学毕业了，需要删除数据，则整个系的数据也删除了；


## 第三范式（3NF）

==在第二范式基础上，任何非主属性不依赖与其他非主属性==
即在第二范式基础上，消除传递依赖；

在学生表中，系名依赖于学号，系主任依赖于系名，则系主任传递依赖于学号，因 此需要删除；

将系名和系主任单独作为一张表（系表），然后将原来学生表中存在传递依赖的系主任列删除；

**修改结果：**

学生表：
学号 | 姓名 | 系名 
---|---|---
10010|张三|计算机
10011|李四|法律
10012|王五|法律

系表
系名 | 系主任 
---|---
计算机|张系主任
法律|李系主任
法律|李系主任

此时学生表中学号为主属性，姓名和系名都为非主属性，并且完全依赖于主属性；同时系表中系名作为主属性，系主任为非主属性，并且完全依赖于主属性，同时删除重复数据得到：

系表
系名 | 系主任 
---|---
计算机|张系主任
法律|李系主任

**至此：所有问题都解决了**

## 最终的结果

**选课表**

学号| 课程名称 | 分数 
---|---|---
10010|高等数学|99
10010|大学英语|95
10010|操作系统|96
10011|法理学|95
10011|环境保护法|98
10012|环境保护法|94
10012|法理学|99

学生表：

|学号 | 姓名 | 系名| 
|---|---|---|
|10010|张三|计算机|
|10011|李四|法律|
|10012|王五|法律|



系表

系名 | 系主任 
---|---
计算机|张系主任
法律|李系主任

